var Le=Object.create;var V=Object.defineProperty;var Ee=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Me=Object.getPrototypeOf,Se=Object.prototype.hasOwnProperty;var Oe=e=>V(e,"__esModule",{value:!0});var Z=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ze=(e,t,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ce(t))!Se.call(e,r)&&r!=="default"&&V(e,r,{get:()=>t[r],enumerable:!(o=Ee(t,r))||o.enumerable});return e},Ae=e=>ze(Oe(V(e!=null?Le(Me(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var te=Z((st,ee)=>{ee.exports.default={types:{float:{filter_operator:"==",aggregate:"sum",format:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}},string:{filter_operator:"==",aggregate:"count"},integer:{filter_operator:"==",aggregate:"sum",format:{}},boolean:{filter_operator:"==",aggregate:"count"},datetime:{filter_operator:"==",aggregate:"count",format:{week:"numeric",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},null_value:-1},date:{filter_operator:"==",aggregate:"count",format:{week:"numeric",year:"numeric",month:"numeric",day:"numeric"},null_value:-1}}}});var re=Z((lt,M)=>{var oe=te().default;M.exports.get_types=function(){return Object.keys(M.exports.get_config().types)};M.exports.get_type_config=function(e){let t={};if(M.exports.get_config().types[e]&&Object.assign(t,M.exports.get_config().types[e]),t.type){let o=M.exports.get_type_config(t.type);return Object.assign(o,t),o}else return t};function Y(e){return e&&typeof e=="object"&&!Array.isArray(e)}function G(e,...t){if(!t.length)return e;let o=t.shift();if(Y(e)&&Y(o))for(let r in o)Y(o[r])?(e[r]||Object.assign(e,{[r]:{}}),G(e[r],o[r])):Object.assign(e,{[r]:o[r]});return G(e,...t)}globalThis.__PERSPECTIVE_CONFIG__=void 0;M.exports.override_config=function(e){globalThis.__PERSPECTIVE_CONFIG__&&console.warn("Config already initialized!"),globalThis.__PERSPECTIVE_CONFIG__=G(oe,e)};M.exports.get_config=function(){return globalThis.__PERSPECTIVE_CONFIG__||(globalThis.__PERSPECTIVE_CONFIG__=G(oe,globalThis.__TEMPLATE_CONFIG__||{})),globalThis.__PERSPECTIVE_CONFIG__}});import"regular-table";var ae=Ae(re());function se(e,t,[,,,,,o,r],[,,,,,s,n]){let i=this._ids?.[e.dy]?.join("|"),c=e.column_header.join("|");if(this.last_reverse_columns?.has(c)&&this.last_reverse_ids?.has(i)){let l=this.last_reverse_ids?.get(i),a=this.last_reverse_columns.get(c);this._is_old_viewport?this.last_meta?.[a]?.[l]>e.user?(t.style.setProperty("--pulse--background-color-start",s),t.style.setProperty("--pulse--background-color-end",n),t.style.animationName==="pulse_neg"?t.style.animation="pulse_neg2 0.5s linear":t.style.animation="pulse_neg 0.5s linear"):this.last_meta?.[a]?.[l]<e.user?(t.style.setProperty("--pulse--background-color-start",o),t.style.setProperty("--pulse--background-color-end",r),t.style.animationName==="pulse_pos"?t.style.animation="pulse_pos2 0.5s linear":t.style.animation="pulse_pos 0.5s linear"):l!==e.dy&&(t.style.animation=""):t.style.animation=""}else t.style.animation=""}async function le(e,t){e.addEventListener("regular-table-psp-sort",o=>{this._preserve_focus_state=!0,t.restore({sort:o.detail.sort})})}async function ne(e,t,o){let r=e.getMeta(o),s=r.column_header[r.column_header.length-1],i=(t.shiftKey?Pe:Re).call(this,s);e.dispatchEvent(new CustomEvent("regular-table-psp-sort",{detail:{sort:i}}))}function Pe(e){let t=[],o=!1;for(let r of this._config.sort){let[s,n]=r;if(s===e){o=!0;let i=ie.call(this,e,n);i&&t.push(i)}else t.push(r)}return o||t.push([e,"desc"]),t}function Re(e){for(let[t,o]of this._config.sort)if(t===e){let r=ie.call(this,e,o);return r?[r]:[]}return[[e,"desc"]]}function ie(e,t){let r=this._config.split_by.length>0?Ne:je,s=t?r[t]:"desc";if(s)return[e,s]}var je={desc:"asc",asc:void 0},Ne={desc:"asc",asc:"col desc","col desc":"col asc","col asc":void 0};import Ie from"chroma-js";var w=Symbol("Plugin Symbol");function $e(e){let[t,o,r]=e.rgb(),[s,n,i]=e.set("hsl.h",(e.get("hsl.h")-15)%360).rgb(),[c,l,a]=e.set("hsl.h",(e.get("hsl.h")+15)%360).rgb();return`linear-gradient(to right top,rgb(${s},${n},${i}),rgb(${t},${o},${r}) 50%,rgb(${c},${l},${a}))`}function x(e){let t=Ie(e),o=$e(t),r=t.rgb();return[e,...r,o,`rgba(${r[0]},${r[1]},${r[2]},1)`,`rgba(${r[0]},${r[1]},${r[2]},0)`]}function U(e,t,o){let r=typeof o!="undefined",s=document.createElement(`perspective-${r?"number":"string"}-column-style`),n=e.getMeta(t),i=n.column_header[n.column_header.length-1],c=this._schema[i],l;if(r?l={fg_gradient:o,pos_fg_color:this._pos_fg_color[0],neg_fg_color:this._neg_fg_color[0],number_fg_mode:"color",bg_gradient:o,pos_bg_color:this._pos_bg_color[0],neg_bg_color:this._neg_bg_color[0],number_bg_mode:"disabled"}:l={color:this._color[0]},c!=="string")if(c==="float")l.fixed=2;else if(c==="integer")l.fixed=0;else{this._open_column_styles_menu.pop(),e.draw({preserve_width:!0});return}let a=()=>s.blur(),h=m=>{let p=m.detail;p.pos_fg_color&&(p.pos_fg_color=x(p.pos_fg_color),p.neg_fg_color=x(p.neg_fg_color)),p.pos_bg_color&&(p.pos_bg_color=x(p.pos_bg_color),p.neg_bg_color=x(p.neg_bg_color)),p.color&&(p.color=x(p.color)),e[w]=e[w]||{},e[w][i]=p,e.draw({preserve_width:!0}),e.parentElement.parentElement.dispatchEvent(new Event("perspective-config-update"))},_=async()=>{e.removeEventListener("regular-table-scroll",a),s.removeEventListener("perspective-column-style-change",h),s.removeEventListener("blur",_),s.destroy(),this._open_column_styles_menu.pop(),await e.draw({preserve_width:!0}),e.parentElement.parentElement.dispatchEvent(new Event("perspective-config-update"))};s.addEventListener("perspective-column-style-change",h),s.addEventListener("blur",_),e.addEventListener("regular-table-scroll",a);let d=e[w]||{},u=Object.assign({},d[i]=d[i]||{});(u.pos_fg_color||u.pos_bg_color)&&(u.pos_fg_color=u.pos_fg_color?.[0],u.neg_fg_color=u.neg_fg_color?.[0],u.pos_bg_color=u.pos_bg_color?.[0],u.neg_bg_color=u.neg_bg_color?.[0]),u.color&&(u.color=u.color[0]),s.open(t,u,l)}function j([e,t,o,r],s=[255,255,255]){function n(i,c){return((1-r)*(s[i]/255)+r*(c/255))*255}return[n(0,e),n(1,t),n(2,o)]}function N([e,t,o]){return Math.sqrt(e*e*.299+t*t*.587+o*o*.114)>130?"#161616":"#ffffff"}import W from"chroma-js";function Fe(e){let t=e._view_cache.config.row_pivots.length-1,o=Array.from(e.children[0].children[0].children),r=e[w]||{};if(o.length>0){let[c]=o.splice(o.length-1,1);for(let l of c?.children){let a=e.getMeta(l),h=a.column_header?.[a.column_header?.length-1],_=this._config.sort.find(g=>g[0]===h),d=a.row_header_x===t,u=typeof a.x=="undefined";d=d||(a.x+1)%this._config.columns.length==0,l.classList.toggle("psp-header-border",d),l.classList.toggle("psp-header-group",!1),l.classList.toggle("psp-header-leaf",!0),l.classList.toggle("psp-is-top",!1),l.classList.toggle("psp-header-corner",u),l.classList.toggle("psp-header-sort-asc",!!_&&_[1]==="asc"),l.classList.toggle("psp-header-sort-desc",!!_&&_[1]==="desc"),l.classList.toggle("psp-header-sort-col-asc",!!_&&_[1]==="col asc"),l.classList.toggle("psp-header-sort-col-desc",!!_&&_[1]==="col desc");let m=X.call(this,a),p=m==="integer"||m==="float",b=m==="string";l.classList.toggle("psp-align-right",p),l.classList.toggle("psp-align-left",!p),l.classList.toggle("psp-menu-open",this._open_column_styles_menu[0]===a._virtual_x),l.classList.toggle("psp-menu-enabled",(b||p)&&!u),l.classList.toggle("psp-is-width-override",e._column_sizes?.override[a.size_key]!==void 0)}}let s=[],n=new Set,i=e.children[0];for(let c=0;c<o.length;c++){let l=i.rows[c],a=new Set;for(let h=0;h<l.cells.length;h++){let _=l.cells[h];_.style.backgroundColor="";let d=e.getMeta(_),u=d.row_header_x===t||d.x>=0;_.classList.toggle("psp-align-right",!1),_.classList.toggle("psp-align-left",!1),_.classList.toggle("psp-header-group",!0),_.classList.toggle("psp-header-leaf",!1),_.classList.toggle("psp-header-border",u),_.classList.toggle("psp-header-group-corner",typeof d.x=="undefined"),_.classList.toggle("psp-color-mode-bar",!1),_.classList.toggle("psp-header-sort-asc",!1),_.classList.toggle("psp-header-sort-desc",!1),_.classList.toggle("psp-header-sort-col-asc",!1),_.classList.toggle("psp-header-sort-col-desc",!1);let m=l.cells[h],p=h,b,g;for(;s[c]&&s[c][p];++p);for(a.add(p),b=p;b<p+m.colSpan;++b)for(g=c;g<c+m.rowSpan;++g)s[g]||(s[g]=[]),s[g][b]=!0;m.classList.toggle("psp-is-top",c===0||!n.has(b))}n=a}for(let c of e.children[0].children[1].children)for(let l of c.children){let a=e.getMeta(l),h=a.column_header?.[a.column_header?.length-1],_=X.call(this,a),d=r[h],u=_==="integer"||_==="float";if(u){let p=a.user>0,b=a.user<0,g;d?.pos_bg_color!==void 0?g=d.pos_bg_color:g=this._pos_bg_color;let f;d?.neg_bg_color!==void 0?f=d.neg_bg_color:f=this._neg_bg_color;let y=p?g:b?f:["",...this._plugin_background,""];{let[E,C,F,D,Q]=y;if(l.style.position="",d?.number_bg_mode==="color")l.style.animation="",l.style.backgroundColor=E;else if(d?.number_bg_mode==="gradient"){let H=Math.max(0,Math.min(1,Math.abs(a.user/d.bg_gradient))),B=this._plugin_background,T=N(j([C,F,D,H],B));l.style.animation="",l.style.color=T,l.style.backgroundColor=`rgba(${C},${F},${D},${H})`}else d?.number_bg_mode==="pulse"?(se.call(this,a,l,g,f),l.style.backgroundColor=""):(d?.number_bg_mode==="disabled"||!d?.number_bg_mode,l.style.animation="",l.style.backgroundColor="")}let[v,L,S,O,k]=(()=>d?.pos_fg_color!==void 0?p?d.pos_fg_color:b?d.neg_fg_color:["",...this._plugin_background,""]:p?this._pos_fg_color:b?this._neg_fg_color:["",...this._plugin_background,""])();if(d?.number_fg_mode==="disabled")if(d?.number_bg_mode==="color"){let E=this._plugin_background,C=N(j([y[1],y[2],y[3],1],E));l.style.color=C}else d?.number_bg_mode==="gradient"||(l.style.color="");else d?.number_fg_mode==="bar"?(l.style.color="",l.style.position="relative",k!==""&&l.children.length>0&&l.children[0].nodeType===Node.ELEMENT_NODE&&(l.children[0].style.background=k)):(d?.number_fg_mode==="color"||!d?.number_fg_mode)&&(l.style.color=v)}else if(_==="boolean"){let[p]=a.user===!0?this._pos_fg_color:a.user===!1?this._neg_fg_color:["",0,0,0,""];l.style.backgroundColor="",l.style.color=p}else if(_==="string"){let[p,b,g,f,y]=(()=>d?.color!==void 0?d.color:this._color)();if(d?.string_color_mode==="foreground"&&a.user!==null)l.style.color=p,l.style.backgroundColor="",d?.format==="link"&&(l.children[0].style.color=p);else if(d?.string_color_mode==="background"&&a.user!==null){let v=this._plugin_background,L=N(j([b,g,f,1],v));l.style.color=L,l.style.backgroundColor=p}else if(d?.string_color_mode==="series"&&a.user!==null){this._series_color_map.has(h)||(this._series_color_map.set(h,new Map),this._series_color_seed.set(h,0));let v=this._series_color_map.get(h);if(!v.has(a.user)){let T=this._series_color_seed.get(h);v.set(a.user,T),this._series_color_seed.set(h,T+1)}let L=v.get(a.user),[S,O,k]=W(p).hsl();S=S+L*150%360;let E=W(S,O,k,"hsl"),[C,F,D]=E.rgb(),Q=E.hex(),H=this._plugin_background,B=N(j([C,F,D,1],H));l.style.color=B,l.style.backgroundColor=Q}else l.style.backgroundColor="",l.style.color=""}else l.style.backgroundColor="",l.style.color="";l.classList.toggle("psp-bool-type",_==="boolean"&&a.user!==null);let m=l.tagName==="TH";if(m){let p=typeof a.value!=null&&typeof a.value!=null&&a.value?.toString()?.trim().length>0,b=a.row_header_x>=this._config.group_by.length,g=e.getMeta({dx:0,dy:a.y-a.y0+1}),f=g&&g.row_header&&typeof g.row_header[a.row_header_x+1]!="undefined";l.classList.toggle("psp-tree-label",p&&!b),l.classList.toggle("psp-tree-label-expand",p&&!b&&!f),l.classList.toggle("psp-tree-label-collapse",p&&!b&&f),l.classList.toggle("psp-tree-leaf",p&&b)}l.classList.toggle("psp-align-right",!m&&u),l.classList.toggle("psp-align-left",m||!u),l.classList.toggle("psp-color-mode-bar",d?.number_fg_mode==="bar"&&u)}}async function De(e,t){let o=e.getMeta(t.target),r=t.target.classList.contains("psp-tree-label-collapse");t.shiftKey&&r?this._view.set_depth(o.row_header.filter(s=>s!==void 0).length-2):t.shiftKey?this._view.set_depth(o.row_header.filter(s=>s!==void 0).length-1):r?this._view.collapse(o.y):this._view.expand(o.y),this._num_rows=await this._view.num_rows(),this._num_columns=await this._view.num_columns(),e.draw()}async function He(e,t){if(t.which!==1)return;let o=t.target;if(o.tagName==="A")return;for(;o.tagName!=="TD"&&o.tagName!=="TH";)if(o=o.parentElement,!e.contains(o))return;if(o.classList.contains("psp-tree-label")){De.call(this,e,t),t.stopImmediatePropagation();return}let r=o.getBoundingClientRect();if(o.classList.contains("psp-menu-enabled")&&t.clientY-r.top>16){let s=e.getMeta(o),n=s.column_header?.[s.column_header?.length-1],i=this._schema[n];if(this._open_column_styles_menu.unshift(s._virtual_x),i==="string")e.draw({preserve_width:!0}),U.call(this,e,o);else{let[c,l]=await this._view.get_min_max(n);e.draw({preserve_width:!0});let a=Math.max(Math.abs(c),Math.abs(l));a>1&&(a=Math.round(a*100)/100),U.call(this,e,o,a)}t.preventDefault(),t.stopImmediatePropagation()}else o.classList.contains("psp-header-leaf")&&!o.classList.contains("psp-header-corner")&&(ne.call(this,e,t,o),t.stopImmediatePropagation())}function Te(e,t){if(t.which!==1)return;let o=t.target;for(;o.tagName!=="TD"&&o.tagName!=="TH";)if(o=o.parentElement,!e.contains(o))return;(o.classList.contains("psp-tree-label")&&t.offsetX<26||o.classList.contains("psp-header-leaf")&&!o.classList.contains("psp-header-corner"))&&t.stopImmediatePropagation()}var z={},J={datetime:Intl.DateTimeFormat,date:Intl.DateTimeFormat,integer:Intl.NumberFormat,float:Intl.NumberFormat,boolean:class{format(e){return e?"check":"close"}}},ce=z;function de(e,t,o={},r=!1){if(t===null)return"-";let s=e[e.length-1],n=r&&this._table_schema[s]||this._schema[s]||"string",i=o[s],c=n==="integer"||n==="float";if(c&&i?.number_fg_mode==="bar"){let l=Math.max(0,Math.min(.95,Math.abs(t/i.fg_gradient)*.95)),a=this._div_factory.get(),h=t>=0?"left":"right";return a.setAttribute("style",`width:${(l*100).toFixed(2)}%;position:absolute;${h}:0;height:80%;top:10%;pointer-events:none;`),a}else if(i?.format==="link"&&n==="string"){let l=document.createElement("a");return l.setAttribute("href",t),l.setAttribute("target","_blank"),l.textContent=t,l}else if(i?.format==="bold"&&n==="string"){let l=document.createElement("b");return l.textContent=t,l}else if(i?.format==="italics"&&n==="string"){let l=document.createElement("i");return l.textContent=t,l}else{let l=c&&i&&i.fixed!==void 0,a=l?`${n}${i.fixed}`:n;if(z[a]===void 0){let h=(0,ae.get_type_config)(n);if(l){let _={minimumFractionDigits:i.fixed,maximumFractionDigits:i.fixed};z[a]=new J[n]("en-us",_)}else J[n]?z[a]=new J[n]("en-us",h.format):z[a]=!1}return z[a]?z[a].format(t):t}}function*Ge(e=[],t,o){let r=o[w];for(let s of e){s=["TOTAL",...s];let n=s[s.length-1];s=s.slice(0,s.length-1).fill("");let i=de.call(this,[t[s.length-1]],n,r,!0);i instanceof HTMLElement?s=s.concat(i):s=s.concat({toString:()=>i}),s.length=t.length+1,yield s}}function We(){let e,t,o,r,s;return async function(i,c,l,a,h){let _={},d;a-c>0&&h-l>0?(this._is_old_viewport=this._last_window?.start_row===l&&this._last_window?.end_row===h&&this._last_window?.start_col===c&&this._last_window?.end_col===a,d={start_row:l,start_col:c,end_row:h,end_col:a,id:!0},_=await this._view.to_columns(d),this._last_window=d,this._ids=_.__ID__,this._reverse_columns=this._column_paths.slice(c,a).reduce((g,f,y)=>(g.set(f,y),g),new Map),this._reverse_ids=this._ids.reduce((g,f,y)=>(g.set(f?.join("|"),y),g),new Map)):this._div_factory.clear();let u=[],m=[],p=[],b=[];for(let g=c;g<Math.min(a,this._column_paths.length);++g){let f=this._column_paths[g],y=f.split("|"),v=_[f]||new Array(h-l).fill(null);u.push(v.map(L=>de.call(this,y,L,i[w]))),m.push(v),p.push(y),b.push(f)}return a-c>0&&h-l>0&&(this.last_column_paths=t,this.last_meta=e,this.last_ids=o,this.last_reverse_ids=r,this.last_reverse_columns=s,t=b,e=m,o=this._ids,r=this._reverse_ids,s=this._reverse_columns),{num_rows:this._num_rows,num_columns:this._column_paths.length,row_headers:Array.from(Ge.call(this,_.__ROW_PATH__,this._config.group_by,i)),column_headers:p,data:u,metadata:m}}}function q(e,t,o){let r=window.getComputedStyle(e).getPropertyValue(t).trim();return r.length>0?r:o}var pe=class{constructor(t){this._name=t,this._elements=[],this._index=0}clear(){this._index=0}get(){this._elements[this._index]||(this._elements[this._index]=document.createElement(this._name));let t=this._elements[this._index];return this._index+=1,t}};function _e(e,t){return W.mix(e,`rgb(${t[0]},${t[1]},${t[2]})`,.5).hex()}async function K(e,t,o,r={}){let s=await o.get_config(),n=s.expressions.map(k=>k[1]),[i,c,l,a,h,_]=await Promise.all([t.schema(),t.validate_expressions(n),o.num_rows(),o.schema(),o.expression_schema(),o.column_paths()]),d=W(q(e,"--plugin--background","#FFFFFF")).rgb(),u=x(q(e,"--rt-pos-cell--color","#338DCD")),m=x(q(e,"--rt-neg-cell--color","#FF5942")),p=x(_e(u[0],d)),b=x(_e(m[0],d)),g=x(q(e,"--active--color","#ff0000")),f={...a,...h},y={...i,...c.expression_schema},v=_.filter(k=>k!=="__ROW_PATH__"&&k!=="__ID__"),L=[],S=[];for(let k of v){let E=k.split("|"),C=E[E.length-1];S.push(f[C]),L.push(!!i[C])}let O=Object.assign(r,{_view:o,_table:t,_table_schema:y,_config:s,_num_rows:l,_schema:f,_ids:[],_open_column_styles_menu:[],_plugin_background:d,_color:g,_pos_fg_color:u,_neg_fg_color:m,_pos_bg_color:p,_neg_bg_color:b,_column_paths:v,_column_types:S,_is_editable:L,_row_header_types:s.group_by.map(k=>y[k]),_series_color_map:new Map,_series_color_seed:new Map,get_psp_type:X});return O._div_factory=O._div_factory||new pe("div"),e.setDataListener(We().bind(O,e),{virtual_mode:window.getComputedStyle(e).getPropertyValue("--datagrid-virtual-mode")?.trim()||"both"}),O}function X(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}async function ge(e,t){e.addStyleListener(Fe.bind(t,e)),e.addEventListener("mousedown",He.bind(t,e)),e.addEventListener("click",Te.bind(t,e))}var he=`regular-table{padding:0;margin:12px 0 0 12px;scrollbar-color:transparent transparent;scrollbar-width:thin;outline:none}regular-table:hover{scrollbar-color:rgba(0,0,0,.3) transparent}.sub-cell-scroll-enabled regular-table table tbody td,.sub-cell-scroll-enabled regular-table table thead th:not(.rt-group-corner){transform:translate(var(--regular-table--transform-x, 0px))}.sub-cell-scroll-enabled regular-table table tbody{transform:translateY(var(--regular-table--transform-y, 0px))}.sub-cell-scroll-enabled regular-table table tbody tr:first-child td,.sub-cell-scroll-enabled regular-table table tbody tr:first-child th{clip-path:polygon(0 var(--regular-table--clip-y, 0),0 200%,200% 200%,200% var(--regular-table--clip-y, 0))}.sub-cell-scroll-enabled regular-table table thead th.rt-group-corner{background:var(--plugin--background, white);z-index:1}.sub-cell-scroll-enabled regular-table table tbody tr td:first-of-type{clip-path:polygon(var(--regular-table--clip-x, 0) 0,var(--regular-table--clip-x, 0) 200%,200% 200%,200% 0)}.sub-cell-scroll-enabled regular-table table tbody tr:first-child td:first-of-type{clip-path:polygon(var(--regular-table--clip-x, 0) var(--regular-table--clip-y, 0),var(--regular-table--clip-x, 0) 200%,200% 200%,200% var(--regular-table--clip-y, 0))}regular-table{font-family:inherit}regular-table div[tabindex]{outline:none}regular-table>div{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}regular-table th{text-align:center}regular-table thead tr:not(:last-child) th{overflow:hidden;max-width:0px}regular-table thead tr:last-child .rt-float,regular-table tbody .rt-float{text-align:right}regular-table thead .rt-integer,regular-table tbody .rt-integer{text-align:right}regular-table tbody th{text-align:left}regular-table span.rt-tree-container{display:flex;align-items:center;height:100%}regular-table thead .rt-string,regular-table tbody .rt-string,regular-table thead .rt-date,regular-table tbody .rt-date,regular-table thead .rt-datetime,regular-table tbody .rt-datetime{text-align:left}regular-table thead tr:last-child th{border-bottom:1px solid #eaedef}regular-table tbody tr:first-child td,regular-table tbody tr:first-child th{border-top:1px solid transparent!important}regular-table th{position:relative}regular-table tr th span.rt-tree-group{margin-left:5px;margin-right:15px;border-left:1px solid #eee;height:100%}regular-table td,regular-table th{white-space:nowrap;font-size:12px;padding:0 5px;height:19px}regular-table tr:hover td{background:#eee;opacity:1}regular-table tr:hover{color:#333}regular-table table *{box-sizing:border-box}regular-table table{position:absolute;overflow:hidden;color:#666;outline:none}regular-table span.rt-row-header-icon{color:#aaa;padding-right:4px;font-family:var(--button--font-family, "Material Icons")}regular-table span.rt-column-header-icon{font-size:10px;padding-left:3px;display:inline-block;width:10px;font-family:var(--button--font-family, "Material Icons")}regular-table span.rt-row-header-icon:hover{color:#1a7da1;text-shadow:0px 0px 3px #1a7da1}regular-table .rt-selected td{background-color:#eee}regular-table .rt-cell-clip{overflow:hidden;text-overflow:ellipsis}regular-table td span.rt-group-name,regular-table th span.rt-group-name{margin-right:-5px;padding-right:5px;padding-left:8px;flex:1;height:100%}regular-table th span.rt-group-name{text-align:left}regular-table td th span.rt-group-leaf,regular-table th span.rt-group-leaf{margin-left:16px;height:100%}regular-table .rt-column-resize{height:100%;width:10px;position:absolute;top:0;right:0;cursor:col-resize}regular-table a{color:var(--rt-pos-cell--color)}regular-table a:visited{color:var(--active--color)}regular-table::-webkit-scrollbar,regular-table::-webkit-scrollbar-corner{background-color:transparent;height:12px;width:12px}regular-table::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#0000;border-radius:5px}regular-table::-webkit-scrollbar-thumb:horizontal{border-bottom:2px solid transparent;border-top:2px solid transparent}regular-table::-webkit-scrollbar-thumb:vertical{border-left:2px solid transparent;border-right:2px solid transparent}regular-table:hover::-webkit-scrollbar-thumb{background-color:#00000026}regular-table::-webkit-scrollbar-thumb:hover{background-color:#0000004d}.psp-header-border:not(.psp-is-top):not(.psp-header-leaf){box-shadow:1px 0 var(--inactive--color, #eaedef)}.psp-header-group{box-shadow:0 10px 0 -9px var(--inactive--color, #eaedef)}.psp-is-top{box-shadow:5px 4px 0 -4px var(--inactive--color, #eaedef)}.psp-is-top.psp-header-group:not(.psp-header-group-corner){box-shadow:5px 4px 0 -4px var(--inactive--color, #eaedef),0 10px 0 -9px var(--inactive--color, #eaedef)}.psp-header-border.psp-header-group:not(.psp-is-top):not(.psp-header-group-corner){box-shadow:1px 0 var(--inactive--color, #eaedef),0 10px 0 -9px var(--inactive--color, #eaedef)}.psp-header-leaf.psp-header-border{box-shadow:5px -4px 0 -4px var(--inactive--color, #eaedef)}tr:only-child th{box-shadow:none!important}regular-table tbody tr:hover th.psp-tree-leaf:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover th.psp-tree-label:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover td:not(.psp-row-selected):not(.psp-row-subselected){border-color:var(--rt-hover--border-color, #c5c9d080)!important;background-color:transparent;box-shadow:0 1px 0 var(--rt-hover--border-color, #c5c9d080),0 3px #0000000d,0 5px #00000003}regular-table tbody tr:hover+tr th.psp-tree-leaf:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover+tr th.psp-tree-label:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover+tr td:not(.psp-row-selected):not(.psp-row-subselected){border-top-color:transparent}regular-table tbody tr th:first-child:not(:empty),regular-table tbody tr th:first-child:empty+th:not(:empty),regular-table tbody tr th:first-child:empty~th:empty+th:not(:empty),regular-table tbody tr td:first-child{border-left-width:1px;border-left-color:transparent}regular-table tbody tr th:last-child,regular-table tbody tr td:last-child{border-right-width:1px;border-right-color:transparent}regular-table tbody tr:hover{color:#161616}regular-table tbody tr:hover th:first-child:not(:empty),regular-table tbody tr:hover th:first-child:empty+th:not(:empty),regular-table tbody tr:hover th:first-child:empty~th:empty+th:not(:empty),regular-table tbody tr:hover td:first-child{border-left-color:var(--rt-hover--border-color, #c5c9d080)!important}regular-table tbody tr:hover th:last-child,regular-table tbody tr:hover td:last-child{border-right-color:var(--rt-hover--border-color, #c5c9d080)!important}perspective-viewer[settings] regular-table .psp-header-leaf{height:36px;vertical-align:top;padding-top:2px}perspective-viewer[settings] regular-table .psp-header-leaf:not(.psp-header-corner):before{font-family:var(--button--font-family, inherit);content:var(--column-style-open-button--content, var(--config-button-icon--content, "\\1f527"));position:absolute;width:calc(100% - 8px);left:5px;bottom:0px;color:var(--inactive--color, #b4b7be)}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-enabled:not(.psp-header-corner):before{color:inherit;cursor:pointer}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-open:not(.psp-header-corner){pointer-events:none}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-open:not(.psp-header-corner):before{content:var(--column-style-close-button--content, "X")}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-enabled:hover:before{color:#338dcd}perspective-viewer[settings] regular-table .psp-header-leaf .rt-column-resize{height:18px}.psp-row-selected,:hover .psp-row-selected,:hover th.psp-tree-leaf.psp-row-selected,:hover th.psp-tree-label.psp-row-selected{color:#fff!important;background-color:#ea7319!important;border-color:#ea7319!important}.psp-row-selected.psp-tree-label:not(:hover):before{color:#fff}.psp-row-subselected,:hover .psp-row-subselected,:hover th.psp-tree-leaf.psp-row-subselected,:hover th.psp-tree-label.psp-row-subselected{background:rgba(234,115,25,.2)!important}.psp-error{color:red}td:focus{outline:#666;outline-style:dotted;outline-width:1px}perspective-viewer.dragging regular-table{pointer-events:none}.psp-header-border:last-child{border-right-width:0px}.psp-header-sort-desc:after{font-family:var(--button--font-family, inherit);font-size:10px;content:var(--sort-order-desc--content, "\\2193")}.psp-header-sort-asc:after{font-family:var(--button--font-family, inherit);font-size:10px;content:var(--sort-order-asc--content, "\\2191")}.psp-header-sort-col-desc:after{font-family:var(--button--font-family, inherit);font-size:10px;content:var(--sort-order-col-desc--content, "\\2190")}.psp-header-sort-col-asc:after{font-family:var(--button--font-family, inherit);font-size:10px;content:var(--sort-order-col-asc--content, "\\2192")}tbody th:last-of-type{border-right:1px solid #eaedef;overflow:hidden;text-overflow:ellipsis}tbody th:empty{background-image:linear-gradient(to right,transparent 9px,#eee 10px,transparent 11px);background-repeat:no-repeat;min-width:20px;max-width:20px;pointer-events:none}.psp-tree-label{max-width:0px;min-width:0px}.psp-tree-label:before{color:#ccc;font-family:var(--button--font-family, inherit);padding-right:11px;vertical-align:-1px}.psp-tree-label-expand:before{content:var(--tree-label-expand--content, "+")}.psp-tree-label-collapse:before{content:var(--tree-label-collapse--content, "-")}.psp-tree-label:hover:before{color:#338dcd;text-shadow:0px 0px 5px #338dcd}regular-table thead tr:last-child th{border-bottom-width:1px;border-bottom-color:var(--inactive--color, #eaedef)}.psp-tree-leaf{padding-left:24px}.psp-align-right{text-align:right}.psp-align-left{text-align:left}.psp-positive:not(:focus){color:var(--rt-pos-cell--color, #338dcd)}.psp-negative:not(:focus){color:var(--rt-neg-cell--color, #ff5942)}regular-table table tbody td{min-width:52px!important}.psp-is-width-override .rt-column-resize,.rt-column-resize:hover{border:1px dashed #999;border-bottom-width:0px;border-left-width:0px}.psp-bool-type{font-family:var(--button--font-family, "Material Icons")}.boolean-editable{cursor:pointer}regular-table table{user-select:none;color:#161616;border-collapse:separate}regular-table table th{font-weight:400}regular-table table td,regular-table table th{border-color:#eaedef;height:23px}regular-table table .psp-header-group{text-overflow:ellipsis}regular-table table .psp-header-leaf{border-bottom-width:0px}regular-table table td,regular-table table th.psp-tree-label,regular-table table th.psp-tree-label,regular-table table th.psp-tree-leaf,regular-table table tbody tr:first-child th{border-style:solid;border-width:0px;border-top-width:1px}regular-table table tbody th:empty{background-position:0px -10px}@keyframes pulse_pos{0%{background-color:var(--pulse--background-color-start, rgba(0, 128, 255, .5))}to{background-color:var(--pulse--background-color-end, rgba(0, 128, 255, 0))}}@keyframes pulse_pos2{0%{background-color:var(--pulse--background-color-start, rgba(0, 128, 255, .5))}to{background-color:var(--pulse--background-color-end, rgba(0, 128, 255, 0))}}@keyframes pulse_neg{0%{background-color:var(--pulse--background-color-start, rgba(255, 25, 0, .5))}to{background-color:var(--pulse--background-color-end, rgba(255, 25, 0, 0))}}@keyframes pulse_neg2{0%{background-color:var(--pulse--background-color-start, rgba(255, 25, 0, .5))}to{background-color:var(--pulse--background-color-end, rgba(255, 25, 0, 0))}}
`;var ue=`:host{position:relative;display:block}:host #container{position:absolute;display:flex;flex-direction:column;justify-content:stretch;align-items:stretch;top:0;left:0;right:0;bottom:0}:host #toolbar{display:flex;align-items:center;height:36px}:host #slot-container{flex:1;position:relative}#scroll_lock.lock-scroll:before{content:var(--toolbar-scroll-lock-active--content)}#scroll_lock:before{content:var(--toolbar-scroll-lock--content)}#select_mode:before{content:"highlight_alt"}#edit_mode:before{content:var(--toolbar-edit-mode--content)}#edit_mode.editable:before{content:var(--toolbar-edit-mode-active--content)}:host(.aggregated) #toolbar #edit_mode{display:none}.button:before{color:var(--inactive--color, #ccc);line-height:36px;font-size:14px;font-family:var(--button--font-family, "Material Icons Outlined");vertical-align:bottom;margin:0 11px}.button.editable:before,.button.lock-scroll:before{color:inherit}.button{user-select:none;width:36px;box-sizing:border-box}.button>span{display:none;margin:0;padding:0}.button:hover{opacity:1;display:flex;align-items:center;color:inherit;cursor:pointer;min-width:105px;background-color:#0000000d}.button:hover:before{margin:0 6px 0 11px}.button:hover>span{display:contents;font-size:12px;font-weight:300;line-height:36px}
`;async function I({_view:e,_config:t},o,r){let s=t.group_by,n=t.split_by,i=o>=0?o:0,c=i+1,l=await e.to_json({start_row:i,end_row:c}),h=l.map(g=>g.__ROW_PATH__)[0]||[],_=s.map((g,f)=>{let y=h[f];return y?[g,"==",y]:void 0}).filter(g=>g),d=s.length>0?r+1:r,u=Object.keys(l[0])[d],m={row:l[0]},p=[];if(u){let g=u.split("|");m.column_names=[g[g.length-1]],p=n.map((f,y)=>{let v=g[y];return v?[f,"==",v]:void 0}).filter(f=>f).filter(([,,f])=>f!=="__ROW_PATH__")}let b=t.filter.concat(_).concat(p);return m.config={filter:b},m}var P=new WeakMap;async function Ve(e,t,o){let r=e.getMeta(o.target);if(!t.hasAttribute("selectable")||o.handled||o.which!==1||!r)return;let s=this._ids[r.y-r.y0];if(r&&r.y>=0){let n=P.get(e),i=!!n&&n.reduce((a,h,_)=>a&&h===s[_],!0),c=!!n&&s.length===n.length&&i,l=[];c?P.delete(e):(P.set(e,s),l=await I(this,r.y,r.x),l=l.config.filter),await e.draw({preserve_width:!0}),o.handled=!0,t.dispatchEvent(new CustomEvent("perspective-select",{bubbles:!0,composed:!0,detail:{selected:!c,config:{filter:l}}}))}}function Ye(e,t){if(!t.hasAttribute("selectable"))return;let o=P.has(e),r=P.get(e);for(let s of e.querySelectorAll("td"))if(!o)s.classList.toggle("psp-row-selected",!1),s.classList.toggle("psp-row-subselected",!1);else{let n=e.getMeta(s),i=this._ids[n.y-n.y0],c=r.reduce((l,a,h)=>l&&a===i[h],!0);s.classList.toggle("psp-row-selected",i.length===r.length&&c),s.classList.toggle("psp-row-subselected",i.length!==r.length&&c)}for(let s of e.querySelectorAll("tbody th")){let n=e.getMeta(s),i=this._ids[n.y-n.y0];if(!o||!!i[n.row_header_x])s.classList.toggle("psp-row-selected",!1),s.classList.toggle("psp-row-subselected",!1);else{let c=r.reduce((l,a,h)=>l&&a===i[h],!0);s.classList.toggle("psp-row-selected",i.length===r.length&&c),s.classList.toggle("psp-row-subselected",i.length!==r.length&&c)}}}function fe(e,t){e.addStyleListener(Ye.bind(this,e,t)),e.addEventListener("mousedown",Ve.bind(this,e,t))}async function be(e){P.delete(e);for(let t of e.querySelectorAll("td,th"))t.classList.toggle("psp-row-selected",!1),t.classList.toggle("psp-row-subselected",!1)}async function Ue(e,t,o){let r=e.getMeta(o.target);if(!r)return;let{x:s,y:n}=r,{row:i,column_names:c,config:l}=await I(this,n,s);t.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{row:i,column_names:c,config:l}}))}function me(e,t){e.addEventListener("click",Ue.bind(this,e,t))}var A=new WeakMap;function Je(e){let t;return async function(...o){if(!!t&&await t&&!!t)return;let r;t=new Promise(s=>r=s),await e.apply(this,o),t=void 0,r()}}function ye(){if(this.isContentEditable){let e=document.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this),t.setEnd(e.endContainer,e.endOffset),t.toString().length}else return this.target.selectionStart}function xe(e,t,o){let r=e.getMeta(o),s=t._schema[t._column_paths[r.x]];if(r){let n=o.textContent,i=t._ids[r.y-r.y0];if(s==="float"||s==="integer"){if(n=parseFloat(n.replace(/,/g,"")),isNaN(n))return!1}else if(s==="date"||s==="datetime"){if(n=Date.parse(n),isNaN(n))return!1}else s==="boolean"&&(n=n==="check"?!1:n==="close"?!0:null);let c={__INDEX__:i,[t._column_paths[r.x]]:n};return t._table.update([c],{port_id:t._edit_port}),!0}}function $(e,t=!1){let o=this._config.group_by.length===0&&this._config.split_by.length===0,r=e.hasAttribute("selectable"),s=t||!!e.children[0]._is_edit_mode;return o&&!r&&s}var R=Je(async function(e,t,o,r){let s=e.getMeta(t),n=this._column_paths.length,i=this._num_rows,c=A.get(e);if(!c)return;s.x+o<n&&0<=s.x+o&&(c.x=s.x+o),s.y+r<i&&0<=s.y+r&&(c.y=s.y+r);let l=Math.max(s.x0-10,0),a=Math.min(s.x0+10,n),h=Math.max(s.y0-5,0),_=Math.min(s.y0+10,i),d=s.x0+o,u=s.y0+r;for(;!ve(e)&&d>=l&&d<a&&u>=h&&u<_;)await e.scrollToCell(d,u,n,i),A.set(e,c),d+=o,u+=r});function Ke(e,t){let o=e[w]||{},r=$.call(this,t);e.parentElement.classList.toggle("edit-mode-allowed",$.call(this,t,!0));for(let s of e.querySelectorAll("td")){let n=e.getMeta(s),i=this.get_psp_type(n);if(r&&this._is_editable[n.x]){let c=n.column_header[n.column_header.length-1];i==="string"&&o[c]?.format==="link"?(s.toggleAttribute("contenteditable",!1),s.classList.toggle("boolean-editable",!1)):i==="boolean"?(s.toggleAttribute("contenteditable",!1),s.classList.toggle("boolean-editable",n.user!==null)):(r!==s.hasAttribute("contenteditable")&&s.toggleAttribute("contenteditable",r),s.classList.toggle("boolean-editable",!1))}else s.toggleAttribute("contenteditable",!1),s.classList.toggle("boolean-editable",!1)}}var ve=e=>{let t=e.querySelectorAll("td"),o=A.get(e);if(o){for(let r of t){let s=e.getMeta(r);if(s.x===o.x&&s.y===o.y)return document.activeElement!==r&&r.focus({preventScroll:!0}),!0}document.activeElement!==document.body&&e.contains(document.activeElement)&&document.activeElement.blur()}};function Xe(e,t,o){if(!$.call(this,t))return;let r=document.activeElement;switch(o.target.classList.remove("psp-error"),o.keyCode){case 13:o.preventDefault(),o.shiftKey?R.call(this,e,r,0,-1):R.call(this,e,r,0,1);break;case 37:ye.call(r)==0&&(o.preventDefault(),R.call(this,e,r,-1,0));break;case 38:o.preventDefault(),R.call(this,e,r,0,-1);break;case 39:ye.call(r)==r.textContent.length&&(o.preventDefault(),R.call(this,e,r,1,0));break;case 40:o.preventDefault(),R.call(this,e,r,0,1);break;default:}}function Qe(e,t,o){if($.call(this,t)&&A.has(e)){o.target.classList.remove("psp-error");let r=A.get(e);A.delete(e),r.content!==o.target.textContent&&(xe(e,this,o.target)||(o.target.textContent=r.content,o.target.classList.add("psp-error"),o.target.focus()))}}function Ze(e,t,o){let r=e.getMeta(o.target);if(r){let s={x:r.x,y:r.y,content:o.target.textContent};A.set(e,s)}}function et(e,t,o){let r=e.getMeta(o.target);if(typeof r?.x!="undefined"){let s=$.call(this,t),n=this._is_editable[r.x],i=this.get_psp_type(r)==="boolean",c=o.target.textContent==="-";s&&n&&i&&!c&&xe(e,this,o.target)}}async function we(e,t){this._edit_port=await t.getEditPort(),e.addStyleListener(Ke.bind(this,e,t)),e.addStyleListener(ve.bind(this,e,t)),e.addEventListener("click",et.bind(this,e,t)),e.addEventListener("focusin",Ze.bind(this,e,t)),e.addEventListener("focusout",Qe.bind(this,e,t)),e.addEventListener("keydown",Xe.bind(this,e,t))}var ke=class extends HTMLElement{constructor(){super();this.datagrid=document.createElement("regular-table"),this.datagrid.formatters=ce,this._is_scroll_lock=!0}connectedCallback(){this._toolbar||(this._toolbar=document.createElement("perspective-viewer-datagrid-toolbar"),this._toolbar.setAttribute("slot","plugin-settings"),this._toolbar.attachShadow({mode:"open"}),this._toolbar.shadowRoot.innerHTML=`
                <style>
                    ${ue}
                </style>
                <div id="toolbar">
                    <span id="scroll_lock" class="lock-scroll button"><span>Align Scroll</span></span>
                    <span id="edit_mode" class="button"><span>Read Only</span></span>
                </div>
            `,this._scroll_lock=this._toolbar.shadowRoot.querySelector("#scroll_lock"),this._scroll_lock.addEventListener("click",()=>this._toggle_scroll_lock()),this._edit_mode=this._toolbar.shadowRoot.querySelector("#edit_mode"),this._edit_mode.addEventListener("click",()=>{this._toggle_edit_mode(),this.datagrid.draw(),this.parentElement.dispatchEvent(new Event("perspective-config-update"))})),this.parentElement.appendChild(this._toolbar)}disconnectedCallback(){this._toolbar.parentElement.removeChild(this._toolbar)}_toggle_edit_mode(t=void 0){typeof t=="undefined"&&(t=!this._is_edit_mode),this._is_edit_mode=t,this.classList.toggle("editable",t),this._edit_mode!==void 0&&(this._edit_mode.classList.toggle("editable",t),t?this._edit_mode.children[0].textContent="Editable":this._edit_mode.children[0].textContent="Read Only")}_toggle_scroll_lock(t=void 0){typeof t=="undefined"&&(t=!this._is_scroll_lock),this._is_scroll_lock=t,this.classList.toggle("sub-cell-scroll-enabled",!t),this._scroll_lock!==void 0&&(this._scroll_lock.classList.toggle("lock-scroll",t),t?this._scroll_lock.children[0].textContent="Align Scroll":this._scroll_lock.children[0].textContent="Free Scroll")}async activate(t){let o=this.parentElement,r=await o.getTable(!0);this._initialized?await K(this.datagrid,r,t,this.model):(this.innerHTML="",this.appendChild(this.datagrid),this.model=await K(this.datagrid,r,t),ge(this.datagrid,this.model),await fe.call(this.model,this.datagrid,o),await me.call(this.model,this.datagrid,o),await we.call(this.model,this.datagrid,o),await le.call(this.model,this.datagrid,o),this._initialized=!0)}get name(){return"Datagrid"}get category(){return"Basic"}get select_mode(){return"toggle"}get min_config_columns(){}get config_column_names(){}async draw(t){if(this.parentElement&&await this.activate(t),!this.isConnected||this.offsetParent==null)return;let o=this._save_column_size_overrides(),r=this.parentElement,s=this.datagrid.draw({invalid_columns:!0});this.model._preserve_focus_state?this.model._preserve_focus_state=!1:(this.datagrid.scrollTop=0,this.datagrid.scrollLeft=0,be(this.datagrid,r),this.datagrid._resetAutoSize()),this._restore_column_size_overrides(o),await s,this._toolbar.classList.toggle("aggregated",this.model._config.group_by.length>0||this.model._config.split_by.length>0)}async update(t){this.model._num_rows=await t.num_rows(),await this.datagrid.draw()}async resize(){!this.isConnected||this.offsetParent==null||this._initialized&&await this.datagrid.draw()}async clear(){this.datagrid._resetAutoSize(),this.datagrid.clear()}save(){if(this.datagrid){let t=this.datagrid,o={columns:{},scroll_lock:!!this._is_scroll_lock,editable:!!this._is_edit_mode};for(let s of Object.keys(t[w]||{})){let n=Object.assign({},t[w][s]);(n?.pos_fg_color||n?.pos_bg_color)&&(n.pos_fg_color=n.pos_fg_color?.[0],n.neg_fg_color=n.neg_fg_color?.[0],n.pos_bg_color=n.pos_bg_color?.[0],n.neg_bg_color=n.neg_bg_color?.[0]),n?.color&&(n.color=n.color[0]),o.columns[s]=n}let r=this._save_column_size_overrides();for(let s of Object.keys(r||{}))o.columns[s]||(o.columns[s]={}),o.columns[s].column_size_override=r[s];return JSON.parse(JSON.stringify(o))}return{}}restore(t){t=JSON.parse(JSON.stringify(t));let o={};if(t.columns)for(let s of Object.keys(t.columns)){let n=t.columns[s];n.column_size_override!==void 0&&(o[s]=n.column_size_override,delete n.column_size_override),n?.pos_fg_color&&(n.pos_fg_color=x(n.pos_fg_color),n.neg_fg_color=x(n.neg_fg_color)),n?.pos_bg_color&&(n.pos_bg_color=x(n.pos_bg_color),n.neg_bg_color=x(n.neg_bg_color)),n?.color&&(n.color=x(n.color)),Object.keys(n).length===0&&delete t.columns[s]}"editable"in t&&this._toggle_edit_mode(t.editable),"scroll_lock"in t&&this._toggle_scroll_lock(t.scroll_lock);let r=this.datagrid;try{r._resetAutoSize()}catch{}this._restore_column_size_overrides(o,!0),r[w]=t.columns}async restyle(t){this.draw(t)}delete(){this.datagrid.table_model&&this.datagrid._resetAutoSize(),this.datagrid.clear()}_save_column_size_overrides(){if(!this._initialized)return[];if(this._cached_column_sizes){let i=this._cached_column_sizes;return this._cached_column_sizes=void 0,i}let t=this.datagrid._column_sizes.override,{group_by:o,columns:r}=this.model._config,s=o?.length>0?o.length+1:0,n={};for(let i of Object.keys(t))if(t[i]!==void 0){let c=i-s;c>-1?n[this.model._column_paths[c]]=t[i]:c===-1&&(n.__ROW_PATH__=t[i])}return n}_restore_column_size_overrides(t,o=!1){if(!this._initialized)return;o&&(this._cached_column_sizes=t);let r={},{group_by:s,columns:n}=this.model._config,i=s?.length>0?s.length+1:0;for(let c of Object.keys(t))if(c==="__ROW_PATH__")r[i-1]=t[c];else{let l=this.model._column_paths.indexOf(c);r[l+i]=t[c]}this.datagrid._column_sizes.override=r}};customElements.define("perspective-viewer-datagrid",ke);function tt(){let e=document.createElement("style");e.textContent=he,document.head.insertBefore(e,document.head.firstChild)}function ot(){customElements.get("perspective-viewer").registerPlugin("perspective-viewer-datagrid")}customElements.whenDefined("perspective-viewer").then(ot);tt();export{ke as PerspectiveViewerDatagridPluginElement};
//# sourceMappingURL=perspective-viewer-datagrid.js.map
