{
  "version": 3,
  "sources": ["../../../perspective/src/js/config/settings.js", "../../../perspective/src/js/config/index.js", "../../../../node_modules/chroma-js/chroma.js", "../../../../node_modules/regular-table/src/js/constants.js", "../../../../node_modules/regular-table/src/js/utils.js", "../../../../node_modules/regular-table/src/js/scroll_panel.js", "../../../../node_modules/regular-table/src/js/events.js", "../../../../node_modules/regular-table/src/js/view_model.js", "../../../../node_modules/regular-table/src/js/thead.js", "../../../../node_modules/regular-table/src/js/tbody.js", "../../../../node_modules/regular-table/src/js/table.js", "../../../../node_modules/regular-table/src/js/index.js", "../../src/js/regular_table_handlers.js", "../../src/js/cell_flash.js", "../../src/js/sorting.js", "../../src/js/plugin_menu.js", "../../src/js/color_utils.js", "../../src/js/getCellConfig.js", "../../src/js/row_selection.js", "../../src/js/click.js", "../../src/js/editing.js", "../../src/js/plugin.js"],
  "sourcesContent": ["/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n/**\n * The default settings which populate `perspective.config.js`.\n */\nmodule.exports.default = {\n    /**\n     * `types` are the type-specific configuration options.  Each key is the\n     * name of a perspective type; their values are configuration objects for\n     * that type.\n     */\n    types: {\n        float: {\n            /**\n             * Which filter operator should be the default when a column of this\n             * type is pivotted.\n             */\n            filter_operator: \"==\",\n\n            /**\n             * Which aggregate should be the default when a column of this type\n             * is pivotted.\n             */\n            aggregate: \"sum\",\n\n            /**\n             * The format object for this type.  Can be either an\n             * `toLocaleString()` `options` object for this type (or supertype),\n             * or a function which returns the formatted string for this type.\n             */\n            format: {\n                style: \"decimal\",\n                minimumFractionDigits: 2,\n                maximumFractionDigits: 2,\n            },\n        },\n        string: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n        },\n        integer: {\n            filter_operator: \"==\",\n            aggregate: \"sum\",\n            format: {},\n        },\n        boolean: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n        },\n        datetime: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n            format: {\n                week: \"numeric\",\n                year: \"numeric\",\n                month: \"numeric\",\n                day: \"numeric\",\n                hour: \"numeric\",\n                minute: \"numeric\",\n                second: \"numeric\",\n            },\n            null_value: -1,\n        },\n        date: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n            format: {\n                week: \"numeric\",\n                year: \"numeric\",\n                month: \"numeric\",\n                day: \"numeric\",\n            },\n            null_value: -1,\n        },\n    },\n};\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nconst DEFAULT_CONFIG = require(\"./settings.js\").default;\n\nmodule.exports.get_types = function () {\n    return Object.keys(module.exports.get_config().types);\n};\n\nmodule.exports.get_type_config = function (type) {\n    const config = {};\n    if (module.exports.get_config().types[type]) {\n        Object.assign(config, module.exports.get_config().types[type]);\n    }\n    if (config.type) {\n        const props = module.exports.get_type_config(config.type);\n        Object.assign(props, config);\n        return props;\n    } else {\n        return config;\n    }\n};\n\nfunction isObject(item) {\n    return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nfunction mergeDeep(target, ...sources) {\n    if (!sources.length) return target;\n    const source = sources.shift();\n\n    if (isObject(target) && isObject(source)) {\n        for (const key in source) {\n            if (isObject(source[key])) {\n                if (!target[key]) Object.assign(target, {[key]: {}});\n                mergeDeep(target[key], source[key]);\n            } else {\n                Object.assign(target, {[key]: source[key]});\n            }\n        }\n    }\n\n    return mergeDeep(target, ...sources);\n}\n\nglobalThis.__PERSPECTIVE_CONFIG__ = undefined;\n\nmodule.exports.override_config = function (config) {\n    if (globalThis.__PERSPECTIVE_CONFIG__) {\n        console.warn(\"Config already initialized!\");\n    }\n    globalThis.__PERSPECTIVE_CONFIG__ = mergeDeep(DEFAULT_CONFIG, config);\n};\n\nmodule.exports.get_config = function get_config() {\n    if (!globalThis.__PERSPECTIVE_CONFIG__) {\n        globalThis.__PERSPECTIVE_CONFIG__ = mergeDeep(\n            DEFAULT_CONFIG,\n            globalThis.__TEMPLATE_CONFIG__ || {}\n        );\n    }\n    return globalThis.__PERSPECTIVE_CONFIG__;\n};\n", "\n/**\n * @license\n *\n * chroma.js - JavaScript library for color conversions\n * \n * Copyright (c) 2011-2017, Gregor Aisch\n * All rights reserved.\n * \n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n * \n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer.\n * \n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n * \n * 3. The name Gregor Aisch may not be used to endorse or promote products\n *    derived from this software without specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\n(function() {\n  var Color, DEG2RAD, LAB_CONSTANTS, PI, PITHIRD, RAD2DEG, TWOPI, _average_lrgb, _guess_formats, _guess_formats_sorted, _input, _interpolators, abs, atan2, bezier, blend, blend_f, brewer, burn, chroma, clip_rgb, cmyk2rgb, colors, cos, css2rgb, darken, dodge, each, floor, hcg2rgb, hex2rgb, hsi2rgb, hsl2css, hsl2rgb, hsv2rgb, interpolate, interpolate_hsx, interpolate_lab, interpolate_lrgb, interpolate_num, interpolate_rgb, lab2lch, lab2rgb, lab_xyz, lch2lab, lch2rgb, lighten, limit, log, luminance_x, m, max, multiply, normal, num2rgb, overlay, pow, rgb2cmyk, rgb2css, rgb2hcg, rgb2hex, rgb2hsi, rgb2hsl, rgb2hsv, rgb2lab, rgb2lch, rgb2luminance, rgb2num, rgb2temperature, rgb2xyz, rgb_xyz, rnd, root, round, screen, sin, sqrt, temperature2rgb, type, unpack, w3cx11, xyz_lab, xyz_rgb,\n    slice = [].slice;\n\n  type = (function() {\n\n    /*\n    for browser-safe type checking+\n    ported from jQuery's $.type\n     */\n    var classToType, len, name, o, ref;\n    classToType = {};\n    ref = \"Boolean Number String Function Array Date RegExp Undefined Null\".split(\" \");\n    for (o = 0, len = ref.length; o < len; o++) {\n      name = ref[o];\n      classToType[\"[object \" + name + \"]\"] = name.toLowerCase();\n    }\n    return function(obj) {\n      var strType;\n      strType = Object.prototype.toString.call(obj);\n      return classToType[strType] || \"object\";\n    };\n  })();\n\n  limit = function(x, min, max) {\n    if (min == null) {\n      min = 0;\n    }\n    if (max == null) {\n      max = 1;\n    }\n    if (x < min) {\n      x = min;\n    }\n    if (x > max) {\n      x = max;\n    }\n    return x;\n  };\n\n  unpack = function(args) {\n    if (args.length >= 3) {\n      return Array.prototype.slice.call(args);\n    } else {\n      return args[0];\n    }\n  };\n\n  clip_rgb = function(rgb) {\n    var i, o;\n    rgb._clipped = false;\n    rgb._unclipped = rgb.slice(0);\n    for (i = o = 0; o < 3; i = ++o) {\n      if (i < 3) {\n        if (rgb[i] < 0 || rgb[i] > 255) {\n          rgb._clipped = true;\n        }\n        if (rgb[i] < 0) {\n          rgb[i] = 0;\n        }\n        if (rgb[i] > 255) {\n          rgb[i] = 255;\n        }\n      } else if (i === 3) {\n        if (rgb[i] < 0) {\n          rgb[i] = 0;\n        }\n        if (rgb[i] > 1) {\n          rgb[i] = 1;\n        }\n      }\n    }\n    if (!rgb._clipped) {\n      delete rgb._unclipped;\n    }\n    return rgb;\n  };\n\n  PI = Math.PI, round = Math.round, cos = Math.cos, floor = Math.floor, pow = Math.pow, log = Math.log, sin = Math.sin, sqrt = Math.sqrt, atan2 = Math.atan2, max = Math.max, abs = Math.abs;\n\n  TWOPI = PI * 2;\n\n  PITHIRD = PI / 3;\n\n  DEG2RAD = PI / 180;\n\n  RAD2DEG = 180 / PI;\n\n  chroma = function() {\n    if (arguments[0] instanceof Color) {\n      return arguments[0];\n    }\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, arguments, function(){});\n  };\n\n  chroma[\"default\"] = chroma;\n\n  _interpolators = [];\n\n  if ((typeof module !== \"undefined\" && module !== null) && (module.exports != null)) {\n    module.exports = chroma;\n  }\n\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return chroma;\n    });\n  } else {\n    root = typeof exports !== \"undefined\" && exports !== null ? exports : this;\n    root.chroma = chroma;\n  }\n\n  chroma.version = '1.4.1';\n\n  _input = {};\n\n  _guess_formats = [];\n\n  _guess_formats_sorted = false;\n\n  Color = (function() {\n    function Color() {\n      var arg, args, chk, len, len1, me, mode, o, w;\n      me = this;\n      args = [];\n      for (o = 0, len = arguments.length; o < len; o++) {\n        arg = arguments[o];\n        if (arg != null) {\n          args.push(arg);\n        }\n      }\n      if (args.length > 1) {\n        mode = args[args.length - 1];\n      }\n      if (_input[mode] != null) {\n        me._rgb = clip_rgb(_input[mode](unpack(args.slice(0, -1))));\n      } else {\n        if (!_guess_formats_sorted) {\n          _guess_formats = _guess_formats.sort(function(a, b) {\n            return b.p - a.p;\n          });\n          _guess_formats_sorted = true;\n        }\n        for (w = 0, len1 = _guess_formats.length; w < len1; w++) {\n          chk = _guess_formats[w];\n          mode = chk.test.apply(chk, args);\n          if (mode) {\n            break;\n          }\n        }\n        if (mode) {\n          me._rgb = clip_rgb(_input[mode].apply(_input, args));\n        }\n      }\n      if (me._rgb == null) {\n        console.warn('unknown format: ' + args);\n      }\n      if (me._rgb == null) {\n        me._rgb = [0, 0, 0];\n      }\n      if (me._rgb.length === 3) {\n        me._rgb.push(1);\n      }\n    }\n\n    Color.prototype.toString = function() {\n      return this.hex();\n    };\n\n    return Color;\n\n  })();\n\n  chroma._input = _input;\n\n\n  /**\n  \tColorBrewer colors for chroma.js\n  \n  \tCopyright (c) 2002 Cynthia Brewer, Mark Harrower, and The \n  \tPennsylvania State University.\n  \n  \tLicensed under the Apache License, Version 2.0 (the \"License\"); \n  \tyou may not use this file except in compliance with the License.\n  \tYou may obtain a copy of the License at\t\n  \thttp://www.apache.org/licenses/LICENSE-2.0\n  \n  \tUnless required by applicable law or agreed to in writing, software distributed\n  \tunder the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n  \tCONDITIONS OF ANY KIND, either express or implied. See the License for the\n  \tspecific language governing permissions and limitations under the License.\n  \n      @preserve\n   */\n\n  chroma.brewer = brewer = {\n    OrRd: ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84', '#fc8d59', '#ef6548', '#d7301f', '#b30000', '#7f0000'],\n    PuBu: ['#fff7fb', '#ece7f2', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#045a8d', '#023858'],\n    BuPu: ['#f7fcfd', '#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#810f7c', '#4d004b'],\n    Oranges: ['#fff5eb', '#fee6ce', '#fdd0a2', '#fdae6b', '#fd8d3c', '#f16913', '#d94801', '#a63603', '#7f2704'],\n    BuGn: ['#f7fcfd', '#e5f5f9', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45', '#006d2c', '#00441b'],\n    YlOrBr: ['#ffffe5', '#fff7bc', '#fee391', '#fec44f', '#fe9929', '#ec7014', '#cc4c02', '#993404', '#662506'],\n    YlGn: ['#ffffe5', '#f7fcb9', '#d9f0a3', '#addd8e', '#78c679', '#41ab5d', '#238443', '#006837', '#004529'],\n    Reds: ['#fff5f0', '#fee0d2', '#fcbba1', '#fc9272', '#fb6a4a', '#ef3b2c', '#cb181d', '#a50f15', '#67000d'],\n    RdPu: ['#fff7f3', '#fde0dd', '#fcc5c0', '#fa9fb5', '#f768a1', '#dd3497', '#ae017e', '#7a0177', '#49006a'],\n    Greens: ['#f7fcf5', '#e5f5e0', '#c7e9c0', '#a1d99b', '#74c476', '#41ab5d', '#238b45', '#006d2c', '#00441b'],\n    YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58'],\n    Purples: ['#fcfbfd', '#efedf5', '#dadaeb', '#bcbddc', '#9e9ac8', '#807dba', '#6a51a3', '#54278f', '#3f007d'],\n    GnBu: ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'],\n    Greys: ['#ffffff', '#f0f0f0', '#d9d9d9', '#bdbdbd', '#969696', '#737373', '#525252', '#252525', '#000000'],\n    YlOrRd: ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'],\n    PuRd: ['#f7f4f9', '#e7e1ef', '#d4b9da', '#c994c7', '#df65b0', '#e7298a', '#ce1256', '#980043', '#67001f'],\n    Blues: ['#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'],\n    PuBuGn: ['#fff7fb', '#ece2f0', '#d0d1e6', '#a6bddb', '#67a9cf', '#3690c0', '#02818a', '#016c59', '#014636'],\n    Viridis: ['#440154', '#482777', '#3f4a8a', '#31678e', '#26838f', '#1f9d8a', '#6cce5a', '#b6de2b', '#fee825'],\n    Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2'],\n    RdYlGn: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850', '#006837'],\n    RdBu: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#f7f7f7', '#d1e5f0', '#92c5de', '#4393c3', '#2166ac', '#053061'],\n    PiYG: ['#8e0152', '#c51b7d', '#de77ae', '#f1b6da', '#fde0ef', '#f7f7f7', '#e6f5d0', '#b8e186', '#7fbc41', '#4d9221', '#276419'],\n    PRGn: ['#40004b', '#762a83', '#9970ab', '#c2a5cf', '#e7d4e8', '#f7f7f7', '#d9f0d3', '#a6dba0', '#5aae61', '#1b7837', '#00441b'],\n    RdYlBu: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee090', '#ffffbf', '#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695'],\n    BrBG: ['#543005', '#8c510a', '#bf812d', '#dfc27d', '#f6e8c3', '#f5f5f5', '#c7eae5', '#80cdc1', '#35978f', '#01665e', '#003c30'],\n    RdGy: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#ffffff', '#e0e0e0', '#bababa', '#878787', '#4d4d4d', '#1a1a1a'],\n    PuOr: ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],\n    Set2: ['#66c2a5', '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f', '#e5c494', '#b3b3b3'],\n    Accent: ['#7fc97f', '#beaed4', '#fdc086', '#ffff99', '#386cb0', '#f0027f', '#bf5b17', '#666666'],\n    Set1: ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'],\n    Set3: ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'],\n    Dark2: ['#1b9e77', '#d95f02', '#7570b3', '#e7298a', '#66a61e', '#e6ab02', '#a6761d', '#666666'],\n    Paired: ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'],\n    Pastel2: ['#b3e2cd', '#fdcdac', '#cbd5e8', '#f4cae4', '#e6f5c9', '#fff2ae', '#f1e2cc', '#cccccc'],\n    Pastel1: ['#fbb4ae', '#b3cde3', '#ccebc5', '#decbe4', '#fed9a6', '#ffffcc', '#e5d8bd', '#fddaec', '#f2f2f2']\n  };\n\n  (function() {\n    var key, results;\n    results = [];\n    for (key in brewer) {\n      results.push(brewer[key.toLowerCase()] = brewer[key]);\n    }\n    return results;\n  })();\n\n\n  /**\n  \tX11 color names\n  \n  \thttp://www.w3.org/TR/css3-color/#svg-color\n   */\n\n  w3cx11 = {\n    aliceblue: '#f0f8ff',\n    antiquewhite: '#faebd7',\n    aqua: '#00ffff',\n    aquamarine: '#7fffd4',\n    azure: '#f0ffff',\n    beige: '#f5f5dc',\n    bisque: '#ffe4c4',\n    black: '#000000',\n    blanchedalmond: '#ffebcd',\n    blue: '#0000ff',\n    blueviolet: '#8a2be2',\n    brown: '#a52a2a',\n    burlywood: '#deb887',\n    cadetblue: '#5f9ea0',\n    chartreuse: '#7fff00',\n    chocolate: '#d2691e',\n    coral: '#ff7f50',\n    cornflower: '#6495ed',\n    cornflowerblue: '#6495ed',\n    cornsilk: '#fff8dc',\n    crimson: '#dc143c',\n    cyan: '#00ffff',\n    darkblue: '#00008b',\n    darkcyan: '#008b8b',\n    darkgoldenrod: '#b8860b',\n    darkgray: '#a9a9a9',\n    darkgreen: '#006400',\n    darkgrey: '#a9a9a9',\n    darkkhaki: '#bdb76b',\n    darkmagenta: '#8b008b',\n    darkolivegreen: '#556b2f',\n    darkorange: '#ff8c00',\n    darkorchid: '#9932cc',\n    darkred: '#8b0000',\n    darksalmon: '#e9967a',\n    darkseagreen: '#8fbc8f',\n    darkslateblue: '#483d8b',\n    darkslategray: '#2f4f4f',\n    darkslategrey: '#2f4f4f',\n    darkturquoise: '#00ced1',\n    darkviolet: '#9400d3',\n    deeppink: '#ff1493',\n    deepskyblue: '#00bfff',\n    dimgray: '#696969',\n    dimgrey: '#696969',\n    dodgerblue: '#1e90ff',\n    firebrick: '#b22222',\n    floralwhite: '#fffaf0',\n    forestgreen: '#228b22',\n    fuchsia: '#ff00ff',\n    gainsboro: '#dcdcdc',\n    ghostwhite: '#f8f8ff',\n    gold: '#ffd700',\n    goldenrod: '#daa520',\n    gray: '#808080',\n    green: '#008000',\n    greenyellow: '#adff2f',\n    grey: '#808080',\n    honeydew: '#f0fff0',\n    hotpink: '#ff69b4',\n    indianred: '#cd5c5c',\n    indigo: '#4b0082',\n    ivory: '#fffff0',\n    khaki: '#f0e68c',\n    laserlemon: '#ffff54',\n    lavender: '#e6e6fa',\n    lavenderblush: '#fff0f5',\n    lawngreen: '#7cfc00',\n    lemonchiffon: '#fffacd',\n    lightblue: '#add8e6',\n    lightcoral: '#f08080',\n    lightcyan: '#e0ffff',\n    lightgoldenrod: '#fafad2',\n    lightgoldenrodyellow: '#fafad2',\n    lightgray: '#d3d3d3',\n    lightgreen: '#90ee90',\n    lightgrey: '#d3d3d3',\n    lightpink: '#ffb6c1',\n    lightsalmon: '#ffa07a',\n    lightseagreen: '#20b2aa',\n    lightskyblue: '#87cefa',\n    lightslategray: '#778899',\n    lightslategrey: '#778899',\n    lightsteelblue: '#b0c4de',\n    lightyellow: '#ffffe0',\n    lime: '#00ff00',\n    limegreen: '#32cd32',\n    linen: '#faf0e6',\n    magenta: '#ff00ff',\n    maroon: '#800000',\n    maroon2: '#7f0000',\n    maroon3: '#b03060',\n    mediumaquamarine: '#66cdaa',\n    mediumblue: '#0000cd',\n    mediumorchid: '#ba55d3',\n    mediumpurple: '#9370db',\n    mediumseagreen: '#3cb371',\n    mediumslateblue: '#7b68ee',\n    mediumspringgreen: '#00fa9a',\n    mediumturquoise: '#48d1cc',\n    mediumvioletred: '#c71585',\n    midnightblue: '#191970',\n    mintcream: '#f5fffa',\n    mistyrose: '#ffe4e1',\n    moccasin: '#ffe4b5',\n    navajowhite: '#ffdead',\n    navy: '#000080',\n    oldlace: '#fdf5e6',\n    olive: '#808000',\n    olivedrab: '#6b8e23',\n    orange: '#ffa500',\n    orangered: '#ff4500',\n    orchid: '#da70d6',\n    palegoldenrod: '#eee8aa',\n    palegreen: '#98fb98',\n    paleturquoise: '#afeeee',\n    palevioletred: '#db7093',\n    papayawhip: '#ffefd5',\n    peachpuff: '#ffdab9',\n    peru: '#cd853f',\n    pink: '#ffc0cb',\n    plum: '#dda0dd',\n    powderblue: '#b0e0e6',\n    purple: '#800080',\n    purple2: '#7f007f',\n    purple3: '#a020f0',\n    rebeccapurple: '#663399',\n    red: '#ff0000',\n    rosybrown: '#bc8f8f',\n    royalblue: '#4169e1',\n    saddlebrown: '#8b4513',\n    salmon: '#fa8072',\n    sandybrown: '#f4a460',\n    seagreen: '#2e8b57',\n    seashell: '#fff5ee',\n    sienna: '#a0522d',\n    silver: '#c0c0c0',\n    skyblue: '#87ceeb',\n    slateblue: '#6a5acd',\n    slategray: '#708090',\n    slategrey: '#708090',\n    snow: '#fffafa',\n    springgreen: '#00ff7f',\n    steelblue: '#4682b4',\n    tan: '#d2b48c',\n    teal: '#008080',\n    thistle: '#d8bfd8',\n    tomato: '#ff6347',\n    turquoise: '#40e0d0',\n    violet: '#ee82ee',\n    wheat: '#f5deb3',\n    white: '#ffffff',\n    whitesmoke: '#f5f5f5',\n    yellow: '#ffff00',\n    yellowgreen: '#9acd32'\n  };\n\n  chroma.colors = colors = w3cx11;\n\n  lab2rgb = function() {\n    var a, args, b, g, l, r, x, y, z;\n    args = unpack(arguments);\n    l = args[0], a = args[1], b = args[2];\n    y = (l + 16) / 116;\n    x = isNaN(a) ? y : y + a / 500;\n    z = isNaN(b) ? y : y - b / 200;\n    y = LAB_CONSTANTS.Yn * lab_xyz(y);\n    x = LAB_CONSTANTS.Xn * lab_xyz(x);\n    z = LAB_CONSTANTS.Zn * lab_xyz(z);\n    r = xyz_rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);\n    g = xyz_rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);\n    b = xyz_rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  xyz_rgb = function(r) {\n    return 255 * (r <= 0.00304 ? 12.92 * r : 1.055 * pow(r, 1 / 2.4) - 0.055);\n  };\n\n  lab_xyz = function(t) {\n    if (t > LAB_CONSTANTS.t1) {\n      return t * t * t;\n    } else {\n      return LAB_CONSTANTS.t2 * (t - LAB_CONSTANTS.t0);\n    }\n  };\n\n  LAB_CONSTANTS = {\n    Kn: 18,\n    Xn: 0.950470,\n    Yn: 1,\n    Zn: 1.088830,\n    t0: 0.137931034,\n    t1: 0.206896552,\n    t2: 0.12841855,\n    t3: 0.008856452\n  };\n\n  rgb2lab = function() {\n    var b, g, r, ref, ref1, x, y, z;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    ref1 = rgb2xyz(r, g, b), x = ref1[0], y = ref1[1], z = ref1[2];\n    return [116 * y - 16, 500 * (x - y), 200 * (y - z)];\n  };\n\n  rgb_xyz = function(r) {\n    if ((r /= 255) <= 0.04045) {\n      return r / 12.92;\n    } else {\n      return pow((r + 0.055) / 1.055, 2.4);\n    }\n  };\n\n  xyz_lab = function(t) {\n    if (t > LAB_CONSTANTS.t3) {\n      return pow(t, 1 / 3);\n    } else {\n      return t / LAB_CONSTANTS.t2 + LAB_CONSTANTS.t0;\n    }\n  };\n\n  rgb2xyz = function() {\n    var b, g, r, ref, x, y, z;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = rgb_xyz(r);\n    g = rgb_xyz(g);\n    b = rgb_xyz(b);\n    x = xyz_lab((0.4124564 * r + 0.3575761 * g + 0.1804375 * b) / LAB_CONSTANTS.Xn);\n    y = xyz_lab((0.2126729 * r + 0.7151522 * g + 0.0721750 * b) / LAB_CONSTANTS.Yn);\n    z = xyz_lab((0.0193339 * r + 0.1191920 * g + 0.9503041 * b) / LAB_CONSTANTS.Zn);\n    return [x, y, z];\n  };\n\n  chroma.lab = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['lab']), function(){});\n  };\n\n  _input.lab = lab2rgb;\n\n  Color.prototype.lab = function() {\n    return rgb2lab(this._rgb);\n  };\n\n  bezier = function(colors) {\n    var I, I0, I1, c, lab0, lab1, lab2, lab3, ref, ref1, ref2;\n    colors = (function() {\n      var len, o, results;\n      results = [];\n      for (o = 0, len = colors.length; o < len; o++) {\n        c = colors[o];\n        results.push(chroma(c));\n      }\n      return results;\n    })();\n    if (colors.length === 2) {\n      ref = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref[0], lab1 = ref[1];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push(lab0[i] + t * (lab1[i] - lab0[i]));\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 3) {\n      ref1 = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref1[0], lab1 = ref1[1], lab2 = ref1[2];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push((1 - t) * (1 - t) * lab0[i] + 2 * (1 - t) * t * lab1[i] + t * t * lab2[i]);\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 4) {\n      ref2 = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref2[0], lab1 = ref2[1], lab2 = ref2[2], lab3 = ref2[3];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push((1 - t) * (1 - t) * (1 - t) * lab0[i] + 3 * (1 - t) * (1 - t) * t * lab1[i] + 3 * (1 - t) * t * t * lab2[i] + t * t * t * lab3[i]);\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 5) {\n      I0 = bezier(colors.slice(0, 3));\n      I1 = bezier(colors.slice(2, 5));\n      I = function(t) {\n        if (t < 0.5) {\n          return I0(t * 2);\n        } else {\n          return I1((t - 0.5) * 2);\n        }\n      };\n    }\n    return I;\n  };\n\n  chroma.bezier = function(colors) {\n    var f;\n    f = bezier(colors);\n    f.scale = function() {\n      return chroma.scale(f);\n    };\n    return f;\n  };\n\n  chroma.cubehelix = function(start, rotations, hue, gamma, lightness) {\n    var dh, dl, f;\n    if (start == null) {\n      start = 300;\n    }\n    if (rotations == null) {\n      rotations = -1.5;\n    }\n    if (hue == null) {\n      hue = 1;\n    }\n    if (gamma == null) {\n      gamma = 1;\n    }\n    if (lightness == null) {\n      lightness = [0, 1];\n    }\n    dh = 0;\n    if (type(lightness) === 'array') {\n      dl = lightness[1] - lightness[0];\n    } else {\n      dl = 0;\n      lightness = [lightness, lightness];\n    }\n    f = function(fract) {\n      var a, amp, b, cos_a, g, h, l, r, sin_a;\n      a = TWOPI * ((start + 120) / 360 + rotations * fract);\n      l = pow(lightness[0] + dl * fract, gamma);\n      h = dh !== 0 ? hue[0] + fract * dh : hue;\n      amp = h * l * (1 - l) / 2;\n      cos_a = cos(a);\n      sin_a = sin(a);\n      r = l + amp * (-0.14861 * cos_a + 1.78277 * sin_a);\n      g = l + amp * (-0.29227 * cos_a - 0.90649 * sin_a);\n      b = l + amp * (+1.97294 * cos_a);\n      return chroma(clip_rgb([r * 255, g * 255, b * 255, 1]));\n    };\n    f.start = function(s) {\n      if (s == null) {\n        return start;\n      }\n      start = s;\n      return f;\n    };\n    f.rotations = function(r) {\n      if (r == null) {\n        return rotations;\n      }\n      rotations = r;\n      return f;\n    };\n    f.gamma = function(g) {\n      if (g == null) {\n        return gamma;\n      }\n      gamma = g;\n      return f;\n    };\n    f.hue = function(h) {\n      if (h == null) {\n        return hue;\n      }\n      hue = h;\n      if (type(hue) === 'array') {\n        dh = hue[1] - hue[0];\n        if (dh === 0) {\n          hue = hue[1];\n        }\n      } else {\n        dh = 0;\n      }\n      return f;\n    };\n    f.lightness = function(h) {\n      if (h == null) {\n        return lightness;\n      }\n      if (type(h) === 'array') {\n        lightness = h;\n        dl = h[1] - h[0];\n      } else {\n        lightness = [h, h];\n        dl = 0;\n      }\n      return f;\n    };\n    f.scale = function() {\n      return chroma.scale(f);\n    };\n    f.hue(hue);\n    return f;\n  };\n\n  chroma.random = function() {\n    var code, digits, i, o;\n    digits = '0123456789abcdef';\n    code = '#';\n    for (i = o = 0; o < 6; i = ++o) {\n      code += digits.charAt(floor(Math.random() * 16));\n    }\n    return new Color(code);\n  };\n\n  _interpolators = [];\n\n  interpolate = function(col1, col2, f, m) {\n    var interpol, len, o, res;\n    if (f == null) {\n      f = 0.5;\n    }\n    if (m == null) {\n      m = 'rgb';\n    }\n\n    /*\n    interpolates between colors\n    f = 0 --> me\n    f = 1 --> col\n     */\n    if (type(col1) !== 'object') {\n      col1 = chroma(col1);\n    }\n    if (type(col2) !== 'object') {\n      col2 = chroma(col2);\n    }\n    for (o = 0, len = _interpolators.length; o < len; o++) {\n      interpol = _interpolators[o];\n      if (m === interpol[0]) {\n        res = interpol[1](col1, col2, f, m);\n        break;\n      }\n    }\n    if (res == null) {\n      throw \"color mode \" + m + \" is not supported\";\n    }\n    return res.alpha(col1.alpha() + f * (col2.alpha() - col1.alpha()));\n  };\n\n  chroma.interpolate = interpolate;\n\n  Color.prototype.interpolate = function(col2, f, m) {\n    return interpolate(this, col2, f, m);\n  };\n\n  chroma.mix = interpolate;\n\n  Color.prototype.mix = Color.prototype.interpolate;\n\n  _input.rgb = function() {\n    var k, ref, results, v;\n    ref = unpack(arguments);\n    results = [];\n    for (k in ref) {\n      v = ref[k];\n      results.push(v);\n    }\n    return results;\n  };\n\n  chroma.rgb = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['rgb']), function(){});\n  };\n\n  Color.prototype.rgb = function(round) {\n    if (round == null) {\n      round = true;\n    }\n    if (round) {\n      return this._rgb.map(Math.round).slice(0, 3);\n    } else {\n      return this._rgb.slice(0, 3);\n    }\n  };\n\n  Color.prototype.rgba = function(round) {\n    if (round == null) {\n      round = true;\n    }\n    if (!round) {\n      return this._rgb.slice(0);\n    }\n    return [Math.round(this._rgb[0]), Math.round(this._rgb[1]), Math.round(this._rgb[2]), this._rgb[3]];\n  };\n\n  _guess_formats.push({\n    p: 3,\n    test: function(n) {\n      var a;\n      a = unpack(arguments);\n      if (type(a) === 'array' && a.length === 3) {\n        return 'rgb';\n      }\n      if (a.length === 4 && type(a[3]) === \"number\" && a[3] >= 0 && a[3] <= 1) {\n        return 'rgb';\n      }\n    }\n  });\n\n  _input.lrgb = _input.rgb;\n\n  interpolate_lrgb = function(col1, col2, f, m) {\n    var xyz0, xyz1;\n    xyz0 = col1._rgb;\n    xyz1 = col2._rgb;\n    return new Color(sqrt(pow(xyz0[0], 2) * (1 - f) + pow(xyz1[0], 2) * f), sqrt(pow(xyz0[1], 2) * (1 - f) + pow(xyz1[1], 2) * f), sqrt(pow(xyz0[2], 2) * (1 - f) + pow(xyz1[2], 2) * f), m);\n  };\n\n  _average_lrgb = function(colors) {\n    var col, f, len, o, rgb, xyz;\n    f = 1 / colors.length;\n    xyz = [0, 0, 0, 0];\n    for (o = 0, len = colors.length; o < len; o++) {\n      col = colors[o];\n      rgb = col._rgb;\n      xyz[0] += pow(rgb[0], 2) * f;\n      xyz[1] += pow(rgb[1], 2) * f;\n      xyz[2] += pow(rgb[2], 2) * f;\n      xyz[3] += rgb[3] * f;\n    }\n    xyz[0] = sqrt(xyz[0]);\n    xyz[1] = sqrt(xyz[1]);\n    xyz[2] = sqrt(xyz[2]);\n    if (xyz[3] > 1) {\n      xyz[3] = 1;\n    }\n    return new Color(clip_rgb(xyz));\n  };\n\n  _interpolators.push(['lrgb', interpolate_lrgb]);\n\n  chroma.average = function(colors, mode) {\n    var A, alpha, c, cnt, dx, dy, first, i, l, len, o, xyz, xyz2;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    l = colors.length;\n    colors = colors.map(function(c) {\n      return chroma(c);\n    });\n    first = colors.splice(0, 1)[0];\n    if (mode === 'lrgb') {\n      return _average_lrgb(colors);\n    }\n    xyz = first.get(mode);\n    cnt = [];\n    dx = 0;\n    dy = 0;\n    for (i in xyz) {\n      xyz[i] = xyz[i] || 0;\n      cnt.push(isNaN(xyz[i]) ? 0 : 1);\n      if (mode.charAt(i) === 'h' && !isNaN(xyz[i])) {\n        A = xyz[i] / 180 * PI;\n        dx += cos(A);\n        dy += sin(A);\n      }\n    }\n    alpha = first.alpha();\n    for (o = 0, len = colors.length; o < len; o++) {\n      c = colors[o];\n      xyz2 = c.get(mode);\n      alpha += c.alpha();\n      for (i in xyz) {\n        if (!isNaN(xyz2[i])) {\n          cnt[i] += 1;\n          if (mode.charAt(i) === 'h') {\n            A = xyz2[i] / 180 * PI;\n            dx += cos(A);\n            dy += sin(A);\n          } else {\n            xyz[i] += xyz2[i];\n          }\n        }\n      }\n    }\n    for (i in xyz) {\n      if (mode.charAt(i) === 'h') {\n        A = atan2(dy / cnt[i], dx / cnt[i]) / PI * 180;\n        while (A < 0) {\n          A += 360;\n        }\n        while (A >= 360) {\n          A -= 360;\n        }\n        xyz[i] = A;\n      } else {\n        xyz[i] = xyz[i] / cnt[i];\n      }\n    }\n    return chroma(xyz, mode).alpha(alpha / l);\n  };\n\n  hex2rgb = function(hex) {\n    var a, b, g, r, rgb, u;\n    if (hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)) {\n      if (hex.length === 4 || hex.length === 7) {\n        hex = hex.substr(1);\n      }\n      if (hex.length === 3) {\n        hex = hex.split(\"\");\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n      }\n      u = parseInt(hex, 16);\n      r = u >> 16;\n      g = u >> 8 & 0xFF;\n      b = u & 0xFF;\n      return [r, g, b, 1];\n    }\n    if (hex.match(/^#?([A-Fa-f0-9]{8})$/)) {\n      if (hex.length === 9) {\n        hex = hex.substr(1);\n      }\n      u = parseInt(hex, 16);\n      r = u >> 24 & 0xFF;\n      g = u >> 16 & 0xFF;\n      b = u >> 8 & 0xFF;\n      a = round((u & 0xFF) / 0xFF * 100) / 100;\n      return [r, g, b, a];\n    }\n    if ((_input.css != null) && (rgb = _input.css(hex))) {\n      return rgb;\n    }\n    throw \"unknown color: \" + hex;\n  };\n\n  rgb2hex = function(channels, mode) {\n    var a, b, g, hxa, r, str, u;\n    if (mode == null) {\n      mode = 'auto';\n    }\n    r = channels[0], g = channels[1], b = channels[2], a = channels[3];\n    if (mode === 'auto') {\n      mode = a < 1 ? 'rgba' : 'rgb';\n    }\n    r = Math.round(r);\n    g = Math.round(g);\n    b = Math.round(b);\n    u = r << 16 | g << 8 | b;\n    str = \"000000\" + u.toString(16);\n    str = str.substr(str.length - 6);\n    hxa = '0' + round(a * 255).toString(16);\n    hxa = hxa.substr(hxa.length - 2);\n    return \"#\" + (function() {\n      switch (mode.toLowerCase()) {\n        case 'rgba':\n          return str + hxa;\n        case 'argb':\n          return hxa + str;\n        default:\n          return str;\n      }\n    })();\n  };\n\n  _input.hex = function(h) {\n    return hex2rgb(h);\n  };\n\n  chroma.hex = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hex']), function(){});\n  };\n\n  Color.prototype.hex = function(mode) {\n    if (mode == null) {\n      mode = 'auto';\n    }\n    return rgb2hex(this._rgb, mode);\n  };\n\n  _guess_formats.push({\n    p: 4,\n    test: function(n) {\n      if (arguments.length === 1 && type(n) === \"string\") {\n        return 'hex';\n      }\n    }\n  });\n\n  hsl2rgb = function() {\n    var args, b, c, g, h, i, l, o, r, ref, s, t1, t2, t3;\n    args = unpack(arguments);\n    h = args[0], s = args[1], l = args[2];\n    if (s === 0) {\n      r = g = b = l * 255;\n    } else {\n      t3 = [0, 0, 0];\n      c = [0, 0, 0];\n      t2 = l < 0.5 ? l * (1 + s) : l + s - l * s;\n      t1 = 2 * l - t2;\n      h /= 360;\n      t3[0] = h + 1 / 3;\n      t3[1] = h;\n      t3[2] = h - 1 / 3;\n      for (i = o = 0; o <= 2; i = ++o) {\n        if (t3[i] < 0) {\n          t3[i] += 1;\n        }\n        if (t3[i] > 1) {\n          t3[i] -= 1;\n        }\n        if (6 * t3[i] < 1) {\n          c[i] = t1 + (t2 - t1) * 6 * t3[i];\n        } else if (2 * t3[i] < 1) {\n          c[i] = t2;\n        } else if (3 * t3[i] < 2) {\n          c[i] = t1 + (t2 - t1) * ((2 / 3) - t3[i]) * 6;\n        } else {\n          c[i] = t1;\n        }\n      }\n      ref = [round(c[0] * 255), round(c[1] * 255), round(c[2] * 255)], r = ref[0], g = ref[1], b = ref[2];\n    }\n    if (args.length > 3) {\n      return [r, g, b, args[3]];\n    } else {\n      return [r, g, b];\n    }\n  };\n\n  rgb2hsl = function(r, g, b) {\n    var h, l, min, ref, s;\n    if (r !== void 0 && r.length >= 3) {\n      ref = r, r = ref[0], g = ref[1], b = ref[2];\n    }\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    l = (max + min) / 2;\n    if (max === min) {\n      s = 0;\n      h = Number.NaN;\n    } else {\n      s = l < 0.5 ? (max - min) / (max + min) : (max - min) / (2 - max - min);\n    }\n    if (r === max) {\n      h = (g - b) / (max - min);\n    } else if (g === max) {\n      h = 2 + (b - r) / (max - min);\n    } else if (b === max) {\n      h = 4 + (r - g) / (max - min);\n    }\n    h *= 60;\n    if (h < 0) {\n      h += 360;\n    }\n    return [h, s, l];\n  };\n\n  chroma.hsl = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsl']), function(){});\n  };\n\n  _input.hsl = hsl2rgb;\n\n  Color.prototype.hsl = function() {\n    return rgb2hsl(this._rgb);\n  };\n\n  hsv2rgb = function() {\n    var args, b, f, g, h, i, p, q, r, ref, ref1, ref2, ref3, ref4, ref5, s, t, v;\n    args = unpack(arguments);\n    h = args[0], s = args[1], v = args[2];\n    v *= 255;\n    if (s === 0) {\n      r = g = b = v;\n    } else {\n      if (h === 360) {\n        h = 0;\n      }\n      if (h > 360) {\n        h -= 360;\n      }\n      if (h < 0) {\n        h += 360;\n      }\n      h /= 60;\n      i = floor(h);\n      f = h - i;\n      p = v * (1 - s);\n      q = v * (1 - s * f);\n      t = v * (1 - s * (1 - f));\n      switch (i) {\n        case 0:\n          ref = [v, t, p], r = ref[0], g = ref[1], b = ref[2];\n          break;\n        case 1:\n          ref1 = [q, v, p], r = ref1[0], g = ref1[1], b = ref1[2];\n          break;\n        case 2:\n          ref2 = [p, v, t], r = ref2[0], g = ref2[1], b = ref2[2];\n          break;\n        case 3:\n          ref3 = [p, q, v], r = ref3[0], g = ref3[1], b = ref3[2];\n          break;\n        case 4:\n          ref4 = [t, p, v], r = ref4[0], g = ref4[1], b = ref4[2];\n          break;\n        case 5:\n          ref5 = [v, p, q], r = ref5[0], g = ref5[1], b = ref5[2];\n      }\n    }\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hsv = function() {\n    var b, delta, g, h, min, r, ref, s, v;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    delta = max - min;\n    v = max / 255.0;\n    if (max === 0) {\n      h = Number.NaN;\n      s = 0;\n    } else {\n      s = delta / max;\n      if (r === max) {\n        h = (g - b) / delta;\n      }\n      if (g === max) {\n        h = 2 + (b - r) / delta;\n      }\n      if (b === max) {\n        h = 4 + (r - g) / delta;\n      }\n      h *= 60;\n      if (h < 0) {\n        h += 360;\n      }\n    }\n    return [h, s, v];\n  };\n\n  chroma.hsv = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsv']), function(){});\n  };\n\n  _input.hsv = hsv2rgb;\n\n  Color.prototype.hsv = function() {\n    return rgb2hsv(this._rgb);\n  };\n\n  num2rgb = function(num) {\n    var b, g, r;\n    if (type(num) === \"number\" && num >= 0 && num <= 0xFFFFFF) {\n      r = num >> 16;\n      g = (num >> 8) & 0xFF;\n      b = num & 0xFF;\n      return [r, g, b, 1];\n    }\n    console.warn(\"unknown num color: \" + num);\n    return [0, 0, 0, 1];\n  };\n\n  rgb2num = function() {\n    var b, g, r, ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    return (r << 16) + (g << 8) + b;\n  };\n\n  chroma.num = function(num) {\n    return new Color(num, 'num');\n  };\n\n  Color.prototype.num = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    return rgb2num(this._rgb, mode);\n  };\n\n  _input.num = num2rgb;\n\n  _guess_formats.push({\n    p: 1,\n    test: function(n) {\n      if (arguments.length === 1 && type(n) === \"number\" && n >= 0 && n <= 0xFFFFFF) {\n        return 'num';\n      }\n    }\n  });\n\n  hcg2rgb = function() {\n    var _c, _g, args, b, c, f, g, h, i, p, q, r, ref, ref1, ref2, ref3, ref4, ref5, t, v;\n    args = unpack(arguments);\n    h = args[0], c = args[1], _g = args[2];\n    c = c / 100;\n    g = g / 100 * 255;\n    _c = c * 255;\n    if (c === 0) {\n      r = g = b = _g;\n    } else {\n      if (h === 360) {\n        h = 0;\n      }\n      if (h > 360) {\n        h -= 360;\n      }\n      if (h < 0) {\n        h += 360;\n      }\n      h /= 60;\n      i = floor(h);\n      f = h - i;\n      p = _g * (1 - c);\n      q = p + _c * (1 - f);\n      t = p + _c * f;\n      v = p + _c;\n      switch (i) {\n        case 0:\n          ref = [v, t, p], r = ref[0], g = ref[1], b = ref[2];\n          break;\n        case 1:\n          ref1 = [q, v, p], r = ref1[0], g = ref1[1], b = ref1[2];\n          break;\n        case 2:\n          ref2 = [p, v, t], r = ref2[0], g = ref2[1], b = ref2[2];\n          break;\n        case 3:\n          ref3 = [p, q, v], r = ref3[0], g = ref3[1], b = ref3[2];\n          break;\n        case 4:\n          ref4 = [t, p, v], r = ref4[0], g = ref4[1], b = ref4[2];\n          break;\n        case 5:\n          ref5 = [v, p, q], r = ref5[0], g = ref5[1], b = ref5[2];\n      }\n    }\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hcg = function() {\n    var _g, b, c, delta, g, h, min, r, ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    delta = max - min;\n    c = delta * 100 / 255;\n    _g = min / (255 - delta) * 100;\n    if (delta === 0) {\n      h = Number.NaN;\n    } else {\n      if (r === max) {\n        h = (g - b) / delta;\n      }\n      if (g === max) {\n        h = 2 + (b - r) / delta;\n      }\n      if (b === max) {\n        h = 4 + (r - g) / delta;\n      }\n      h *= 60;\n      if (h < 0) {\n        h += 360;\n      }\n    }\n    return [h, c, _g];\n  };\n\n  chroma.hcg = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hcg']), function(){});\n  };\n\n  _input.hcg = hcg2rgb;\n\n  Color.prototype.hcg = function() {\n    return rgb2hcg(this._rgb);\n  };\n\n  css2rgb = function(css) {\n    var aa, ab, hsl, i, m, o, rgb, w;\n    css = css.toLowerCase();\n    if ((chroma.colors != null) && chroma.colors[css]) {\n      return hex2rgb(chroma.colors[css]);\n    }\n    if (m = css.match(/rgb\\(\\s*(\\-?\\d+),\\s*(\\-?\\d+)\\s*,\\s*(\\-?\\d+)\\s*\\)/)) {\n      rgb = m.slice(1, 4);\n      for (i = o = 0; o <= 2; i = ++o) {\n        rgb[i] = +rgb[i];\n      }\n      rgb[3] = 1;\n    } else if (m = css.match(/rgba\\(\\s*(\\-?\\d+),\\s*(\\-?\\d+)\\s*,\\s*(\\-?\\d+)\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      rgb = m.slice(1, 5);\n      for (i = w = 0; w <= 3; i = ++w) {\n        rgb[i] = +rgb[i];\n      }\n    } else if (m = css.match(/rgb\\(\\s*(\\-?\\d+(?:\\.\\d+)?)%,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*\\)/)) {\n      rgb = m.slice(1, 4);\n      for (i = aa = 0; aa <= 2; i = ++aa) {\n        rgb[i] = round(rgb[i] * 2.55);\n      }\n      rgb[3] = 1;\n    } else if (m = css.match(/rgba\\(\\s*(\\-?\\d+(?:\\.\\d+)?)%,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      rgb = m.slice(1, 5);\n      for (i = ab = 0; ab <= 2; i = ++ab) {\n        rgb[i] = round(rgb[i] * 2.55);\n      }\n      rgb[3] = +rgb[3];\n    } else if (m = css.match(/hsl\\(\\s*(\\-?\\d+(?:\\.\\d+)?),\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*\\)/)) {\n      hsl = m.slice(1, 4);\n      hsl[1] *= 0.01;\n      hsl[2] *= 0.01;\n      rgb = hsl2rgb(hsl);\n      rgb[3] = 1;\n    } else if (m = css.match(/hsla\\(\\s*(\\-?\\d+(?:\\.\\d+)?),\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      hsl = m.slice(1, 4);\n      hsl[1] *= 0.01;\n      hsl[2] *= 0.01;\n      rgb = hsl2rgb(hsl);\n      rgb[3] = +m[4];\n    }\n    return rgb;\n  };\n\n  rgb2css = function(rgba) {\n    var mode;\n    mode = rgba[3] < 1 ? 'rgba' : 'rgb';\n    if (mode === 'rgb') {\n      return mode + '(' + rgba.slice(0, 3).map(round).join(',') + ')';\n    } else if (mode === 'rgba') {\n      return mode + '(' + rgba.slice(0, 3).map(round).join(',') + ',' + rgba[3] + ')';\n    } else {\n\n    }\n  };\n\n  rnd = function(a) {\n    return round(a * 100) / 100;\n  };\n\n  hsl2css = function(hsl, alpha) {\n    var mode;\n    mode = alpha < 1 ? 'hsla' : 'hsl';\n    hsl[0] = rnd(hsl[0] || 0);\n    hsl[1] = rnd(hsl[1] * 100) + '%';\n    hsl[2] = rnd(hsl[2] * 100) + '%';\n    if (mode === 'hsla') {\n      hsl[3] = alpha;\n    }\n    return mode + '(' + hsl.join(',') + ')';\n  };\n\n  _input.css = function(h) {\n    return css2rgb(h);\n  };\n\n  chroma.css = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['css']), function(){});\n  };\n\n  Color.prototype.css = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    if (mode.slice(0, 3) === 'rgb') {\n      return rgb2css(this._rgb);\n    } else if (mode.slice(0, 3) === 'hsl') {\n      return hsl2css(this.hsl(), this.alpha());\n    }\n  };\n\n  _input.named = function(name) {\n    return hex2rgb(w3cx11[name]);\n  };\n\n  _guess_formats.push({\n    p: 5,\n    test: function(n) {\n      if (arguments.length === 1 && (w3cx11[n] != null)) {\n        return 'named';\n      }\n    }\n  });\n\n  Color.prototype.name = function(n) {\n    var h, k;\n    if (arguments.length) {\n      if (w3cx11[n]) {\n        this._rgb = hex2rgb(w3cx11[n]);\n      }\n      this._rgb[3] = 1;\n      this;\n    }\n    h = this.hex('rgb');\n    for (k in w3cx11) {\n      if (h === w3cx11[k]) {\n        return k;\n      }\n    }\n    return h;\n  };\n\n  lch2lab = function() {\n\n    /*\n    Convert from a qualitative parameter h and a quantitative parameter l to a 24-bit pixel.\n    These formulas were invented by David Dalrymple to obtain maximum contrast without going\n    out of gamut if the parameters are in the range 0-1.\n    \n    A saturation multiplier was added by Gregor Aisch\n     */\n    var c, h, l, ref;\n    ref = unpack(arguments), l = ref[0], c = ref[1], h = ref[2];\n    h = h * DEG2RAD;\n    return [l, cos(h) * c, sin(h) * c];\n  };\n\n  lch2rgb = function() {\n    var L, a, args, b, c, g, h, l, r, ref, ref1;\n    args = unpack(arguments);\n    l = args[0], c = args[1], h = args[2];\n    ref = lch2lab(l, c, h), L = ref[0], a = ref[1], b = ref[2];\n    ref1 = lab2rgb(L, a, b), r = ref1[0], g = ref1[1], b = ref1[2];\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  lab2lch = function() {\n    var a, b, c, h, l, ref;\n    ref = unpack(arguments), l = ref[0], a = ref[1], b = ref[2];\n    c = sqrt(a * a + b * b);\n    h = (atan2(b, a) * RAD2DEG + 360) % 360;\n    if (round(c * 10000) === 0) {\n      h = Number.NaN;\n    }\n    return [l, c, h];\n  };\n\n  rgb2lch = function() {\n    var a, b, g, l, r, ref, ref1;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    ref1 = rgb2lab(r, g, b), l = ref1[0], a = ref1[1], b = ref1[2];\n    return lab2lch(l, a, b);\n  };\n\n  chroma.lch = function() {\n    var args;\n    args = unpack(arguments);\n    return new Color(args, 'lch');\n  };\n\n  chroma.hcl = function() {\n    var args;\n    args = unpack(arguments);\n    return new Color(args, 'hcl');\n  };\n\n  _input.lch = lch2rgb;\n\n  _input.hcl = function() {\n    var c, h, l, ref;\n    ref = unpack(arguments), h = ref[0], c = ref[1], l = ref[2];\n    return lch2rgb([l, c, h]);\n  };\n\n  Color.prototype.lch = function() {\n    return rgb2lch(this._rgb);\n  };\n\n  Color.prototype.hcl = function() {\n    return rgb2lch(this._rgb).reverse();\n  };\n\n  rgb2cmyk = function(mode) {\n    var b, c, f, g, k, m, r, ref, y;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = r / 255;\n    g = g / 255;\n    b = b / 255;\n    k = 1 - Math.max(r, Math.max(g, b));\n    f = k < 1 ? 1 / (1 - k) : 0;\n    c = (1 - r - k) * f;\n    m = (1 - g - k) * f;\n    y = (1 - b - k) * f;\n    return [c, m, y, k];\n  };\n\n  cmyk2rgb = function() {\n    var alpha, args, b, c, g, k, m, r, y;\n    args = unpack(arguments);\n    c = args[0], m = args[1], y = args[2], k = args[3];\n    alpha = args.length > 4 ? args[4] : 1;\n    if (k === 1) {\n      return [0, 0, 0, alpha];\n    }\n    r = c >= 1 ? 0 : 255 * (1 - c) * (1 - k);\n    g = m >= 1 ? 0 : 255 * (1 - m) * (1 - k);\n    b = y >= 1 ? 0 : 255 * (1 - y) * (1 - k);\n    return [r, g, b, alpha];\n  };\n\n  _input.cmyk = function() {\n    return cmyk2rgb(unpack(arguments));\n  };\n\n  chroma.cmyk = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['cmyk']), function(){});\n  };\n\n  Color.prototype.cmyk = function() {\n    return rgb2cmyk(this._rgb);\n  };\n\n  _input.gl = function() {\n    var i, k, o, rgb, v;\n    rgb = (function() {\n      var ref, results;\n      ref = unpack(arguments);\n      results = [];\n      for (k in ref) {\n        v = ref[k];\n        results.push(v);\n      }\n      return results;\n    }).apply(this, arguments);\n    for (i = o = 0; o <= 2; i = ++o) {\n      rgb[i] *= 255;\n    }\n    return rgb;\n  };\n\n  chroma.gl = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['gl']), function(){});\n  };\n\n  Color.prototype.gl = function() {\n    var rgb;\n    rgb = this._rgb;\n    return [rgb[0] / 255, rgb[1] / 255, rgb[2] / 255, rgb[3]];\n  };\n\n  rgb2luminance = function(r, g, b) {\n    var ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = luminance_x(r);\n    g = luminance_x(g);\n    b = luminance_x(b);\n    return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n  };\n\n  luminance_x = function(x) {\n    x /= 255;\n    if (x <= 0.03928) {\n      return x / 12.92;\n    } else {\n      return pow((x + 0.055) / 1.055, 2.4);\n    }\n  };\n\n  interpolate_rgb = function(col1, col2, f, m) {\n    var xyz0, xyz1;\n    xyz0 = col1._rgb;\n    xyz1 = col2._rgb;\n    return new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);\n  };\n\n  _interpolators.push(['rgb', interpolate_rgb]);\n\n  Color.prototype.luminance = function(lum, mode) {\n    var cur_lum, eps, max_iter, rgba, test;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    if (!arguments.length) {\n      return rgb2luminance(this._rgb);\n    }\n    rgba = this._rgb;\n    if (lum === 0) {\n      rgba = [0, 0, 0, this._rgb[3]];\n    } else if (lum === 1) {\n      rgba = [255, 255, 255, this[3]];\n    } else {\n      cur_lum = rgb2luminance(this._rgb);\n      eps = 1e-7;\n      max_iter = 20;\n      test = function(l, h) {\n        var lm, m;\n        m = l.interpolate(h, 0.5, mode);\n        lm = m.luminance();\n        if (Math.abs(lum - lm) < eps || !max_iter--) {\n          return m;\n        }\n        if (lm > lum) {\n          return test(l, m);\n        }\n        return test(m, h);\n      };\n      if (cur_lum > lum) {\n        rgba = test(chroma('black'), this).rgba();\n      } else {\n        rgba = test(this, chroma('white')).rgba();\n      }\n    }\n    return chroma(rgba).alpha(this.alpha());\n  };\n\n  temperature2rgb = function(kelvin) {\n    var b, g, r, temp;\n    temp = kelvin / 100;\n    if (temp < 66) {\n      r = 255;\n      g = -155.25485562709179 - 0.44596950469579133 * (g = temp - 2) + 104.49216199393888 * log(g);\n      b = temp < 20 ? 0 : -254.76935184120902 + 0.8274096064007395 * (b = temp - 10) + 115.67994401066147 * log(b);\n    } else {\n      r = 351.97690566805693 + 0.114206453784165 * (r = temp - 55) - 40.25366309332127 * log(r);\n      g = 325.4494125711974 + 0.07943456536662342 * (g = temp - 50) - 28.0852963507957 * log(g);\n      b = 255;\n    }\n    return [r, g, b];\n  };\n\n  rgb2temperature = function() {\n    var b, eps, g, maxTemp, minTemp, r, ref, rgb, temp;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    minTemp = 1000;\n    maxTemp = 40000;\n    eps = 0.4;\n    while (maxTemp - minTemp > eps) {\n      temp = (maxTemp + minTemp) * 0.5;\n      rgb = temperature2rgb(temp);\n      if ((rgb[2] / rgb[0]) >= (b / r)) {\n        maxTemp = temp;\n      } else {\n        minTemp = temp;\n      }\n    }\n    return round(temp);\n  };\n\n  chroma.temperature = chroma.kelvin = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['temperature']), function(){});\n  };\n\n  _input.temperature = _input.kelvin = _input.K = temperature2rgb;\n\n  Color.prototype.temperature = function() {\n    return rgb2temperature(this._rgb);\n  };\n\n  Color.prototype.kelvin = Color.prototype.temperature;\n\n  chroma.contrast = function(a, b) {\n    var l1, l2, ref, ref1;\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    l1 = a.luminance();\n    l2 = b.luminance();\n    if (l1 > l2) {\n      return (l1 + 0.05) / (l2 + 0.05);\n    } else {\n      return (l2 + 0.05) / (l1 + 0.05);\n    }\n  };\n\n  chroma.distance = function(a, b, mode) {\n    var d, i, l1, l2, ref, ref1, sum_sq;\n    if (mode == null) {\n      mode = 'lab';\n    }\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    l1 = a.get(mode);\n    l2 = b.get(mode);\n    sum_sq = 0;\n    for (i in l1) {\n      d = (l1[i] || 0) - (l2[i] || 0);\n      sum_sq += d * d;\n    }\n    return Math.sqrt(sum_sq);\n  };\n\n  chroma.deltaE = function(a, b, L, C) {\n    var L1, L2, a1, a2, b1, b2, c1, c2, c4, dH2, delA, delB, delC, delL, f, h1, ref, ref1, ref2, ref3, sc, sh, sl, t, v1, v2, v3;\n    if (L == null) {\n      L = 1;\n    }\n    if (C == null) {\n      C = 1;\n    }\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    ref2 = a.lab(), L1 = ref2[0], a1 = ref2[1], b1 = ref2[2];\n    ref3 = b.lab(), L2 = ref3[0], a2 = ref3[1], b2 = ref3[2];\n    c1 = sqrt(a1 * a1 + b1 * b1);\n    c2 = sqrt(a2 * a2 + b2 * b2);\n    sl = L1 < 16.0 ? 0.511 : (0.040975 * L1) / (1.0 + 0.01765 * L1);\n    sc = (0.0638 * c1) / (1.0 + 0.0131 * c1) + 0.638;\n    h1 = c1 < 0.000001 ? 0.0 : (atan2(b1, a1) * 180.0) / PI;\n    while (h1 < 0) {\n      h1 += 360;\n    }\n    while (h1 >= 360) {\n      h1 -= 360;\n    }\n    t = (h1 >= 164.0) && (h1 <= 345.0) ? 0.56 + abs(0.2 * cos((PI * (h1 + 168.0)) / 180.0)) : 0.36 + abs(0.4 * cos((PI * (h1 + 35.0)) / 180.0));\n    c4 = c1 * c1 * c1 * c1;\n    f = sqrt(c4 / (c4 + 1900.0));\n    sh = sc * (f * t + 1.0 - f);\n    delL = L1 - L2;\n    delC = c1 - c2;\n    delA = a1 - a2;\n    delB = b1 - b2;\n    dH2 = delA * delA + delB * delB - delC * delC;\n    v1 = delL / (L * sl);\n    v2 = delC / (C * sc);\n    v3 = sh;\n    return sqrt(v1 * v1 + v2 * v2 + (dH2 / (v3 * v3)));\n  };\n\n  Color.prototype.get = function(modechan) {\n    var channel, i, me, mode, ref, src;\n    me = this;\n    ref = modechan.split('.'), mode = ref[0], channel = ref[1];\n    src = me[mode]();\n    if (channel) {\n      i = mode.indexOf(channel);\n      if (i > -1) {\n        return src[i];\n      } else {\n        return console.warn('unknown channel ' + channel + ' in mode ' + mode);\n      }\n    } else {\n      return src;\n    }\n  };\n\n  Color.prototype.set = function(modechan, value) {\n    var channel, i, me, mode, ref, src;\n    me = this;\n    ref = modechan.split('.'), mode = ref[0], channel = ref[1];\n    if (channel) {\n      src = me[mode]();\n      i = mode.indexOf(channel);\n      if (i > -1) {\n        if (type(value) === 'string') {\n          switch (value.charAt(0)) {\n            case '+':\n              src[i] += +value;\n              break;\n            case '-':\n              src[i] += +value;\n              break;\n            case '*':\n              src[i] *= +(value.substr(1));\n              break;\n            case '/':\n              src[i] /= +(value.substr(1));\n              break;\n            default:\n              src[i] = +value;\n          }\n        } else {\n          src[i] = value;\n        }\n      } else {\n        console.warn('unknown channel ' + channel + ' in mode ' + mode);\n      }\n    } else {\n      src = value;\n    }\n    return chroma(src, mode).alpha(me.alpha());\n  };\n\n  Color.prototype.clipped = function() {\n    return this._rgb._clipped || false;\n  };\n\n  Color.prototype.alpha = function(a) {\n    if (arguments.length) {\n      return chroma.rgb([this._rgb[0], this._rgb[1], this._rgb[2], a]);\n    }\n    return this._rgb[3];\n  };\n\n  Color.prototype.darken = function(amount) {\n    var lab, me;\n    if (amount == null) {\n      amount = 1;\n    }\n    me = this;\n    lab = me.lab();\n    lab[0] -= LAB_CONSTANTS.Kn * amount;\n    return chroma.lab(lab).alpha(me.alpha());\n  };\n\n  Color.prototype.brighten = function(amount) {\n    if (amount == null) {\n      amount = 1;\n    }\n    return this.darken(-amount);\n  };\n\n  Color.prototype.darker = Color.prototype.darken;\n\n  Color.prototype.brighter = Color.prototype.brighten;\n\n  Color.prototype.saturate = function(amount) {\n    var lch, me;\n    if (amount == null) {\n      amount = 1;\n    }\n    me = this;\n    lch = me.lch();\n    lch[1] += amount * LAB_CONSTANTS.Kn;\n    if (lch[1] < 0) {\n      lch[1] = 0;\n    }\n    return chroma.lch(lch).alpha(me.alpha());\n  };\n\n  Color.prototype.desaturate = function(amount) {\n    if (amount == null) {\n      amount = 1;\n    }\n    return this.saturate(-amount);\n  };\n\n  Color.prototype.premultiply = function() {\n    var a, rgb;\n    rgb = this.rgb();\n    a = this.alpha();\n    return chroma(rgb[0] * a, rgb[1] * a, rgb[2] * a, a);\n  };\n\n  blend = function(bottom, top, mode) {\n    if (!blend[mode]) {\n      throw 'unknown blend mode ' + mode;\n    }\n    return blend[mode](bottom, top);\n  };\n\n  blend_f = function(f) {\n    return function(bottom, top) {\n      var c0, c1;\n      c0 = chroma(top).rgb();\n      c1 = chroma(bottom).rgb();\n      return chroma(f(c0, c1), 'rgb');\n    };\n  };\n\n  each = function(f) {\n    return function(c0, c1) {\n      var i, o, out;\n      out = [];\n      for (i = o = 0; o <= 3; i = ++o) {\n        out[i] = f(c0[i], c1[i]);\n      }\n      return out;\n    };\n  };\n\n  normal = function(a, b) {\n    return a;\n  };\n\n  multiply = function(a, b) {\n    return a * b / 255;\n  };\n\n  darken = function(a, b) {\n    if (a > b) {\n      return b;\n    } else {\n      return a;\n    }\n  };\n\n  lighten = function(a, b) {\n    if (a > b) {\n      return a;\n    } else {\n      return b;\n    }\n  };\n\n  screen = function(a, b) {\n    return 255 * (1 - (1 - a / 255) * (1 - b / 255));\n  };\n\n  overlay = function(a, b) {\n    if (b < 128) {\n      return 2 * a * b / 255;\n    } else {\n      return 255 * (1 - 2 * (1 - a / 255) * (1 - b / 255));\n    }\n  };\n\n  burn = function(a, b) {\n    return 255 * (1 - (1 - b / 255) / (a / 255));\n  };\n\n  dodge = function(a, b) {\n    if (a === 255) {\n      return 255;\n    }\n    a = 255 * (b / 255) / (1 - a / 255);\n    if (a > 255) {\n      return 255;\n    } else {\n      return a;\n    }\n  };\n\n  blend.normal = blend_f(each(normal));\n\n  blend.multiply = blend_f(each(multiply));\n\n  blend.screen = blend_f(each(screen));\n\n  blend.overlay = blend_f(each(overlay));\n\n  blend.darken = blend_f(each(darken));\n\n  blend.lighten = blend_f(each(lighten));\n\n  blend.dodge = blend_f(each(dodge));\n\n  blend.burn = blend_f(each(burn));\n\n  chroma.blend = blend;\n\n  chroma.analyze = function(data) {\n    var len, o, r, val;\n    r = {\n      min: Number.MAX_VALUE,\n      max: Number.MAX_VALUE * -1,\n      sum: 0,\n      values: [],\n      count: 0\n    };\n    for (o = 0, len = data.length; o < len; o++) {\n      val = data[o];\n      if ((val != null) && !isNaN(val)) {\n        r.values.push(val);\n        r.sum += val;\n        if (val < r.min) {\n          r.min = val;\n        }\n        if (val > r.max) {\n          r.max = val;\n        }\n        r.count += 1;\n      }\n    }\n    r.domain = [r.min, r.max];\n    r.limits = function(mode, num) {\n      return chroma.limits(r, mode, num);\n    };\n    return r;\n  };\n\n  chroma.scale = function(colors, positions) {\n    var _classes, _colorCache, _colors, _correctLightness, _domain, _fixed, _gamma, _max, _min, _mode, _nacol, _out, _padding, _pos, _spread, _useCache, classifyValue, f, getClass, getColor, resetCache, setColors, tmap;\n    _mode = 'rgb';\n    _nacol = chroma('#ccc');\n    _spread = 0;\n    _fixed = false;\n    _domain = [0, 1];\n    _pos = [];\n    _padding = [0, 0];\n    _classes = false;\n    _colors = [];\n    _out = false;\n    _min = 0;\n    _max = 1;\n    _correctLightness = false;\n    _colorCache = {};\n    _useCache = true;\n    _gamma = 1;\n    setColors = function(colors) {\n      var c, col, o, ref, ref1, w;\n      if (colors == null) {\n        colors = ['#fff', '#000'];\n      }\n      if ((colors != null) && type(colors) === 'string' && (chroma.brewer != null)) {\n        colors = chroma.brewer[colors] || chroma.brewer[colors.toLowerCase()] || colors;\n      }\n      if (type(colors) === 'array') {\n        if (colors.length === 1) {\n          colors = [colors[0], colors[0]];\n        }\n        colors = colors.slice(0);\n        for (c = o = 0, ref = colors.length - 1; 0 <= ref ? o <= ref : o >= ref; c = 0 <= ref ? ++o : --o) {\n          col = colors[c];\n          if (type(col) === \"string\") {\n            colors[c] = chroma(col);\n          }\n        }\n        _pos.length = 0;\n        for (c = w = 0, ref1 = colors.length - 1; 0 <= ref1 ? w <= ref1 : w >= ref1; c = 0 <= ref1 ? ++w : --w) {\n          _pos.push(c / (colors.length - 1));\n        }\n      }\n      resetCache();\n      return _colors = colors;\n    };\n    getClass = function(value) {\n      var i, n;\n      if (_classes != null) {\n        n = _classes.length - 1;\n        i = 0;\n        while (i < n && value >= _classes[i]) {\n          i++;\n        }\n        return i - 1;\n      }\n      return 0;\n    };\n    tmap = function(t) {\n      return t;\n    };\n    classifyValue = function(value) {\n      var i, maxc, minc, n, val;\n      val = value;\n      if (_classes.length > 2) {\n        n = _classes.length - 1;\n        i = getClass(value);\n        minc = _classes[0] + (_classes[1] - _classes[0]) * (0 + _spread * 0.5);\n        maxc = _classes[n - 1] + (_classes[n] - _classes[n - 1]) * (1 - _spread * 0.5);\n        val = _min + ((_classes[i] + (_classes[i + 1] - _classes[i]) * 0.5 - minc) / (maxc - minc)) * (_max - _min);\n      }\n      return val;\n    };\n    getColor = function(val, bypassMap) {\n      var c, col, i, k, o, p, ref, t;\n      if (bypassMap == null) {\n        bypassMap = false;\n      }\n      if (isNaN(val) || val === null) {\n        return _nacol;\n      }\n      if (!bypassMap) {\n        if (_classes && _classes.length > 2) {\n          c = getClass(val);\n          t = c / (_classes.length - 2);\n        } else if (_max !== _min) {\n          t = (val - _min) / (_max - _min);\n        } else {\n          t = 1;\n        }\n      } else {\n        t = val;\n      }\n      if (!bypassMap) {\n        t = tmap(t);\n      }\n      if (_gamma !== 1) {\n        t = pow(t, _gamma);\n      }\n      t = _padding[0] + (t * (1 - _padding[0] - _padding[1]));\n      t = Math.min(1, Math.max(0, t));\n      k = Math.floor(t * 10000);\n      if (_useCache && _colorCache[k]) {\n        col = _colorCache[k];\n      } else {\n        if (type(_colors) === 'array') {\n          for (i = o = 0, ref = _pos.length - 1; 0 <= ref ? o <= ref : o >= ref; i = 0 <= ref ? ++o : --o) {\n            p = _pos[i];\n            if (t <= p) {\n              col = _colors[i];\n              break;\n            }\n            if (t >= p && i === _pos.length - 1) {\n              col = _colors[i];\n              break;\n            }\n            if (t > p && t < _pos[i + 1]) {\n              t = (t - p) / (_pos[i + 1] - p);\n              col = chroma.interpolate(_colors[i], _colors[i + 1], t, _mode);\n              break;\n            }\n          }\n        } else if (type(_colors) === 'function') {\n          col = _colors(t);\n        }\n        if (_useCache) {\n          _colorCache[k] = col;\n        }\n      }\n      return col;\n    };\n    resetCache = function() {\n      return _colorCache = {};\n    };\n    setColors(colors);\n    f = function(v) {\n      var c;\n      c = chroma(getColor(v));\n      if (_out && c[_out]) {\n        return c[_out]();\n      } else {\n        return c;\n      }\n    };\n    f.classes = function(classes) {\n      var d;\n      if (classes != null) {\n        if (type(classes) === 'array') {\n          _classes = classes;\n          _domain = [classes[0], classes[classes.length - 1]];\n        } else {\n          d = chroma.analyze(_domain);\n          if (classes === 0) {\n            _classes = [d.min, d.max];\n          } else {\n            _classes = chroma.limits(d, 'e', classes);\n          }\n        }\n        return f;\n      }\n      return _classes;\n    };\n    f.domain = function(domain) {\n      var c, d, k, len, o, ref, w;\n      if (!arguments.length) {\n        return _domain;\n      }\n      _min = domain[0];\n      _max = domain[domain.length - 1];\n      _pos = [];\n      k = _colors.length;\n      if (domain.length === k && _min !== _max) {\n        for (o = 0, len = domain.length; o < len; o++) {\n          d = domain[o];\n          _pos.push((d - _min) / (_max - _min));\n        }\n      } else {\n        for (c = w = 0, ref = k - 1; 0 <= ref ? w <= ref : w >= ref; c = 0 <= ref ? ++w : --w) {\n          _pos.push(c / (k - 1));\n        }\n      }\n      _domain = [_min, _max];\n      return f;\n    };\n    f.mode = function(_m) {\n      if (!arguments.length) {\n        return _mode;\n      }\n      _mode = _m;\n      resetCache();\n      return f;\n    };\n    f.range = function(colors, _pos) {\n      setColors(colors, _pos);\n      return f;\n    };\n    f.out = function(_o) {\n      _out = _o;\n      return f;\n    };\n    f.spread = function(val) {\n      if (!arguments.length) {\n        return _spread;\n      }\n      _spread = val;\n      return f;\n    };\n    f.correctLightness = function(v) {\n      if (v == null) {\n        v = true;\n      }\n      _correctLightness = v;\n      resetCache();\n      if (_correctLightness) {\n        tmap = function(t) {\n          var L0, L1, L_actual, L_diff, L_ideal, max_iter, pol, t0, t1;\n          L0 = getColor(0, true).lab()[0];\n          L1 = getColor(1, true).lab()[0];\n          pol = L0 > L1;\n          L_actual = getColor(t, true).lab()[0];\n          L_ideal = L0 + (L1 - L0) * t;\n          L_diff = L_actual - L_ideal;\n          t0 = 0;\n          t1 = 1;\n          max_iter = 20;\n          while (Math.abs(L_diff) > 1e-2 && max_iter-- > 0) {\n            (function() {\n              if (pol) {\n                L_diff *= -1;\n              }\n              if (L_diff < 0) {\n                t0 = t;\n                t += (t1 - t) * 0.5;\n              } else {\n                t1 = t;\n                t += (t0 - t) * 0.5;\n              }\n              L_actual = getColor(t, true).lab()[0];\n              return L_diff = L_actual - L_ideal;\n            })();\n          }\n          return t;\n        };\n      } else {\n        tmap = function(t) {\n          return t;\n        };\n      }\n      return f;\n    };\n    f.padding = function(p) {\n      if (p != null) {\n        if (type(p) === 'number') {\n          p = [p, p];\n        }\n        _padding = p;\n        return f;\n      } else {\n        return _padding;\n      }\n    };\n    f.colors = function(numColors, out) {\n      var dd, dm, i, o, ref, result, results, samples, w;\n      if (arguments.length < 2) {\n        out = 'hex';\n      }\n      result = [];\n      if (arguments.length === 0) {\n        result = _colors.slice(0);\n      } else if (numColors === 1) {\n        result = [f(0.5)];\n      } else if (numColors > 1) {\n        dm = _domain[0];\n        dd = _domain[1] - dm;\n        result = (function() {\n          results = [];\n          for (var o = 0; 0 <= numColors ? o < numColors : o > numColors; 0 <= numColors ? o++ : o--){ results.push(o); }\n          return results;\n        }).apply(this).map(function(i) {\n          return f(dm + i / (numColors - 1) * dd);\n        });\n      } else {\n        colors = [];\n        samples = [];\n        if (_classes && _classes.length > 2) {\n          for (i = w = 1, ref = _classes.length; 1 <= ref ? w < ref : w > ref; i = 1 <= ref ? ++w : --w) {\n            samples.push((_classes[i - 1] + _classes[i]) * 0.5);\n          }\n        } else {\n          samples = _domain;\n        }\n        result = samples.map(function(v) {\n          return f(v);\n        });\n      }\n      if (chroma[out]) {\n        result = result.map(function(c) {\n          return c[out]();\n        });\n      }\n      return result;\n    };\n    f.cache = function(c) {\n      if (c != null) {\n        _useCache = c;\n        return f;\n      } else {\n        return _useCache;\n      }\n    };\n    f.gamma = function(g) {\n      if (g != null) {\n        _gamma = g;\n        return f;\n      } else {\n        return _gamma;\n      }\n    };\n    f.nodata = function(d) {\n      if (d != null) {\n        _nacol = chroma(d);\n        return f;\n      } else {\n        return _nacol;\n      }\n    };\n    return f;\n  };\n\n  if (chroma.scales == null) {\n    chroma.scales = {};\n  }\n\n  chroma.scales.cool = function() {\n    return chroma.scale([chroma.hsl(180, 1, .9), chroma.hsl(250, .7, .4)]);\n  };\n\n  chroma.scales.hot = function() {\n    return chroma.scale(['#000', '#f00', '#ff0', '#fff'], [0, .25, .75, 1]).mode('rgb');\n  };\n\n  chroma.analyze = function(data, key, filter) {\n    var add, k, len, o, r, val, visit;\n    r = {\n      min: Number.MAX_VALUE,\n      max: Number.MAX_VALUE * -1,\n      sum: 0,\n      values: [],\n      count: 0\n    };\n    if (filter == null) {\n      filter = function() {\n        return true;\n      };\n    }\n    add = function(val) {\n      if ((val != null) && !isNaN(val)) {\n        r.values.push(val);\n        r.sum += val;\n        if (val < r.min) {\n          r.min = val;\n        }\n        if (val > r.max) {\n          r.max = val;\n        }\n        r.count += 1;\n      }\n    };\n    visit = function(val, k) {\n      if (filter(val, k)) {\n        if ((key != null) && type(key) === 'function') {\n          return add(key(val));\n        } else if ((key != null) && type(key) === 'string' || type(key) === 'number') {\n          return add(val[key]);\n        } else {\n          return add(val);\n        }\n      }\n    };\n    if (type(data) === 'array') {\n      for (o = 0, len = data.length; o < len; o++) {\n        val = data[o];\n        visit(val);\n      }\n    } else {\n      for (k in data) {\n        val = data[k];\n        visit(val, k);\n      }\n    }\n    r.domain = [r.min, r.max];\n    r.limits = function(mode, num) {\n      return chroma.limits(r, mode, num);\n    };\n    return r;\n  };\n\n  chroma.limits = function(data, mode, num) {\n    var aa, ab, ac, ad, ae, af, ag, ah, ai, aj, ak, al, am, assignments, best, centroids, cluster, clusterSizes, dist, i, j, kClusters, limits, max_log, min, min_log, mindist, n, nb_iters, newCentroids, o, p, pb, pr, ref, ref1, ref10, ref11, ref12, ref13, ref14, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9, repeat, sum, tmpKMeansBreaks, v, value, values, w;\n    if (mode == null) {\n      mode = 'equal';\n    }\n    if (num == null) {\n      num = 7;\n    }\n    if (type(data) === 'array') {\n      data = chroma.analyze(data);\n    }\n    min = data.min;\n    max = data.max;\n    sum = data.sum;\n    values = data.values.sort(function(a, b) {\n      return a - b;\n    });\n    if (num === 1) {\n      return [min, max];\n    }\n    limits = [];\n    if (mode.substr(0, 1) === 'c') {\n      limits.push(min);\n      limits.push(max);\n    }\n    if (mode.substr(0, 1) === 'e') {\n      limits.push(min);\n      for (i = o = 1, ref = num - 1; 1 <= ref ? o <= ref : o >= ref; i = 1 <= ref ? ++o : --o) {\n        limits.push(min + (i / num) * (max - min));\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'l') {\n      if (min <= 0) {\n        throw 'Logarithmic scales are only possible for values > 0';\n      }\n      min_log = Math.LOG10E * log(min);\n      max_log = Math.LOG10E * log(max);\n      limits.push(min);\n      for (i = w = 1, ref1 = num - 1; 1 <= ref1 ? w <= ref1 : w >= ref1; i = 1 <= ref1 ? ++w : --w) {\n        limits.push(pow(10, min_log + (i / num) * (max_log - min_log)));\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'q') {\n      limits.push(min);\n      for (i = aa = 1, ref2 = num - 1; 1 <= ref2 ? aa <= ref2 : aa >= ref2; i = 1 <= ref2 ? ++aa : --aa) {\n        p = (values.length - 1) * i / num;\n        pb = floor(p);\n        if (pb === p) {\n          limits.push(values[pb]);\n        } else {\n          pr = p - pb;\n          limits.push(values[pb] * (1 - pr) + values[pb + 1] * pr);\n        }\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'k') {\n\n      /*\n      implementation based on\n      http://code.google.com/p/figue/source/browse/trunk/figue.js#336\n      simplified for 1-d input values\n       */\n      n = values.length;\n      assignments = new Array(n);\n      clusterSizes = new Array(num);\n      repeat = true;\n      nb_iters = 0;\n      centroids = null;\n      centroids = [];\n      centroids.push(min);\n      for (i = ab = 1, ref3 = num - 1; 1 <= ref3 ? ab <= ref3 : ab >= ref3; i = 1 <= ref3 ? ++ab : --ab) {\n        centroids.push(min + (i / num) * (max - min));\n      }\n      centroids.push(max);\n      while (repeat) {\n        for (j = ac = 0, ref4 = num - 1; 0 <= ref4 ? ac <= ref4 : ac >= ref4; j = 0 <= ref4 ? ++ac : --ac) {\n          clusterSizes[j] = 0;\n        }\n        for (i = ad = 0, ref5 = n - 1; 0 <= ref5 ? ad <= ref5 : ad >= ref5; i = 0 <= ref5 ? ++ad : --ad) {\n          value = values[i];\n          mindist = Number.MAX_VALUE;\n          for (j = ae = 0, ref6 = num - 1; 0 <= ref6 ? ae <= ref6 : ae >= ref6; j = 0 <= ref6 ? ++ae : --ae) {\n            dist = abs(centroids[j] - value);\n            if (dist < mindist) {\n              mindist = dist;\n              best = j;\n            }\n          }\n          clusterSizes[best]++;\n          assignments[i] = best;\n        }\n        newCentroids = new Array(num);\n        for (j = af = 0, ref7 = num - 1; 0 <= ref7 ? af <= ref7 : af >= ref7; j = 0 <= ref7 ? ++af : --af) {\n          newCentroids[j] = null;\n        }\n        for (i = ag = 0, ref8 = n - 1; 0 <= ref8 ? ag <= ref8 : ag >= ref8; i = 0 <= ref8 ? ++ag : --ag) {\n          cluster = assignments[i];\n          if (newCentroids[cluster] === null) {\n            newCentroids[cluster] = values[i];\n          } else {\n            newCentroids[cluster] += values[i];\n          }\n        }\n        for (j = ah = 0, ref9 = num - 1; 0 <= ref9 ? ah <= ref9 : ah >= ref9; j = 0 <= ref9 ? ++ah : --ah) {\n          newCentroids[j] *= 1 / clusterSizes[j];\n        }\n        repeat = false;\n        for (j = ai = 0, ref10 = num - 1; 0 <= ref10 ? ai <= ref10 : ai >= ref10; j = 0 <= ref10 ? ++ai : --ai) {\n          if (newCentroids[j] !== centroids[i]) {\n            repeat = true;\n            break;\n          }\n        }\n        centroids = newCentroids;\n        nb_iters++;\n        if (nb_iters > 200) {\n          repeat = false;\n        }\n      }\n      kClusters = {};\n      for (j = aj = 0, ref11 = num - 1; 0 <= ref11 ? aj <= ref11 : aj >= ref11; j = 0 <= ref11 ? ++aj : --aj) {\n        kClusters[j] = [];\n      }\n      for (i = ak = 0, ref12 = n - 1; 0 <= ref12 ? ak <= ref12 : ak >= ref12; i = 0 <= ref12 ? ++ak : --ak) {\n        cluster = assignments[i];\n        kClusters[cluster].push(values[i]);\n      }\n      tmpKMeansBreaks = [];\n      for (j = al = 0, ref13 = num - 1; 0 <= ref13 ? al <= ref13 : al >= ref13; j = 0 <= ref13 ? ++al : --al) {\n        tmpKMeansBreaks.push(kClusters[j][0]);\n        tmpKMeansBreaks.push(kClusters[j][kClusters[j].length - 1]);\n      }\n      tmpKMeansBreaks = tmpKMeansBreaks.sort(function(a, b) {\n        return a - b;\n      });\n      limits.push(tmpKMeansBreaks[0]);\n      for (i = am = 1, ref14 = tmpKMeansBreaks.length - 1; am <= ref14; i = am += 2) {\n        v = tmpKMeansBreaks[i];\n        if (!isNaN(v) && limits.indexOf(v) === -1) {\n          limits.push(v);\n        }\n      }\n    }\n    return limits;\n  };\n\n  hsi2rgb = function(h, s, i) {\n\n    /*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/hsi2rgb.cpp\n     */\n    var args, b, g, r;\n    args = unpack(arguments);\n    h = args[0], s = args[1], i = args[2];\n    if (isNaN(h)) {\n      h = 0;\n    }\n    h /= 360;\n    if (h < 1 / 3) {\n      b = (1 - s) / 3;\n      r = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      g = 1 - (b + r);\n    } else if (h < 2 / 3) {\n      h -= 1 / 3;\n      r = (1 - s) / 3;\n      g = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      b = 1 - (r + g);\n    } else {\n      h -= 2 / 3;\n      g = (1 - s) / 3;\n      b = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      r = 1 - (g + b);\n    }\n    r = limit(i * r * 3);\n    g = limit(i * g * 3);\n    b = limit(i * b * 3);\n    return [r * 255, g * 255, b * 255, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hsi = function() {\n\n    /*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/rgb2hsi.cpp\n     */\n    var b, g, h, i, min, r, ref, s;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    TWOPI = Math.PI * 2;\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    min = Math.min(r, g, b);\n    i = (r + g + b) / 3;\n    s = 1 - min / i;\n    if (s === 0) {\n      h = 0;\n    } else {\n      h = ((r - g) + (r - b)) / 2;\n      h /= Math.sqrt((r - g) * (r - g) + (r - b) * (g - b));\n      h = Math.acos(h);\n      if (b > g) {\n        h = TWOPI - h;\n      }\n      h /= TWOPI;\n    }\n    return [h * 360, s, i];\n  };\n\n  chroma.hsi = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsi']), function(){});\n  };\n\n  _input.hsi = hsi2rgb;\n\n  Color.prototype.hsi = function() {\n    return rgb2hsi(this._rgb);\n  };\n\n  interpolate_hsx = function(col1, col2, f, m) {\n    var dh, hue, hue0, hue1, lbv, lbv0, lbv1, res, sat, sat0, sat1, xyz0, xyz1;\n    if (m === 'hsl') {\n      xyz0 = col1.hsl();\n      xyz1 = col2.hsl();\n    } else if (m === 'hsv') {\n      xyz0 = col1.hsv();\n      xyz1 = col2.hsv();\n    } else if (m === 'hcg') {\n      xyz0 = col1.hcg();\n      xyz1 = col2.hcg();\n    } else if (m === 'hsi') {\n      xyz0 = col1.hsi();\n      xyz1 = col2.hsi();\n    } else if (m === 'lch' || m === 'hcl') {\n      m = 'hcl';\n      xyz0 = col1.hcl();\n      xyz1 = col2.hcl();\n    }\n    if (m.substr(0, 1) === 'h') {\n      hue0 = xyz0[0], sat0 = xyz0[1], lbv0 = xyz0[2];\n      hue1 = xyz1[0], sat1 = xyz1[1], lbv1 = xyz1[2];\n    }\n    if (!isNaN(hue0) && !isNaN(hue1)) {\n      if (hue1 > hue0 && hue1 - hue0 > 180) {\n        dh = hue1 - (hue0 + 360);\n      } else if (hue1 < hue0 && hue0 - hue1 > 180) {\n        dh = hue1 + 360 - hue0;\n      } else {\n        dh = hue1 - hue0;\n      }\n      hue = hue0 + f * dh;\n    } else if (!isNaN(hue0)) {\n      hue = hue0;\n      if ((lbv1 === 1 || lbv1 === 0) && m !== 'hsv') {\n        sat = sat0;\n      }\n    } else if (!isNaN(hue1)) {\n      hue = hue1;\n      if ((lbv0 === 1 || lbv0 === 0) && m !== 'hsv') {\n        sat = sat1;\n      }\n    } else {\n      hue = Number.NaN;\n    }\n    if (sat == null) {\n      sat = sat0 + f * (sat1 - sat0);\n    }\n    lbv = lbv0 + f * (lbv1 - lbv0);\n    return res = chroma[m](hue, sat, lbv);\n  };\n\n  _interpolators = _interpolators.concat((function() {\n    var len, o, ref, results;\n    ref = ['hsv', 'hsl', 'hsi', 'hcl', 'lch', 'hcg'];\n    results = [];\n    for (o = 0, len = ref.length; o < len; o++) {\n      m = ref[o];\n      results.push([m, interpolate_hsx]);\n    }\n    return results;\n  })());\n\n  interpolate_num = function(col1, col2, f, m) {\n    var n1, n2;\n    n1 = col1.num();\n    n2 = col2.num();\n    return chroma.num(n1 + (n2 - n1) * f, 'num');\n  };\n\n  _interpolators.push(['num', interpolate_num]);\n\n  interpolate_lab = function(col1, col2, f, m) {\n    var res, xyz0, xyz1;\n    xyz0 = col1.lab();\n    xyz1 = col2.lab();\n    return res = new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);\n  };\n\n  _interpolators.push(['lab', interpolate_lab]);\n\n}).call(this);\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\n// Singleton `WeakMap`s to store metadata for td/th elements, as well as the\n// datagrids themselves for each `<perspective-viewer>`\nexport const METADATA_MAP = new WeakMap();\n\n// Output runtime debug info like FPS.\nexport const DEBUG = true;\n\n// The largest size virtual <div> in (px) that Chrome can support without\n// glitching.\nconst isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\nexport const BROWSER_MAX_HEIGHT = isFirefox ? 5000000 : 10000000;\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\n/******************************************************************************\n *\n * Profling\n *\n */\n\nlet AVG = 0,\n    TOTAL = 0,\n    START = performance.now();\n\nexport function get_draw_fps() {\n    const now = performance.now();\n    const elapsed = now - START;\n    const avg = AVG;\n    const real_fps = (TOTAL * 1000) / elapsed;\n    const virtual_fps = 1000 / avg;\n    const num_frames = TOTAL;\n    AVG = 0;\n    TOTAL = 0;\n    START = now;\n    return {avg, real_fps, virtual_fps, num_frames, elapsed};\n}\n\nexport function log_perf(x) {\n    AVG = (AVG * TOTAL + x) / (TOTAL + 1);\n    TOTAL += 1;\n}\n\n/******************************************************************************\n *\n * Utils\n *\n */\n\n/**\n * A class method decorate for memoizing method results.  Only works on one\n * arg.\n */\nexport function memoize(_target, _property, descriptor) {\n    const cache = new Map();\n    const func = descriptor.value;\n    descriptor.value = new_func;\n    return descriptor;\n    function new_func(arg) {\n        if (cache.has(arg)) {\n            return cache.get(arg);\n        } else {\n            const res = func.call(this, arg);\n            cache.set(arg, res);\n            return res;\n        }\n    }\n}\n\n/**\n * Identical to a non-tagger template literal, this is only used to indicate to\n * babel that this string should be HTML-minified on production builds.\n */\nexport const html = (strings, ...args) =>\n    strings\n        .map((str, i) => [str, args[i]])\n        .flat()\n        .filter((a) => !!a)\n        .join(\"\");\n\nconst invertPromise = () => {\n    let _resolve;\n    const promise = new Promise((resolve) => {\n        _resolve = resolve;\n    });\n    promise.resolve = _resolve;\n    return promise;\n};\n\nexport function throttlePromise(target, property, descriptor) {\n    const f = descriptor.value;\n    const lock_symbol = Symbol(\"regular-table throttle lock\");\n    descriptor.value = async function (...args) {\n        if (this[lock_symbol] !== undefined) {\n            await this[lock_symbol];\n            if (this[lock_symbol] !== undefined) {\n                await this[lock_symbol];\n                return;\n            }\n        }\n        this[lock_symbol] = invertPromise();\n        let result;\n        try {\n            result = await f.call(this, ...args);\n        } finally {\n            const l = this[lock_symbol];\n            this[lock_symbol] = undefined;\n            l.resolve();\n        }\n        return result;\n    };\n    descriptor.value.flush = async function () {\n        await new Promise(requestAnimationFrame);\n        return await this[lock_symbol];\n    };\n    return descriptor;\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {log_perf, html, throttlePromise} from \"./utils\";\nimport {DEBUG, BROWSER_MAX_HEIGHT} from \"./constants\";\n\nimport container_css from \"../less/container.less\";\nimport sub_cell_offsets from \"../less/sub-cell-offsets.less\";\n\n/**\n * Handles the virtual scroll pane, as well as the double buffering\n * of the underlying <table>. This DOM structure looks a little like\n * this:\n *\n *     +------------------------+      <- regular-table\n *     | +----------------------|------<- div.rt-virtual-panel\n *     | | +------------------+ |      <- div.rt-scroll-table-clip\n *     | | | +----------------|-|--+   <- table             |\n *     | | | | 1  A  Alabama  | |  |                        |\n *     | | | | 2  B  Arizona  | |  |                        |\n *     | | | | 3  C  Arkansas | |  |                        |\n *     | | | | 4  D  Californi| |  |                        |\n *     | | | | 5  E  Colorado | |  |                        |\n *     | | +------------------+ |  |                        |\n *     +------------------------+  |                        |\n *       |   | 8  H  District of C |                        |\n *       |   +---------------------+                        |\n *       |                                                  |\n *       |                                                  |\n *       |                                                  |\n *       |                                                  |\n *       |                                                  |\n *       +--------------------------------------------------+\n *\n * `overflow: auto` is applied to `.rt-scroll-container`, and `.rt-virtual-pane`\n * is sized to match the estimated \"virtual\" size of the `table`;  estimated,\n * because it's true size can't be known until all columns dimensions are known,\n * which may be deferred in the case of auto-sized tables.\n *\n * Double buffering can be enabled on \"column scroll\", \"row scroll\" and/or\n * \"column schema change\".  When enabled and a redraw is requested for the case,\n * the existing table is cloned with `cloneNode()` and swapped with the real\n * `table`, which is then updated offscreen and swapped back in.  While this is\n * much slower to render, it prevents draw-in.\n *\n * @class RegularVirtualTableViewModel\n */\nexport class RegularVirtualTableViewModel extends HTMLElement {\n    /**\n     * Create the DOM for this `shadowRoot`.\n     *\n     * TODO deprecated\n     * `MATERIAL_STYLE` is needed both here, and in the document `<head>`, due\n     * to double buffering, which may read incorrect position/size values as the\n     * double buffered `<table>` is rendered in the shadow DOM before being\n     * swapped in.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     */\n    create_shadow_dom() {\n        this.attachShadow({mode: \"open\"});\n        const slot = `<slot></slot>`;\n        this.shadowRoot.innerHTML = html`\n            <style>\n                ${container_css}\n            </style>\n            <style>\n                ${sub_cell_offsets}\n            </style>\n            <div class=\"rt-virtual-panel\"></div>\n            <div class=\"rt-scroll-table-clip\">\n                ${slot}\n            </div>\n        `;\n\n        const [, style, virtual_panel, table_clip] = this.shadowRoot.children;\n        this._sub_cell_style = style;\n        this._table_clip = table_clip;\n        this._virtual_panel = virtual_panel;\n        this._setup_virtual_scroll();\n    }\n\n    _setup_virtual_scroll() {\n        if (this._table_clip) {\n            if (this._virtual_mode === \"both\" || this._virtual_mode === \"vertical\") {\n                this._table_clip.style.top = \"0px\";\n            } else {\n                this._table_clip.style.removeProperty(\"top\");\n            }\n\n            if (this._virtual_mode === \"both\" || this._virtual_mode === \"horizontal\") {\n                this._table_clip.style.left = \"0px\";\n            } else {\n                this._table_clip.style.removeProperty(\"left\");\n            }\n\n            if (this._virtual_mode !== \"both\") {\n                this._table_clip.style.contain = \"none\";\n            } else {\n                this._table_clip.style.removeProperty(\"contain\");\n            }\n        }\n    }\n\n    /**\n     * Calculates the `viewport` argument for perspective's `to_columns` method.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} nrows\n     * @returns\n     */\n    _calculate_viewport(nrows, num_columns) {\n        const {start_row, end_row} = this._calculate_row_range(nrows);\n        const {start_col, end_col} = this._calculate_column_range(num_columns);\n        this._nrows = nrows;\n        return {start_col, end_col, start_row, end_row};\n    }\n\n    /**\n     * Calculate `start_row` and `end_row` for the viewport.  We do this by\n     * first calculating `total_scroll_height`, the px height of the\n     * scrollable page, from the `_virtual_panel.offsetHeight`.\n     *\n     *    0px +------------+-------------+  - virtual_panel.offsetHeight\n     *        |            |  .          |  . 600px\n     *        |  viewport  |  .          |  .\n     *        |            |  .          |  .\n     *  200px +------------+  - height   |  .  - total_scroll_height\n     *        |                 200px    |  .  . 400px\n     *        |                          |  .  .\n     *        |                          |  .  .\n     *        |                          |  .  .\n     *        |                          |  .  .\n     *  600px +--------------------------+  -  -\n     *\n     *  `percent_scroll` can be calculated from this value and `scrollTop`,\n     *  which we can then apply to the new calculated height to preserve scroll\n     *  position when the height has changed since previous render.\n     *\n     *    0px +--------------------------+  -\n     *        |                          |  .\n     *        |                          |  .\n     *        |                          |  . scrollable area\n     *  300px +------------+             |  .\n     *        |            |             |  .\n     *  - - - |  viewport  | - - - - - - |  - total_scroll_height\n     *        |            |             |    400px\n     *  500px +------------+             |\n     *        |                          |\n     *  600px +--------------------------+\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} nrows\n     * @returns\n     */\n    _calculate_row_range(nrows) {\n        const {height} = this._container_size;\n        const row_height = this._column_sizes.row_height || 19;\n        const header_levels = this._view_cache.config.column_pivots.length;\n        const total_scroll_height = Math.max(1, this._virtual_panel.offsetHeight - this.clientHeight);\n        const percent_scroll = Math.max(Math.ceil(this.scrollTop), 0) / total_scroll_height;\n        const virtual_panel_row_height = height / row_height - header_levels;\n        const relative_nrows = nrows || 0;\n        const scroll_rows = Math.max(0, Math.ceil(relative_nrows - virtual_panel_row_height));\n        const start_row = scroll_rows * percent_scroll;\n        const end_row = Math.max(0, Math.min(start_row + virtual_panel_row_height, nrows));\n        return {start_row, end_row};\n    }\n\n    _calc_start_column() {\n        const scroll_index_offset = this._view_cache.config.row_pivots.length;\n        let start_col = 0;\n        let offset_width = 0;\n        let diff = 0;\n        while (offset_width < this.scrollLeft) {\n            const new_val = this._column_sizes.indices[start_col + scroll_index_offset];\n            diff = this.scrollLeft - offset_width;\n            start_col += 1;\n            offset_width += new_val !== undefined ? new_val : 60;\n        }\n\n        start_col += diff / (this._column_sizes.indices[start_col + scroll_index_offset - 1] || 60);\n        return Math.max(0, start_col - 1);\n    }\n\n    /**\n     * Calculates `start_col` and `end_col` for the viewport - most of the\n     * details of which are actually calculated in `_max_column`, the equivalent\n     * of `total_scroll_height` from `_calculate_row_range`.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @returns\n     */\n    _calculate_column_range(num_columns) {\n        if (this._virtual_mode === \"none\" || this._virtual_mode === \"vertical\") {\n            return {start_col: 0, end_col: Infinity};\n        } else {\n            const start_col = this._calc_start_column();\n            const vis_cols = this.table_model.num_columns() || Math.min(num_columns, Math.ceil(this._container_size.width / 60));\n            let end_col = start_col + vis_cols + 1;\n            return {start_col, end_col};\n        }\n    }\n\n    /**\n     * Calculates the minimum possible starting column index for which the last\n     * column is completely visible (e.g. not occluded by the container clip).\n     * This is assumed to be the # of columns until the column widths are\n     * calculated as they are scrolled into view by the user, which requires\n     * special synchronization with _update_virtual_panel_width`\n     * as the scrollable width will change as the user scrolls left to right.\n     *\n     * Once `_column_sizes.indices` has enough column widths populated from\n     * user scrolling, it calulates the cumulative sum of column widths from\n     * last visible column backwards, until the sum is larger than the viewport\n     * px width, which is 1 below the max scroll column\n     *\n     *               width = 290   = 210     = 100    = 0\n     *   0px               V       V         V        500px\n     *   +-----------------+-------+---------+--------+\n     *   | ..ol B) (Col C) | Col D | Col E   | Col F  |\n     *   |                 | 80px  | 110px   | 100px  |\n     *   |                 |       |         |        |\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @returns\n     */\n    _max_scroll_column(num_columns) {\n        let width = 0;\n        if (this._view_cache.config.row_pivots.length > 0) {\n            for (const w of this._column_sizes.indices.slice(0, this._view_cache.config.row_pivots.length)) {\n                width += w;\n            }\n        }\n        let scroll_index_offset = this._view_cache.config.row_pivots.length;\n        let max_scroll_column = num_columns;\n        while (width < this._container_size.width && max_scroll_column >= 0) {\n            max_scroll_column--;\n            width += this._column_sizes.indices[max_scroll_column + scroll_index_offset] || 60;\n        }\n\n        return Math.min(num_columns - 1, max_scroll_column + 1);\n    }\n\n    /**\n     * Determines whether the viewport is identical in row and column axes to\n     * the previous viewport rendered, for throttling identical render requests,\n     * e.g. when the logical (row-wise) viewport does not change, but the pixel\n     * viewport has moved a few px.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} {start_col, end_col, start_row, end_row}\n     * @returns\n     */\n    _validate_viewport({start_col, end_col, start_row, end_row}) {\n        start_row = Math.floor(start_row);\n        end_row = Math.ceil(end_row);\n        start_col = Math.floor(start_col);\n        end_col = Math.ceil(end_col);\n        const invalid_column = this._start_col !== start_col;\n        const invalid_row = this._start_row !== start_row || this._end_row !== end_row || this._end_col !== end_col;\n        this._start_col = start_col;\n        this._end_col = end_col;\n        this._start_row = start_row;\n        this._end_row = end_row;\n        return {invalid_column, invalid_row};\n    }\n\n    _calc_scrollable_column_width(num_columns) {\n        let scroll_index_offset = this._view_cache.config.row_pivots.length;\n        const max_scroll_column = this._max_scroll_column(num_columns);\n        let cidx = scroll_index_offset,\n            virtual_width = 0;\n\n        while (cidx < max_scroll_column + scroll_index_offset) {\n            virtual_width += this._column_sizes.indices[cidx] || 60;\n            cidx++;\n        }\n\n        return virtual_width;\n    }\n\n    /**\n     * Updates the `virtual_panel` width based on view state.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} invalid\n     */\n    _update_virtual_panel_width(invalid, num_columns) {\n        if (invalid) {\n            if (this._virtual_mode === \"vertical\" || this._virtual_mode === \"none\") {\n                this._virtual_panel.style.width = this._column_sizes.indices.reduce((x, y) => x + y, 0) + \"px\";\n            } else {\n                const virtual_width = this._calc_scrollable_column_width(num_columns);\n                if (virtual_width !== 0) {\n                    const panel_width = this._container_size.width + virtual_width + 2;\n                    this._virtual_panel.style.width = panel_width + \"px\";\n                } else {\n                    this._virtual_panel.style.width = \"1px\";\n                }\n            }\n        }\n    }\n\n    /**\n     * Updates the `virtual_panel` height based on the view state.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} nrows\n     */\n    _update_virtual_panel_height(nrows) {\n        const {row_height = 19} = this._column_sizes;\n        const header_height = this._view_cache.config.column_pivots.length * row_height;\n        let virtual_panel_px_size;\n        if (this._virtual_mode === \"horizontal\" || this._virtual_mode === \"none\") {\n            virtual_panel_px_size = nrows * row_height + header_height;\n        } else {\n            //const {height} = this._container_size;\n            // TODO use cached height?\n            const zoom_factor = this.clientHeight / (this._table_clip.offsetHeight - header_height);\n            virtual_panel_px_size = Math.min(BROWSER_MAX_HEIGHT, nrows * row_height * zoom_factor);\n        }\n        this._virtual_panel.style.height = `${virtual_panel_px_size}px`;\n    }\n\n    /**\n     * Draws this virtual panel, given an object of render options that allow\n     * the implementor to fine tune the individual render frames based on the\n     * interaction and previous render state.\n     *\n     * @public\n     * @memberof RegularVirtualTableViewModel\n     * @param {DrawOptions} [options]\n     * @param {boolean} [options.invalid_viewport=true]\n     * @param {boolean} [options.preserve_width=false]\n     */\n    @throttlePromise\n    async draw(options = {}) {\n        const __debug_start_time__ = DEBUG && performance.now();\n        const {invalid_viewport = true, preserve_width = false} = options;\n        const {num_columns, num_rows} = await this._view_cache.view(0, 0, 0, 0);\n        this._container_size = {\n            width: this._virtual_mode === \"none\" || this._virtual_mode === \"vertical\" ? Infinity : this._table_clip.clientWidth,\n            height: this._virtual_mode === \"none\" || this._virtual_mode === \"horizontal\" ? Infinity : this._table_clip.clientHeight,\n        };\n\n        this._update_virtual_panel_height(num_rows);\n        if (!preserve_width) {\n            this._update_virtual_panel_width(invalid_viewport, num_columns);\n        }\n\n        const viewport = this._calculate_viewport(num_rows, num_columns);\n        const {invalid_row, invalid_column} = this._validate_viewport(viewport);\n        if (this._invalid_schema || invalid_row || invalid_column || invalid_viewport) {\n            let autosize_cells = [],\n                needs_sub_cell_update = true;\n            for await (let last_cells of this.table_model.draw(this._container_size, this._view_cache, this._selected_id, preserve_width, viewport, num_columns)) {\n                if (last_cells !== undefined) {\n                    autosize_cells = autosize_cells.concat(last_cells);\n                }\n\n                // We want to perform this before the next event loop so there\n                // is no scroll jitter, but only on the first iteration as\n                // subsequent viewports are incorrect.\n                if (needs_sub_cell_update) {\n                    this.update_sub_cell_offset(viewport);\n                    needs_sub_cell_update = false;\n                }\n\n                this._is_styling = true;\n                const callbacks = this._style_callbacks;\n                for (const callback of callbacks) {\n                    await callback({detail: this});\n                }\n\n                this._is_styling = false;\n                if (!this._invalidated && last_cells !== undefined) {\n                    break;\n                }\n\n                this._invalidated = false;\n            }\n\n            this.table_model.autosize_cells(autosize_cells);\n            this.table_model.header.reset_header_cache();\n            if (!preserve_width) {\n                this._update_virtual_panel_width(this._invalid_schema || invalid_column, num_columns);\n            }\n            this._invalid_schema = false;\n        } else {\n            this.update_sub_cell_offset(viewport);\n        }\n\n        if (DEBUG) {\n            log_perf(performance.now() - __debug_start_time__);\n        }\n    }\n\n    update_sub_cell_offset(viewport) {\n        const y_offset = this._column_sizes.row_height * (viewport.start_row % 1) || 0;\n        const x_offset = this._column_sizes.indices[(this.table_model._row_headers_length || 0) + Math.floor(viewport.start_col)] * (viewport.start_col % 1) || 0;\n        let style = this._sub_cell_style.sheet?.cssRules[0].style;\n        if (style) {\n            style.setProperty(`--regular-table--clip-x`, `${x_offset}px`);\n            style.setProperty(`--regular-table--clip-y`, `${y_offset}px`);\n            style.setProperty(`--regular-table--transform-x`, `-${x_offset}px`);\n            style.setProperty(`--regular-table--transform-y`, `-${y_offset}px`);\n        }\n    }\n}\n\n/**\n * Options for the draw method.\n *\n * @public\n * @typedef DrawOptions\n * @type {object}\n * @property {boolean} [invalid_viewport]\n * @property {boolean} [preserve_width]\n */\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {METADATA_MAP} from \"./constants\";\nimport {RegularVirtualTableViewModel} from \"./scroll_panel\";\nimport {throttlePromise} from \"./utils\";\n\n/**\n * WHen enabled, override iOS overscroll behavior by emulating scroll position\n * in JavaScript.  This prevents \"bounce\" on edges, but it also removes scroll\n * inertia.  This waspreviously enabled by default in `regular-table<=0.4.3`,\n * but this version also had bugged (exaggerated) position calculation.\n * As `0.5.0` introduces sub-cell scrolling by defualt, this is now disabled by\n * default as well.\n */\nconst IOS_DISABLE_OVERSCROLL = false;\n\n/**\n *\n *\n * @class RegularViewEventModel\n * @extends {RegularVirtualTableViewModel}\n */\nexport class RegularViewEventModel extends RegularVirtualTableViewModel {\n    register_listeners() {\n        // // TODO see `_on_click_or_dblclick` method jsdoc\n        // this.addEventListener(\"dblclick\", this._on_dblclick.bind(this));\n\n        this.addEventListener(\"mousedown\", this._on_click_or_dblclick.bind(this));\n        this.addEventListener(\"scroll\", this._on_scroll.bind(this), {\n            passive: true,\n        });\n\n        this._register_glitch_scroll_listeners();\n    }\n\n    /**\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     * @returns\n     */\n    _on_scroll(event) {\n        event.stopPropagation();\n        this.draw({invalid_viewport: false});\n    }\n\n    /**\n     * Modern and mobile browsers implement complex scroll behavior to\n     * implement fancy touch and intertia effects;  these must be intercepted\n     * and disabled to achieve clean virtual scrolling in the presence of a\n     * `fixed` element.\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     */\n    _register_glitch_scroll_listeners() {\n        this.addEventListener(\"mousewheel\", this._on_mousewheel.bind(this));\n        if (IOS_DISABLE_OVERSCROLL) {\n            this.addEventListener(\"touchmove\", this._on_touchmove.bind(this));\n            this.addEventListener(\"touchstart\", this._on_touchstart.bind(this), {\n                passive: true,\n            });\n        }\n    }\n    /**\n     * Mousewheel must precalculate in addition to `_on_scroll` to prevent\n     * visual artifacts due to scrolling \"inertia\" on modern browsers.\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     * @param {*} event\n     */\n    _on_mousewheel(event) {\n        if (!window.safari) {\n            // **** Apple\n            return;\n        }\n\n        const {clientWidth, clientHeight, scrollTop, scrollLeft} = this;\n        event.preventDefault();\n        event.returnValue = false;\n        const total_scroll_height = Math.max(1, this._virtual_panel.offsetHeight - clientHeight);\n        const total_scroll_width = Math.max(1, this._virtual_panel.offsetWidth - clientWidth);\n        this.scrollTop = Math.max(0, Math.min(total_scroll_height, scrollTop + event.deltaY));\n        this.scrollLeft = Math.max(0, Math.min(total_scroll_width, scrollLeft + event.deltaX));\n        this._on_scroll(event);\n    }\n\n    /**\n     * Touchmove/touchstart must precalculate in addition to `_on_scroll` to\n     * prevent visual artifacts due to scrolling \"inertia\" on mobile browsers.\n     * This has the unfortunate side-effect of disabling scroll intertia.\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     * @param {*} event\n     * @returns\n     */\n    _on_touchmove(event) {\n        event.stopPropagation();\n        event.preventDefault();\n        event.returnValue = false;\n        const {clientWidth, clientHeight} = this;\n        const total_scroll_height = Math.max(1, this._virtual_panel.offsetHeight - clientHeight);\n        const total_scroll_width = Math.max(1, this._virtual_panel.offsetWidth - clientWidth);\n        this.scrollTop = Math.min(total_scroll_height, this._memo_scroll_top + (this._memo_touch_startY - event.touches[0].pageY));\n        this.scrollLeft = Math.min(total_scroll_width, this._memo_scroll_left + (this._memo_touch_startX - event.touches[0].pageX));\n        this._on_scroll(event);\n    }\n\n    _on_touchstart(event) {\n        this._memo_touch_startY = event.touches[0].pageY;\n        this._memo_touch_startX = event.touches[0].pageX;\n        this._memo_scroll_top = this.scrollTop;\n        this._memo_scroll_left = this.scrollLeft;\n    }\n\n    /**\n     * Handles double-click header width override reset.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @returns\n     */\n    async _on_dblclick(event) {\n        let element = event.target;\n        while (element.tagName !== \"TD\" && element.tagName !== \"TH\") {\n            element = element.parentElement;\n            if (!this.contains(element)) {\n                return;\n            }\n        }\n\n        const is_resize = event.target.classList.contains(\"rt-column-resize\");\n        const metadata = METADATA_MAP.get(element);\n        if (is_resize) {\n            event.stopImmediatePropagation();\n            // await new Promise(queueMicrotask);\n            element.style.minWidth = \"\";\n            element.style.maxWidth = \"\";\n            if (event.shiftKey) {\n                this._column_sizes.override = [];\n                this._column_sizes.auto = [];\n                this._column_sizes.indices = [];\n            } else {\n                this._column_sizes.override[metadata.size_key] = undefined;\n                this._column_sizes.auto[metadata.size_key] = undefined;\n                this._column_sizes.indices[metadata.size_key] = undefined;\n            }\n\n            for (const row of event.shiftKey ? [this.table_model.header.cells[this.table_model.header.cells.length - 1], ...this.table_model.body.cells] : this.table_model.body.cells) {\n                for (const td of event.shiftKey ? row : [row[metadata._virtual_x]]) {\n                    if (!td) {\n                        continue;\n                    }\n\n                    td.style.minWidth = \"\";\n                    td.style.maxWidth = \"\";\n                    td.classList.remove(\"rt-cell-clip\");\n                }\n            }\n\n            await this.draw();\n        }\n    }\n\n    /**\n     * Dispatches all click events to other handlers, depending on\n     * `event.target`.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @returns\n     */\n    async _on_click(event) {\n        if (event.button !== 0) {\n            return;\n        }\n\n        let element = event.target;\n        while (element.tagName !== \"TD\" && element.tagName !== \"TH\") {\n            element = element.parentElement;\n            if (!this.contains(element)) {\n                return;\n            }\n        }\n\n        const is_resize = event.target.classList.contains(\"rt-column-resize\");\n        const metadata = METADATA_MAP.get(element);\n        if (is_resize) {\n            this._on_resize_column(event, element, metadata);\n            event.stopImmediatePropagation();\n        }\n    }\n\n    /**\n     * `dblclick` event does not work reliably for some reason so dispatch this\n     * event in JavaScript instead.\n     * @param {`*`} event\n     */\n    async _on_click_or_dblclick(event) {\n        const now = performance.now();\n        if (this._last_clicked_time && now - this._last_clicked_time < 500) {\n            this._last_clicked_time = now;\n            await this._on_dblclick(event);\n        } else {\n            this._last_clicked_time = now;\n            await this._on_click(event);\n        }\n    }\n\n    /**\n     * Regular event for column resize.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @param {*} element\n     * @param {*} metadata\n     */\n    _on_resize_column(event, element, metadata) {\n        const {_virtual_x, size_key} = metadata;\n        const start = event.pageX;\n        const header_x = _virtual_x + element.colSpan - 1;\n        const header_element = this.table_model.header.get_column_header(header_x);\n        const width = this._column_sizes.indices[size_key];\n        const move = (event) => this._on_resize_column_move(event, header_element, start, width, size_key, header_x);\n        const up = () => {\n            document.removeEventListener(\"mousemove\", move);\n            document.removeEventListener(\"mouseup\", up);\n            const override_width = this._column_sizes.override[size_key];\n            const should_redraw = this._column_sizes.indices[size_key] !== override_width;\n            this._column_sizes.indices[size_key] = override_width;\n            if (should_redraw) {\n                this.draw();\n            }\n        };\n\n        document.addEventListener(\"mousemove\", move);\n        document.addEventListener(\"mouseup\", up);\n    }\n\n    /**\n     * Regular event for mouse movement when resizing a column.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @param {*} th\n     * @param {*} start\n     * @param {*} width\n     * @param {*} metadata\n     */\n    @throttlePromise\n    async _on_resize_column_move(event, th, start, width, size_key, virtual_x) {\n        await new Promise(setTimeout);\n        const diff = event.pageX - start;\n        const override_width = Math.max(1, width + diff);\n        this._column_sizes.override[size_key] = override_width;\n\n        // If the column is smaller, new columns may need to be fetched, so\n        // redraw, else just update the DOM widths as if redrawn.\n        if (diff < 0) {\n            await this.draw({preserve_width: true});\n        } else {\n            th.style.minWidth = override_width + \"px\";\n            th.style.maxWidth = override_width + \"px\";\n            const auto_width = this._column_sizes.auto[size_key];\n            for (const row of this.table_model.body.cells) {\n                const td = row[virtual_x];\n                if (td) {\n                    td.style.maxWidth = td.style.minWidth = override_width + \"px\";\n                    td.classList.toggle(\"rt-cell-clip\", auto_width > override_width);\n                }\n            }\n        }\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {METADATA_MAP} from \"./constants\";\n\n/******************************************************************************\n *\n * View Model\n *\n */\n\nclass ElemFactory {\n    constructor(name) {\n        this._name = name;\n        this._elements = [];\n        this._index = 0;\n    }\n\n    reset() {\n        this._index = 0;\n    }\n\n    get() {\n        if (!this._elements[this._index]) {\n            this._elements[this._index] = document.createElement(this._name);\n        }\n\n        const elem = this._elements[this._index];\n        this._index += 1;\n        return elem;\n    }\n}\n\nexport class ViewModel {\n    constructor(column_sizes, container, table) {\n        this._column_sizes = column_sizes;\n        this._container = container;\n        this._span_factory = new ElemFactory(\"span\");\n        this.table = table;\n        this.cells = [];\n        this.rows = [];\n    }\n\n    num_columns() {\n        return this._get_row(Math.max(0, this.rows.length - 1)).row_container.length;\n    }\n\n    num_rows() {\n        return this.cells.length;\n    }\n\n    _set_metadata(td, metadata) {\n        METADATA_MAP.set(td, metadata);\n    }\n\n    _get_or_create_metadata(td) {\n        if (td === undefined) {\n            return {};\n        } else if (METADATA_MAP.has(td)) {\n            return METADATA_MAP.get(td);\n        } else {\n            const metadata = {};\n            METADATA_MAP.set(td, metadata);\n            return metadata;\n        }\n    }\n\n    _replace_cell(ridx, cidx) {\n        const {tr, row_container} = this._get_row(ridx);\n        let td = row_container[cidx];\n        if (td) {\n            tr.removeChild(td);\n            row_container.splice(cidx, 1, undefined);\n        }\n        return td;\n    }\n\n    _fetch_cell(ridx, cidx) {\n        if (ridx < 0 || cidx < 0) {\n            return;\n        }\n        const {row_container} = this._get_row(ridx);\n        return row_container[cidx];\n    }\n\n    _get_cell(tag = \"TD\", ridx, cidx) {\n        const {tr, row_container} = this._get_row(ridx);\n        let td = row_container[cidx];\n        if (!td) {\n            if (cidx < row_container.length) {\n                td = row_container[cidx] = document.createElement(tag);\n                tr.insertBefore(\n                    td,\n                    row_container.slice(cidx + 1).find((x) => x)\n                );\n            } else {\n                td = row_container[cidx] = document.createElement(tag);\n                tr.appendChild(td);\n            }\n        }\n        if (td.tagName !== tag) {\n            const new_td = document.createElement(tag);\n            tr.replaceChild(new_td, td);\n            this.cells[ridx].splice(cidx, 1, new_td);\n            td = new_td;\n        }\n        return td;\n    }\n\n    _get_row(ridx) {\n        let tr = this.rows[ridx];\n        if (!tr) {\n            tr = this.rows[ridx] = document.createElement(\"tr\");\n            this.table.appendChild(tr);\n        }\n\n        let row_container = this.cells[ridx];\n        if (!row_container) {\n            row_container = this.cells[ridx] = [];\n        }\n\n        return {tr, row_container};\n    }\n\n    _clean_columns(cidx) {\n        for (let i = 0; i < this.rows.length; i++) {\n            const tr = this.rows[i];\n            const row_container = this.cells[i];\n            this.cells[i] = row_container.slice(0, cidx[i] || cidx);\n            const idx = this.cells[i].filter((x) => x !== undefined).length;\n            while (tr.children[idx]) {\n                tr.removeChild(tr.children[idx]);\n            }\n        }\n    }\n\n    _clean_rows(ridx) {\n        while (this.table.children[ridx]) {\n            this.table.removeChild(this.table.children[ridx]);\n        }\n        this.rows = this.rows.slice(0, ridx);\n        this.cells = this.cells.slice(0, ridx);\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {ViewModel} from \"./view_model\";\n\n/**\n * <thead> view model.  This model accumulates state in the form of\n * column_sizes, which leverages <tables> autosize behavior across\n * virtual pages.\n *\n * @class RegularHeaderViewModel\n */\nexport class RegularHeaderViewModel extends ViewModel {\n    constructor(...args) {\n        super(...args);\n        this._group_header_cache = [];\n        this._offset_cache = [];\n    }\n\n    _draw_group_th(offset_cache, d, column) {\n        const th = this._get_cell(\"TH\", d, offset_cache[d] || 0);\n        offset_cache[d] += 1;\n        th.removeAttribute(\"colspan\");\n        th.style.minWidth = \"0\";\n\n        th.textContent = \"\";\n        if (column instanceof HTMLElement) {\n            th.appendChild(column);\n        } else {\n            const span = this._span_factory.get(\"span\");\n            span.textContent = column;\n            th.appendChild(span);\n        }\n\n        const resizeSpan = this._span_factory.get(\"span\");\n        resizeSpan.className = \"rt-column-resize\";\n        th.appendChild(resizeSpan);\n\n        return th;\n    }\n\n    _draw_group(column, column_name, th) {\n        const metadata = this._get_or_create_metadata(th);\n        metadata.column_header = column;\n        metadata.value = column_name;\n        metadata.value = column_name;\n        return metadata;\n    }\n\n    _draw_th(column, column_name, th, cidx, size_key) {\n        const metadata = this._get_or_create_metadata(th);\n        metadata.column_header = column;\n        metadata.value = column_name;\n        metadata.size_key = size_key.length ? size_key[0] : size_key; // FIXME\n\n        if (!(size_key.length > 1)) {\n            const override_width = this._column_sizes.override[metadata.size_key];\n            const auto_width = this._column_sizes.auto[metadata.size_key];\n            if (override_width) {\n                th.classList.toggle(\"rt-cell-clip\", auto_width > override_width);\n                th.style.minWidth = override_width + \"px\";\n                th.style.maxWidth = override_width + \"px\";\n            } else if (auto_width) {\n                th.classList.remove(\"rt-cell-clip\");\n                th.style.maxWidth = \"\";\n                th.style.minWidth = auto_width + \"px\";\n            } else {\n                th.style.maxWidth = \"\";\n                th.style.maxWidth = \"\";\n            }\n        }\n\n        return metadata;\n    }\n\n    get_column_header(cidx) {\n        return this._get_cell(\"TH\", this.num_rows() - 1, cidx);\n    }\n\n    draw(alias, parts, colspan, x, size_key, x0, _virtual_x) {\n        const header_levels = parts?.length; //config.column_pivots.length + 1;\n        if (header_levels === 0) return;\n        let th, metadata, column_name;\n        for (let d = 0; d < header_levels; d++) {\n            column_name = parts[d] ? parts[d] : \"\";\n            this._offset_cache[d] = this._offset_cache[d] || 0;\n            if (d < header_levels - 1) {\n                if (this._group_header_cache?.[d]?.[0]?.value === column_name) {\n                    th = this._group_header_cache[d][1];\n                    this._group_header_cache[d][2] += 1;\n                    if (colspan === 1) {\n                        this._group_header_cache[d][0].row_header_x = size_key;\n                    }\n                    th.setAttribute(\"colspan\", this._group_header_cache[d][2]);\n                } else {\n                    th = this._draw_group_th(this._offset_cache, d, column_name);\n                    metadata = this._draw_group(parts, column_name, th);\n                    this._group_header_cache[d] = [metadata, th, 1];\n                }\n            } else {\n                th = this._draw_group_th(this._offset_cache, d, column_name);\n\n                // Update the group header's metadata such that each group\n                // header has the same metadata coordinates of its rightmost\n                // column.\n                metadata = this._draw_th(alias || parts, column_name, th, x, size_key);\n                for (const [group_meta] of this._group_header_cache) {\n                    group_meta.size_key = metadata.size_key;\n                }\n                th.removeAttribute(\"colspan\");\n            }\n\n            th.classList.toggle(\"rt-group-corner\", x === undefined);\n            if (metadata) {\n                metadata.x = typeof x === \"undefined\" ? x : Math.floor(x);\n                metadata.column_header_y = d;\n                metadata.x0 = Math.floor(x0);\n                metadata._virtual_x = _virtual_x;\n                if (colspan === 1) {\n                    metadata.row_header_x = size_key;\n                }\n            }\n        }\n\n        this._clean_rows(this._offset_cache.length);\n        return {th, metadata};\n    }\n\n    clean() {\n        this._clean_columns(this._offset_cache);\n    }\n\n    reset_header_cache() {\n        this._offset_cache = [];\n        this._group_header_cache = [];\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {ViewModel} from \"./view_model\";\n\n/**\n * <tbody> view model.\n *\n * @class RegularBodyViewModel\n */\nexport class RegularBodyViewModel extends ViewModel {\n    _draw_td(tagName, ridx, val, cidx, {column_name}, {ridx_offset}, size_key) {\n        const td = this._get_cell(tagName, ridx, cidx);\n        const metadata = this._get_or_create_metadata(td);\n        metadata.y = ridx + Math.floor(ridx_offset);\n        metadata.size_key = size_key;\n        if (tagName === \"TD\") {\n            metadata.column_header = column_name;\n        }\n        const override_width = this._column_sizes.override[metadata.size_key];\n        if (override_width) {\n            const auto_width = this._column_sizes.auto[metadata.size_key];\n            td.classList.toggle(\"rt-cell-clip\", auto_width > override_width);\n            td.style.minWidth = override_width + \"px\";\n            td.style.maxWidth = override_width + \"px\";\n        } else {\n            td.classList.remove(\"rt-cell-clip\");\n            td.style.minWidth = \"\";\n            td.style.maxWidth = \"\";\n        }\n\n        if (metadata.value !== val) {\n            if (val instanceof HTMLElement) {\n                td.textContent = \"\";\n                td.appendChild(val);\n            } else {\n                td.textContent = val;\n            }\n        }\n\n        metadata.value = val;\n        return {td, metadata};\n    }\n\n    draw(container_height, column_state, view_state, th = false, x, x0, size_key) {\n        const {cidx, column_data, row_headers, column_data_listener_metadata} = column_state;\n        let {row_height} = view_state;\n        let metadata;\n        const ridx_offset = [],\n            tds = [];\n        let ridx = 0;\n        const cidx_offset = [];\n        for (let i = 0; i < (th ? view_state.row_headers_length : 1); i++) {\n            ridx = 0;\n\n            for (const val of column_data) {\n                const id = row_headers?.[ridx];\n                let obj;\n                if (th) {\n                    const row_header = val[i];\n                    const prev_row = this._fetch_cell(ridx - (ridx_offset[i] || 1), cidx + i);\n                    const prev_row_metadata = this._get_or_create_metadata(prev_row);\n\n                    const prev_col = this._fetch_cell(ridx, cidx + i - (cidx_offset[ridx] || 1));\n                    const prev_col_metadata = this._get_or_create_metadata(prev_col);\n\n                    if (prev_col && (prev_col_metadata.value === row_header || row_header === undefined) && !prev_col.hasAttribute(\"rowspan\")) {\n                        cidx_offset[ridx] = cidx_offset[ridx] ? cidx_offset[ridx] + 1 : 2;\n                        prev_col.setAttribute(\"colspan\", cidx_offset[ridx]);\n                        this._replace_cell(ridx, cidx + i);\n                    } else if (prev_row && prev_row_metadata.value === row_header && !prev_row.hasAttribute(\"colspan\")) {\n                        ridx_offset[i] = ridx_offset[i] ? ridx_offset[i] + 1 : 2;\n                        prev_row.setAttribute(\"rowspan\", ridx_offset[i]);\n                        this._replace_cell(ridx, cidx + i);\n                    } else {\n                        obj = this._draw_td(\"TH\", ridx, row_header, cidx + i, column_state, view_state, i);\n                        obj.td.style.display = \"\";\n                        obj.td.removeAttribute(\"rowspan\");\n                        obj.td.removeAttribute(\"colspan\");\n                        obj.metadata.row_header = val;\n                        obj.metadata.row_header_x = i;\n                        obj.metadata.y0 = Math.floor(view_state.ridx_offset);\n                        obj.metadata.y1 = Math.ceil(view_state.y1);\n                        obj.metadata._virtual_x = i;\n                        if (typeof x0 !== \"undefined\") {\n                            obj.metadata.x0 = Math.floor(x0);\n                        }\n                        ridx_offset[i] = 1;\n                        cidx_offset[ridx] = 1;\n                        tds[i] = obj;\n                    }\n                } else {\n                    obj = this._draw_td(\"TD\", ridx, val, cidx, column_state, view_state, size_key);\n                    if (column_data_listener_metadata) {\n                        obj.metadata.user = column_data_listener_metadata[ridx];\n                    }\n\n                    obj.metadata.x = typeof x === \"undefined\" ? x : Math.floor(x);\n                    obj.metadata.x1 = Math.ceil(view_state.x1);\n                    obj.metadata.row_header = id || [];\n                    obj.metadata.y0 = Math.floor(view_state.ridx_offset);\n                    obj.metadata.y1 = Math.ceil(view_state.y1);\n                    obj.metadata.dx = Math.floor(x - x0);\n                    obj.metadata.dy = obj.metadata.y - Math.floor(obj.metadata.y0);\n                    obj.metadata._virtual_x = cidx;\n                    if (typeof x0 !== \"undefined\") {\n                        obj.metadata.x0 = Math.floor(x0);\n                    }\n\n                    tds[0] = obj;\n                }\n\n                ridx++;\n                metadata = obj ? obj.metadata : metadata;\n                row_height = row_height || obj?.td.offsetHeight;\n                if (ridx * row_height > container_height) {\n                    break;\n                }\n            }\n        }\n        this._clean_rows(ridx);\n        return {tds, ridx, metadata, row_height};\n    }\n\n    clean({ridx, cidx}) {\n        this._clean_rows(ridx);\n        this._clean_columns(cidx);\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {RegularHeaderViewModel} from \"./thead\";\nimport {RegularBodyViewModel} from \"./tbody\";\nimport {html} from \"./utils\";\n\n/**\n * <table> view model.  In order to handle unknown column width when `draw()`\n * is called, this model will iteratively fetch more data to fill in columns\n * until the page is complete, and makes some column viewport estimations\n * when this information is not availble.\n *\n * @class RegularTableViewModel\n */\nexport class RegularTableViewModel {\n    constructor(table_clip, column_sizes, element) {\n        this.clear(element);\n        const [table] = element.children;\n        const [thead, tbody] = table.children;\n        this.table = table;\n        this._column_sizes = column_sizes;\n        this.header = new RegularHeaderViewModel(column_sizes, table_clip, thead);\n        this.body = new RegularBodyViewModel(column_sizes, table_clip, tbody);\n        this.fragment = document.createDocumentFragment();\n    }\n\n    num_columns() {\n        return this.header.num_columns();\n    }\n\n    clear(element) {\n        element.innerHTML = html`\n            <table cellspacing=\"0\">\n                <thead></thead>\n                <tbody></tbody>\n            </table>\n        `;\n    }\n\n    /**\n     * Calculate amendments to auto size from this render pass.\n     *\n     * @param {*} last_cells\n     * @param {*} {columns, column_pivots}\n     * @memberof RegularTableViewModel\n     */\n    autosize_cells(last_cells) {\n        while (last_cells.length > 0) {\n            const [cell, metadata, row_height_cell] = last_cells.pop();\n            let offsetWidth;\n            const style = getComputedStyle(cell);\n            if (style.boxSizing !== \"border-box\") {\n                offsetWidth = cell.clientWidth;\n                offsetWidth -= style.paddingLeft ? parseFloat(style.paddingLeft) : 0;\n                offsetWidth -= style.paddingRight ? parseFloat(style.paddingRight) : 0;\n            } else {\n                offsetWidth = parseFloat(style.width);\n            }\n            this._column_sizes.row_height = this._column_sizes.row_height || row_height_cell.offsetHeight;\n            this._column_sizes.indices[metadata.size_key] = offsetWidth;\n            const is_override = this._column_sizes.override[metadata.size_key] !== undefined;\n            if (offsetWidth && !is_override) {\n                this._column_sizes.auto[metadata.size_key] = offsetWidth;\n            }\n\n            if (cell.style.minWidth === \"0px\") {\n                cell.style.minWidth = `${offsetWidth}px`;\n            }\n        }\n    }\n\n    async *draw(container_size, view_cache, selected_id, preserve_width, viewport, num_columns) {\n        const {width: container_width, height: container_height} = container_size;\n        const {view, config} = view_cache;\n        let {data, row_headers, column_headers, metadata: data_listener_metadata} = await view(\n            Math.floor(viewport.start_col),\n            Math.floor(viewport.start_row),\n            Math.ceil(viewport.end_col),\n            Math.ceil(viewport.end_row)\n        );\n\n        const {start_row: ridx_offset = 0, start_col: x0 = 0, end_col: x1 = 0, end_row: y1 = 0} = viewport;\n\n        // pad row_headers for embedded renderer\n        // TODO maybe dont need this - perspective compat\n        if (row_headers) {\n            this._row_headers_length = row_headers.reduce((max, x) => Math.max(max, x.length), 0);\n            row_headers = row_headers.map((x) => {\n                x.length = this._row_headers_length;\n                return x;\n            });\n        }\n\n        view_cache.config.column_pivots = Array.from(Array(column_headers?.[0]?.length || 0).keys());\n        view_cache.config.row_pivots = Array.from(Array(row_headers?.[0]?.length || 0).keys());\n        const sub_cell_offset = this._column_sizes.indices[(this._row_headers_length || 0) + Math.floor(viewport.start_col)] || 0;\n\n        const view_state = {\n            viewport_width: 0,\n            selected_id,\n            ridx_offset,\n            sub_cell_offset,\n            x0: x0,\n            x1: x1,\n            y1: y1,\n            row_height: this._column_sizes.row_height,\n            row_headers_length: this._row_headers_length,\n        };\n\n        let cont_body,\n            _virtual_x = 0,\n            last_cells = [],\n            first_col = true;\n        if (row_headers?.length > 0) {\n            const column_name = config.row_pivots.join(\",\");\n\n            const column_state = {\n                column_name,\n                cidx: 0,\n                column_data: row_headers,\n                row_headers,\n                first_col,\n            };\n            const size_key = _virtual_x + Math.floor(x0);\n            cont_body = this.body.draw(container_height, column_state, {...view_state, x0: 0}, true, undefined, undefined, size_key);\n            const cont_heads = [];\n            for (let i = 0; i < view_cache.config.row_pivots.length; i++) {\n                const header = this.header.draw(column_name, Array(view_cache.config.column_pivots.length).fill(\"\"), 1, undefined, i, x0, i);\n                if (!!header) {\n                    cont_heads.push(header);\n                }\n            }\n            first_col = false;\n            view_state.viewport_width += cont_heads.reduce((total, {th}, i) => total + (this._column_sizes.indices[i] || th.offsetWidth), 0);\n            view_state.row_height = view_state.row_height || cont_body.row_height;\n            _virtual_x = row_headers[0].length;\n            if (!preserve_width) {\n                for (let i = 0; i < view_cache.config.row_pivots.length; i++) {\n                    const {td, metadata} = cont_body.tds[i] || {};\n                    const {th, metadata: hmetadata} = cont_heads[i] || {};\n                    if (!!td || !!th) {\n                        last_cells.push([th || td, hmetadata || metadata, td || th]);\n                    }\n                }\n            }\n        }\n\n        try {\n            let dcidx = 0;\n            const num_visible_columns = num_columns - viewport.start_col;\n            while (dcidx < num_visible_columns) {\n                // If there is no column for this data, our pre-fetch viewport\n                // estimate was wrong and we'll need to do a mid-render fetch\n                // to get more data.\n                if (!data[dcidx]) {\n                    let missing_cidx = Math.max(viewport.end_col, 0);\n                    viewport.start_col = missing_cidx;\n\n                    // Calculate a new data window width based on how large the\n                    // columns drawn so far take up.  This can either be\n                    // summed if we've drawn/measured these columns before,\n                    // or estimated by avg if the missing columns have never\n                    // been seen by the renderer.\n                    let end_col_offset = 0,\n                        size_extension = 0;\n                    while (this._column_sizes.indices.length > _virtual_x + x0 + end_col_offset + 1 && size_extension + view_state.viewport_width < container_width) {\n                        end_col_offset++;\n                        size_extension += this._column_sizes.indices[_virtual_x + x0 + end_col_offset];\n                    }\n\n                    if (size_extension + view_state.viewport_width < container_width) {\n                        const estimate = Math.min(num_columns, missing_cidx + 5); //Math.ceil(((dcidx + end_col_offset) * container_width) / (view_state.viewport_width + size_extension) + 1);\n                        viewport.end_col = Math.max(1, Math.min(num_columns, estimate));\n                    } else {\n                        viewport.end_col = Math.max(1, Math.min(num_columns, missing_cidx + end_col_offset));\n                    }\n\n                    // Fetch the new data window extension and append it to the\n                    // cached data page and continue.\n                    const new_col_req = view(Math.floor(viewport.start_col), Math.floor(viewport.start_row), Math.ceil(viewport.end_col), Math.ceil(viewport.end_row));\n                    yield undefined;\n                    const new_col = await new_col_req;\n\n                    if (new_col.data.length === 0) {\n                        // The viewport is size 0, first the estimate, then the\n                        // first-pass render, so really actually abort now.\n                        yield last_cells;\n                        return;\n                    }\n\n                    viewport.end_col = viewport.start_col + new_col.data.length;\n                    for (let i = 0; i < new_col.data.length; i++) {\n                        data[dcidx + i] = new_col.data[i];\n                        if (new_col.metadata) {\n                            data_listener_metadata[dcidx + i] = new_col.metadata[i];\n                        }\n\n                        if (column_headers) {\n                            column_headers[dcidx + i] = new_col.column_headers?.[i];\n                        }\n                    }\n                }\n\n                const column_name = column_headers?.[dcidx] || \"\";\n                const column_data = data[dcidx];\n                const column_data_listener_metadata = data_listener_metadata?.[dcidx];\n                const column_state = {\n                    column_name,\n                    cidx: _virtual_x,\n                    column_data,\n                    column_data_listener_metadata,\n                    row_headers,\n                    first_col,\n                };\n\n                const x = dcidx + x0;\n                const size_key = _virtual_x + Math.floor(x0);\n                const cont_head = this.header.draw(undefined, column_name, undefined, x, size_key, x0, _virtual_x);\n                cont_body = this.body.draw(container_height, column_state, view_state, false, x, x0, size_key);\n                first_col = false;\n                if (!preserve_width) {\n                    for (const {td, metadata} of cont_body.tds) {\n                        last_cells.push([cont_head?.th || td, cont_head?.metadata || metadata, td || cont_head?.th]);\n                    }\n                }\n\n                const last_measured_col_width = this._column_sizes.indices[_virtual_x + Math.floor(x0)];\n                if (last_measured_col_width) {\n                    view_state.viewport_width += last_measured_col_width;\n                } else {\n                    // This is probably wrong since the column has yet to be\n                    // styled, but we'll use it as an estimate and recalc after.\n                    view_state.viewport_width += cont_head?.th?.offsetWidth || cont_body.tds.reduce((x, y) => x + y.td?.offsetWidth, 0);\n                }\n\n                view_state.row_height = view_state.row_height || cont_body.row_height;\n                _virtual_x++;\n                dcidx++;\n\n                if (view_state.viewport_width - view_state.sub_cell_offset > container_width) {\n                    this.body.clean({\n                        ridx: cont_body?.ridx || 0,\n                        cidx: _virtual_x,\n                    });\n                    this.header.clean();\n                    yield last_cells;\n\n                    // If we make it here, this draw() call was invalidated by\n                    // a call to `invalidate()` within a `StyleListener`, so\n                    // recalculate the cumulative width and keep drawing if\n                    // necessary.  Note `last_cells` is a list of 2-tuples but\n                    // we only bind the first var because _eslint_.\n                    view_state.viewport_width = 0;\n                    for (let [td] of last_cells) {\n                        view_state.viewport_width += td.offsetWidth;\n                    }\n\n                    // If there are still enough columns to fill the screen,\n                    // completely end the iteration here, otherwise\n                    // continue iterating to draw another column.\n                    if (view_state.viewport_width - view_state.sub_cell_offset > container_width) {\n                        return;\n                    }\n                }\n            }\n            this.body.clean({ridx: cont_body?.ridx || 0, cidx: _virtual_x});\n            this.header.clean();\n            yield last_cells;\n        } finally {\n            this.body.clean({ridx: cont_body?.ridx || 0, cidx: _virtual_x});\n            this.header.clean();\n            this.body._span_factory.reset();\n            this.header._span_factory.reset();\n        }\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport {METADATA_MAP} from \"./constants\";\nimport {RegularViewEventModel} from \"./events\";\nimport {RegularTableViewModel} from \"./table\";\nimport {get_draw_fps} from \"./utils\";\n\nconst VIRTUAL_MODES = [\"both\", \"horizontal\", \"vertical\", \"none\"];\n\n/**\n * The `<regular-table>` custom element.\n *\n * This module has no exports, but importing it has a side effect: the\n * `RegularTableElement` class is registered as a custom element, after which\n * it can be used as a standard DOM element.\n *\n * The documentation in this module defines the instance structure of a\n * `<regular-table>` DOM object instantiated typically, through HTML or any\n * relevent DOM method e.g. `document.createElement(\"perspective-viewer\")` or\n * `document.getElementsByTagName(\"perspective-viewer\")`.\n *\n * @public\n * @extends HTMLElement\n */\nclass RegularTableElement extends RegularViewEventModel {\n    constructor() {\n        super();\n        /** @private */\n        this._column_sizes = {auto: [], override: [], indices: []};\n        /** @private */\n        this._style_callbacks = [];\n        /** @private */\n        this._initialized = false;\n    }\n\n    /* eslint-disable */\n    /**\n     * For internal use by the Custom Elements API: \"Invoked each time the\n     * custom element is appended into a document-connected element\".\n     * Ref: https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements#Using_the_lifecycle_callbacks\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    /* eslint-enable */\n    connectedCallback() {\n        if (!this._initialized) {\n            this.create_shadow_dom();\n            this.register_listeners();\n            this.setAttribute(\"tabindex\", \"0\");\n\n            this._initialized = true;\n            this.table_model = new RegularTableViewModel(this._table_clip, this._column_sizes, this);\n        }\n    }\n\n    /**\n     * Reset the viewport of this regular table.\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    _reset_viewport() {\n        /** @private @type {number} */\n        this._start_row = undefined;\n        /** @private @type {number} */\n        this._end_row = undefined;\n        /** @private @type {number} */\n        this._start_col = undefined;\n        /** @private @type {number} */\n        this._end_col = undefined;\n    }\n\n    /**\n     * Reset the scroll position of this regular table back to the origin.\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    _reset_scroll() {\n        this._column_sizes.indices = [];\n        this.scrollTop = 0;\n        this.scrollLeft = 0;\n        this._reset_viewport();\n    }\n\n    /**\n     * Reset column autosizing, such that column sizes will be recalculated\n     * on the next draw() call.\n     *\n     * @internal\n     * @protected\n     * @memberof RegularTableElement\n     */\n    _resetAutoSize() {\n        this._column_sizes.auto = [];\n        this._column_sizes.override = [];\n        this._column_sizes.indices = [];\n\n        for (let i = 0; i < this.table_model.header.num_columns(); i++) {\n            const th = this.table_model.header.get_column_header(i);\n            th.style.minWidth = \"\";\n            th.style.maxWidth = \"\";\n        }\n    }\n\n    /**\n     * Clears the current renderer `<table>`.\n     *\n     * @public\n     * @memberof RegularTableElement\n     */\n    clear() {\n        this.table_model = new RegularTableViewModel(this._table_clip, this._column_sizes, this);\n    }\n\n    /**\n     * Adds a style listener callback. The style listeners are called\n     * whenever the <table> is re-rendered, such as through API invocations\n     * of draw() and user-initiated events such as scrolling. Within this\n     * optionally async callback, you can select <td>, <th>, etc. elements\n     * via regular DOM API methods like querySelectorAll().\n     *\n     * Example:\n     * const unsubscribe = table.addStyleListener(() => {\n     *     for (const td of table.querySelectorAll(\"td\")) {\n     *         td.setAttribute(\"contenteditable\", true);\n     *     }\n     * });\n     *\n     * setTimeout(() => {\n     *     unsubscribe();\n     * }, 1000);\n     * @public\n     * @memberof RegularTableElement\n     * @param {function({detail: RegularTableElement}): void} styleListener - A\n     * (possibly async) function that styles the inner <table>.\n     * @returns {function(): void} A function to remove this style listener.\n     */\n    addStyleListener(styleListener) {\n        this._style_callbacks = this._style_callbacks.concat(styleListener);\n\n        let isSubscribed = true;\n\n        const unsubscribe = () => {\n            if (!isSubscribed) {\n                return;\n            }\n            isSubscribed = false;\n\n            const callbacks = (this._style_callbacks = this._style_callbacks.slice());\n            const index = callbacks.indexOf(styleListener);\n            callbacks.splice(index, 1);\n        };\n        return unsubscribe;\n    }\n\n    /**\n     * When called within the execution scope of a function registered to this\n     * `<regular-table>` as a `StyleListener`, invalidate this draw's\n     * dimensions and attempt to draw more columns.  Useful if your\n     * `StyleListener` changes a cells dimensions, otherwise `<regular-table>`\n     * may not draw enough columns to fill the screen.\n     *\n     * @public\n     * @memberof RegularTableElement\n     */\n    invalidate() {\n        if (!this._is_styling) {\n            throw new Error(\"Cannot call `invalidate()` outside of a `StyleListener`\");\n        }\n        /** @private */\n        this._invalidated = true;\n    }\n\n    /**\n     * Returns the `MetaData` object associated with a `<td>` or `<th>`.  When\n     * your `StyleListener` is invoked, use this method to look up additional\n     * `MetaData` about any `HTMLTableCellElement` in the rendered `<table>`.\n     *\n     * Example:\n     * const elems = document.querySelector(\"td:last-child td:last_child\");\n     * const metadata = table.getMeta(elems);\n     * console.log(`Viewport corner is ${metadata.x}, ${metadata.y}`);\n     *\n     * const header = table.getMeta({row_header_x: 1, y: 3}).row_header;\n     * @public\n     * @memberof RegularTableElement\n     * @param {HTMLTableCellElement|Partial<MetaData>} element - The child\n     * element of this `<regular-table>` for which to look up metadata, or a\n     * coordinates-like object to refer to metadata by logical position.\n     * @returns {MetaData} The metadata associated with the element.\n     */\n    getMeta(element) {\n        if (typeof element === \"undefined\") {\n            return;\n        } else if (element instanceof HTMLElement) {\n            return METADATA_MAP.get(element);\n        } else if (element.row_header_x >= 0) {\n            if (element.row_header_x < this._view_cache.config.row_pivots.length) {\n                const td = this.table_model.body._fetch_cell(element.y, element.row_header_x);\n                return this.getMeta(td);\n            }\n        } else if (element.column_header_y >= 0) {\n            if (element.column_header_y < this._view_cache.config.column_pivots.length) {\n                const td = this.table_model.body._fetch_cell(element.column_header_y, element.y);\n                return this.getMeta(td);\n            }\n        } else {\n            return this.getMeta(this.table_model.body._fetch_cell(element.dy, element.dx + this.table_model._row_headers_length));\n        }\n    }\n\n    /**\n     * Get performance statistics about this `<regular-table>`.  Calling this\n     * method resets the internal state, which makes it convenient to measure\n     * performance at regular intervals (see example).\n     *\n     * Example:\n     * const table = document.getElementById(\"my_regular_table\");\n     * setInterval(() => {\n     *     const {real_fps} = table.getDrawFPS();\n     *     console.log(`Measured ${fps} fps`)\n     * });\n     * @public\n     * @memberof RegularTableElement\n     * @returns {Performance} Performance data aggregated since the last\n     * call to `getDrawFPS()`.\n     */\n    getDrawFPS() {\n        return get_draw_fps();\n    }\n\n    /**\n     * Call this method to set the `scrollLeft` and `scrollTop` for this\n     * `<regular-table>` by calculating the position of this `scrollLeft`\n     * and `scrollTop` relative to the underlying widths of its columns\n     * and heights of its rows.\n     *\n     * Example:\n     * table.scrollToCell(1, 3, 10, 30);\n     * @public\n     * @memberof RegularTableElement\n     * @param {number} x - The left most `x` index column to scroll into view.\n     * @param {number} y - The top most `y` index row to scroll into view.\n     */\n    async scrollToCell(x, y) {\n        if (!this._view_cache) {\n            console.warn(\"data listener not configured\");\n            return;\n        }\n\n        const viewport_row_height = this._column_sizes.row_height || 19;\n        const header_height = this._view_cache.config.column_pivots.length * viewport_row_height;\n        const body_height = this._table_clip.offsetHeight - header_height;\n        const row_height_offset = body_height % viewport_row_height;\n        let real_row_height = (this._virtual_panel.offsetHeight - row_height_offset) / this._nrows;\n        this.scrollTop = Math.ceil(real_row_height * y);\n\n        let scroll_left = 0;\n        while (x > 0) {\n            x--;\n            scroll_left += this._column_sizes.indices[x + this._view_cache.config.row_pivots.length] || 60;\n        }\n\n        this.scrollLeft = Math.ceil(scroll_left);\n        await new Promise(requestAnimationFrame);\n        await this.draw.flush();\n    }\n\n    /**\n     * Call this method to set `DataListener` for this `<regular-table>`,\n     * which will be called whenever a new data slice is needed to render.\n     * Calls to `draw()` will fail if no `DataListener` has been set\n     *\n     * Example:\n     * table.setDataListener((x0, y0, x1, y1) => {\n     *     return {\n     *         num_rows: num_rows = DATA[0].length,\n     *         num_columns: DATA.length,\n     *         data: DATA.slice(x0, x1).map(col => col.slice(y0, y1))\n     *     };\n     * })\n     * @public\n     * @memberof RegularTableElement\n     * @param {DataListener} dataListener\n     * `dataListener` is called by to request a rectangular section of data\n     * for a virtual viewport, (x0, y0, x1, y1), and returns a `DataReponse`\n     * object.\n     * @param {Object} options\n     * @param {(\"both\"|\"horizontal\"|\"vertical\"|\"none\")} options.virtual_mode\n     * The `virtual_mode` options flag may be one of \"both\", \"horizontal\",\n     * \"vertical\", or \"none\" indicating which dimensions of the table should be\n     * virtualized (vs. rendering completely).\n     */\n    setDataListener(dataListener, {virtual_mode = \"both\"} = {}) {\n        let schema = {};\n        let config = {\n            row_pivots: [],\n            column_pivots: [],\n        };\n\n        console.assert(VIRTUAL_MODES.indexOf(virtual_mode) > -1, `Unknown virtual_mode ${virtual_mode};  valid options are \"both\" (default), \"horizontal\", \"vertical\" or \"none\"`);\n        /** @private */\n        this._virtual_mode = virtual_mode;\n        /** @private */\n        this._invalid_schema = true;\n        /** @private */\n        this._view_cache = {view: dataListener, config, schema};\n        this._setup_virtual_scroll();\n    }\n\n    /**\n     * This func only exists to provide hints to doc compulation tools.\n     * Should never be run, and even if it is the body of the func will\n     * never execute.\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    __noop_jsdoc_hints() {\n        if (false) {\n            /**\n             * Draws this virtual panel, given an object of render options that\n             * allow the implementor to fine tune the individual render frames\n             * based on the interaction and previous render state.\n             *\n             * @public\n             * @type {(opt?: DrawOptions) => void}\n             * @memberof RegularTableElement\n             * */\n            this.draw = null;\n        }\n    }\n}\n\nif (document.createElement(\"regular-table\").constructor === HTMLElement) {\n    window.customElements.define(\"regular-table\", RegularTableElement);\n}\n\n/**\n * An object with performance statistics about calls to\n * `draw()` from some time interval (captured in milliseconds by the\n * `elapsed` proprty).\n *\n * @public\n * @typedef Performance\n * @type {object}\n * @property {number} avg - Avergage milliseconds per call.\n * @property {number} real_fps - `num_frames` / `elapsed`\n * @property {number} virtual_fps - `elapsed` / `avg`\n * @property {number} num_frames - Number of frames rendered.\n * @property {number} elapsed - Number of milliseconds since last call\n * to `getDrawFPS()`.\n */\n\n/**\n * An object describing virtual rendering metadata about an\n * `HTMLTableCellElement`, use this object to map rendered `<th>` or `<td>`\n * elements back to your `data`, `row_headers` or `column_headers` within\n * listener functions for `addStyleListener()` and `addEventListener()`.\n *\n * Example:\n *\n * MetaData                     (x = 0, column_header_y = 0))\n *                              *-------------------------------------+\n *                              |                                     |\n *                              |                                     |\n *                              +-------------------------------------+\n * (row_header_x = 0, y = 0)    (x = 0, y = 0)\n * *------------------------+   *-------------------------------------+\n * |                        |   |                                     |\n * |                        |   |      (x0, y0)                       |\n * |                        |   |      *---------------*              |\n * |                        |   |      |               |              |\n * |                        |   |      |     * (x, y)  |              |\n * |                        |   |      |               |              |\n * |                        |   |      *---------------* (x1, y1)     |\n * |                        |   |                                     |\n * +------------------------+   +-------------------------------------+\n *\n * @public\n * @typedef MetaData\n * @type {object}\n * @property {number} [x] - The `x` index in your virtual data model.\n * property is only generated for `<td>`, `<th>` from `row_headers`.\n * @property {number} [y] - The `y` index in your virtual data model.\n * property is only generated for `<td>`, `<th>` from `row_headers`.\n * @property {number} [x0] - The `x` index of the viewport origin in\n * your data model, e.g. what was passed to `x0` when your\n * `dataListener` was invoked.\n * @property {number} [y0] - The `y` index of the viewport origin in\n * your data model, e.g. what was passed to `y0` when your\n * `dataListener` was invoked.\n * @property {number} [x1] - The `x` index of the viewport corner in\n * your data model, e.g. what was passed to `x1` when your\n * `dataListener` was invoked.\n * @property {number} [y1] - The `y` index of the viewport corner in\n * your data model, e.g. what was passed to `y1` when your\n * `dataListener` was invoked.\n * @property {number} [dx] - The `x` index in `DataResponse.data`, this\n * property is only generated for `<td>`, and `<th>` from `column_headers`.\n * @property {number} [dy] - The `y` index in `DataResponse.data`, this\n * property is only generated for `<td>`, `<th>` from `row_headers`.\n * @property {number} [column_header_y] - The `y` index in\n * `DataResponse.column_headers[x]`, this property is only generated for `<th>`\n * from `column_headers`.\n * @property {number} [row_header_x] - The `x` index in\n * `DataResponse.row_headers[y]`, this property is only generated for `<th>`\n * from `row_headers`.\n * @property {number} size_key - The unique index of this column in a full\n * `<table>`, which is `x` + (Total Row Header Columns).\n * @property {(string|HTMLElement)[]} [row_header] - The `Array` for this `y` in\n * `DataResponse.row_headers`, if it was provided.\n * @property {(string|HTMLElement)[]} [column_header] - The `Array` for this `x`\n * in `DataResponse.column_headers`, if it was provided.\n * @property {(string|HTMLElement)} [value] - The value dispalyed in the cell or\n * header.\n */\n\n/**\n * The `DataResponse` object describes a rectangular region of a virtual\n * data set, and some associated metadata.  `<regular-table>` will use this\n * object to render the `<table>`, though it may make multiple requests for\n * different regions to achieve a compelte render as it must estimate\n * certain dimensions.  You must construct a `DataResponse` object to\n * implement a `DataListener`.\n *\n * Example:\n * {\n *     \"num_rows\": 26,\n *     \"num_columns\": 3,\n *     \"data\": [\n *         [0, 1],\n *         [\"A\", \"B\"]\n *     ],\n *     \"row_headers\": [\n *         [\"Rowgroup 1\", \"Row 1\"],\n *         [\"Rowgroup 1\", \"Row 2\"]\n *     ],\n *     \"column_headers\": [\n *         [\"Colgroup 1\", \"Column 1\"],\n *         [\"Colgroup 1\", \"Column 2\"]\n *     ]\n * }\n * @public\n * @typedef DataResponse\n * @type {object}\n * @property {(string|HTMLElement)[][]} [column_headers] - A two dimensional\n * `Array` of column group headers, in specificity order.  No `<thead>`\n * will be generated if this property is not provided.\n * @property {(string|HTMLElement)[][]} [row_headers] - A two dimensional\n * `Array` of row group headers, in specificity order.  No `<th>`\n * elements within `<tbody>` will be generated if this property is not\n * provided.\n * @property {(string|HTMLElement)[][]} data - A two dimensional `Array`\n * representing a rectangular section of the underlying data set from\n * (x0, y0) to (x1, y1), arranged in columnar fashion such that\n * `data[x][y]` returns the `y`th row of the `x`th column of the slice.\n * @property {number} num_rows - Total number of rows in the underlying\n * data set.\n * @property {number} num_columns - Total number of columns in the\n * underlying data set.\n */\n\n/**\n * The `DataListener` is similar to a normal event listener function.\n * Unlike a normal event listener, it takes regular arguments (not an\n * `Event`); and returns a `Promise` for a `DataResponse` object for this\n * region (as opposed to returning `void` as a standard event listener).\n *\n * @public\n * @callback DataListener\n * @param {number} x0 - The origin `x` index (column).\n * @param {number} y0 - The origin `y` index (row).\n * @param {number} x1 - The corner `x` index (column).\n * @param {number} y1 - The corner `y` index (row).\n * @returns {Promise<DataResponse>} The resulting `DataResponse`.  Make sure\n * to `resolve` or `reject` the `Promise`, or your `<regular-table>` will\n * never render!\n */\n\n/**\n * Options for the draw method.\n *\n * @public\n * @typedef DrawOptions\n * @type {object}\n * @property {boolean} [invalid_viewport]\n * @property {boolean} [preserve_width]\n */\n\n/**\n * Public summary of table_model type.\n *\n * @public\n * @typedef TableModel\n * @type {object}\n * @property {ViewModel} header\n * @property {ViewModel} body\n * @property {() => number} num_columns\n */\n\n/**\n * Public summary of table_model.header and table_model.body base type.\n *\n * @public\n * @typedef ViewModel\n * @type {object}\n * @property {any} table\n * @property {any[]} cells\n * @property {any[]} rows\n * @property {() => number} num_columns\n * @property {() => number} num_rows\n */\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n// TODO Import this directly due to overly-sensitive tree shaking.\nimport {get_type_config} from \"../../../perspective/src/js/config/index.js\";\nimport {style_cell_flash} from \"./cell_flash.js\";\nimport {sortHandler} from \"./sorting.js\";\n\nimport {\n    activate_plugin_menu,\n    PLUGIN_SYMBOL,\n    make_color_record,\n} from \"./plugin_menu.js\";\nimport {rgbaToRgb, infer_foreground_from_background} from \"./color_utils.js\";\n\nimport chroma from \"chroma-js\";\n\nfunction styleListener(regularTable) {\n    const header_depth = regularTable._view_cache.config.row_pivots.length - 1;\n    let group_headers = Array.from(\n        regularTable.children[0].children[0].children\n    );\n\n    const plugins = regularTable[PLUGIN_SYMBOL] || {};\n    if (group_headers.length > 0) {\n        let [col_headers] = group_headers.splice(group_headers.length - 1, 1);\n\n        for (const td of col_headers?.children) {\n            const metadata = regularTable.getMeta(td);\n            const column_name =\n                metadata.column_header?.[metadata.column_header?.length - 1];\n            const sort = this._config.sort.find((x) => x[0] === column_name);\n            let needs_border = metadata.row_header_x === header_depth;\n            const is_corner = typeof metadata.x === \"undefined\";\n            needs_border =\n                needs_border ||\n                (metadata.x + 1) % this._config.columns.length === 0;\n            td.classList.toggle(\"psp-header-border\", needs_border);\n            td.classList.toggle(\"psp-header-group\", false);\n            td.classList.toggle(\"psp-header-leaf\", true);\n            td.classList.toggle(\"psp-is-top\", false);\n            td.classList.toggle(\"psp-header-corner\", is_corner);\n            td.classList.toggle(\n                \"psp-header-sort-asc\",\n                !!sort && sort[1] === \"asc\"\n            );\n            td.classList.toggle(\n                \"psp-header-sort-desc\",\n                !!sort && sort[1] === \"desc\"\n            );\n            td.classList.toggle(\n                \"psp-header-sort-col-asc\",\n                !!sort && sort[1] === \"col asc\"\n            );\n            td.classList.toggle(\n                \"psp-header-sort-col-desc\",\n                !!sort && sort[1] === \"col desc\"\n            );\n\n            let type = get_psp_type.call(this, metadata);\n            const is_numeric = type === \"integer\" || type === \"float\";\n            const is_string = type === \"string\";\n            td.classList.toggle(\"psp-align-right\", is_numeric);\n            td.classList.toggle(\"psp-align-left\", !is_numeric);\n            td.classList.toggle(\n                \"psp-menu-open\",\n                this._open_column_styles_menu[0] === metadata._virtual_x\n            );\n            td.classList.toggle(\n                \"psp-menu-enabled\",\n                (is_string || is_numeric) && !is_corner\n            );\n            td.classList.toggle(\n                \"psp-is-width-override\",\n                regularTable._column_sizes?.override[metadata.size_key] !==\n                    undefined\n            );\n        }\n    }\n\n    const m = [];\n    let marked = new Set();\n    const table = regularTable.children[0];\n    for (let y = 0; y < group_headers.length; y++) {\n        let row = table.rows[y];\n        const tops = new Set();\n        for (let x = 0; x < row.cells.length; x++) {\n            const td = row.cells[x];\n            td.style.backgroundColor = \"\";\n            const metadata = regularTable.getMeta(td);\n            let needs_border =\n                metadata.row_header_x === header_depth || metadata.x >= 0;\n            td.classList.toggle(\"psp-align-right\", false);\n            td.classList.toggle(\"psp-align-left\", false);\n            td.classList.toggle(\"psp-header-group\", true);\n            td.classList.toggle(\"psp-header-leaf\", false);\n            td.classList.toggle(\"psp-header-border\", needs_border);\n            td.classList.toggle(\n                \"psp-header-group-corner\",\n                typeof metadata.x === \"undefined\"\n            );\n            td.classList.toggle(\"psp-color-mode-bar\", false);\n\n            td.classList.toggle(\"psp-header-sort-asc\", false);\n            td.classList.toggle(\"psp-header-sort-desc\", false);\n            td.classList.toggle(\"psp-header-sort-col-asc\", false);\n            td.classList.toggle(\"psp-header-sort-col-desc\", false);\n\n            let cell = row.cells[x],\n                xx = x,\n                tx,\n                ty;\n\n            for (; m[y] && m[y][xx]; ++xx);\n            tops.add(xx);\n            for (tx = xx; tx < xx + cell.colSpan; ++tx) {\n                for (ty = y; ty < y + cell.rowSpan; ++ty) {\n                    if (!m[ty]) m[ty] = [];\n                    m[ty][tx] = true;\n                }\n            }\n\n            cell.classList.toggle(\"psp-is-top\", y === 0 || !marked.has(tx));\n        }\n        marked = tops;\n    }\n\n    for (const tr of regularTable.children[0].children[1].children) {\n        for (const td of tr.children) {\n            const metadata = regularTable.getMeta(td);\n            const column_name =\n                metadata.column_header?.[metadata.column_header?.length - 1];\n\n            let type = get_psp_type.call(this, metadata);\n            const plugin = plugins[column_name];\n            const is_numeric = type === \"integer\" || type === \"float\";\n\n            if (is_numeric) {\n                const is_positive = metadata.user > 0;\n                const is_negative = metadata.user < 0;\n\n                let pos_bg_color;\n                if (plugin?.pos_bg_color !== undefined) {\n                    pos_bg_color = plugin.pos_bg_color;\n                } else {\n                    pos_bg_color = this._pos_bg_color;\n                }\n\n                let neg_bg_color;\n                if (plugin?.neg_bg_color !== undefined) {\n                    neg_bg_color = plugin.neg_bg_color;\n                } else {\n                    neg_bg_color = this._neg_bg_color;\n                }\n\n                const bg_tuple = is_positive\n                    ? pos_bg_color\n                    : is_negative\n                    ? neg_bg_color\n                    : [\"\", ...this._plugin_background, \"\"];\n\n                {\n                    const [hex, r, g, b, _gradhex] = bg_tuple;\n\n                    td.style.position = \"\";\n                    if (plugin?.number_bg_mode === \"color\") {\n                        td.style.animation = \"\";\n                        td.style.backgroundColor = hex;\n                    } else if (plugin?.number_bg_mode === \"gradient\") {\n                        const a = Math.max(\n                            0,\n                            Math.min(\n                                1,\n                                Math.abs(metadata.user / plugin.bg_gradient)\n                            )\n                        );\n                        const source = this._plugin_background;\n                        const foreground = infer_foreground_from_background(\n                            rgbaToRgb([r, g, b, a], source)\n                        );\n\n                        td.style.animation = \"\";\n                        td.style.color = foreground;\n                        td.style.backgroundColor = `rgba(${r},${g},${b},${a})`;\n                    } else if (plugin?.number_bg_mode === \"pulse\") {\n                        // TODO!\n                        style_cell_flash.call(\n                            this,\n                            metadata,\n                            td,\n                            pos_bg_color,\n                            neg_bg_color\n                        );\n                        td.style.backgroundColor = \"\";\n                    } else if (\n                        plugin?.number_bg_mode === \"disabled\" ||\n                        !plugin?.number_bg_mode\n                    ) {\n                        td.style.animation = \"\";\n                        td.style.backgroundColor = \"\";\n                    } else {\n                        td.style.animation = \"\";\n                        td.style.backgroundColor = \"\";\n                    }\n                }\n\n                const [hex, r, g, b, gradhex] = (() => {\n                    if (plugin?.pos_fg_color !== undefined) {\n                        return is_positive\n                            ? plugin.pos_fg_color\n                            : is_negative\n                            ? plugin.neg_fg_color\n                            : [\"\", ...this._plugin_background, \"\"];\n                    } else {\n                        return is_positive\n                            ? this._pos_fg_color\n                            : is_negative\n                            ? this._neg_fg_color\n                            : [\"\", ...this._plugin_background, \"\"];\n                    }\n                })();\n\n                if (plugin?.number_fg_mode === \"disabled\") {\n                    if (plugin?.number_bg_mode === \"color\") {\n                        const source = this._plugin_background;\n                        const foreground = infer_foreground_from_background(\n                            rgbaToRgb(\n                                [bg_tuple[1], bg_tuple[2], bg_tuple[3], 1],\n                                source\n                            )\n                        );\n                        td.style.color = foreground;\n                    } else if (plugin?.number_bg_mode === \"gradient\") {\n                    } else {\n                        td.style.color = \"\";\n                    }\n                } else if (plugin?.number_fg_mode === \"bar\") {\n                    td.style.color = \"\";\n                    td.style.position = \"relative\";\n                    if (\n                        gradhex !== \"\" &&\n                        td.children.length > 0 &&\n                        td.children[0].nodeType === Node.ELEMENT_NODE\n                    ) {\n                        td.children[0].style.background = gradhex;\n                    }\n                } else if (\n                    plugin?.number_fg_mode === \"color\" ||\n                    !plugin?.number_fg_mode\n                ) {\n                    td.style.color = hex;\n                }\n            } else if (type === \"boolean\") {\n                const [hex] =\n                    metadata.user === true\n                        ? this._pos_fg_color\n                        : metadata.user === false\n                        ? this._neg_fg_color\n                        : [\"\", 0, 0, 0, \"\"];\n\n                td.style.backgroundColor = \"\";\n                td.style.color = hex;\n            } else if (type === \"string\") {\n                const [hex, r, g, b, gradhex] = (() => {\n                    if (plugin?.color !== undefined) {\n                        return plugin.color;\n                    } else {\n                        return this._color;\n                    }\n                })();\n\n                if (\n                    plugin?.string_color_mode === \"foreground\" &&\n                    metadata.user !== null\n                ) {\n                    td.style.color = hex;\n                    td.style.backgroundColor = \"\";\n                    if (plugin?.format === \"link\") {\n                        td.children[0].style.color = hex;\n                    }\n                } else if (\n                    plugin?.string_color_mode === \"background\" &&\n                    metadata.user !== null\n                ) {\n                    const source = this._plugin_background;\n                    const foreground = infer_foreground_from_background(\n                        rgbaToRgb([r, g, b, 1], source)\n                    );\n                    td.style.color = foreground;\n                    td.style.backgroundColor = hex;\n                } else if (\n                    plugin?.string_color_mode === \"series\" &&\n                    metadata.user !== null\n                ) {\n                    if (!this._series_color_map.has(column_name)) {\n                        this._series_color_map.set(column_name, new Map());\n                        this._series_color_seed.set(column_name, 0);\n                    }\n\n                    const series_map = this._series_color_map.get(column_name);\n                    if (!series_map.has(metadata.user)) {\n                        const seed = this._series_color_seed.get(column_name);\n                        series_map.set(metadata.user, seed);\n                        this._series_color_seed.set(column_name, seed + 1);\n                    }\n\n                    const color_seed = series_map.get(metadata.user);\n                    let [h, s, l] = chroma(hex).hsl();\n                    h = h + ((color_seed * 150) % 360);\n                    const color2 = chroma(h, s, l, \"hsl\");\n                    const [r, g, b] = color2.rgb();\n                    const hex2 = color2.hex();\n                    const source = this._plugin_background;\n                    const foreground = infer_foreground_from_background(\n                        rgbaToRgb([r, g, b, 1], source)\n                    );\n                    td.style.color = foreground;\n                    td.style.backgroundColor = hex2;\n                } else {\n                    td.style.backgroundColor = \"\";\n                    td.style.color = \"\";\n                }\n            } else {\n                td.style.backgroundColor = \"\";\n                td.style.color = \"\";\n            }\n\n            td.classList.toggle(\n                \"psp-bool-type\",\n                type === \"boolean\" && metadata.user !== null\n            );\n\n            const is_th = td.tagName === \"TH\";\n            if (is_th) {\n                const is_not_empty =\n                    typeof metadata.value != undefined &&\n                    typeof metadata.value != null &&\n                    metadata.value?.toString()?.trim().length > 0;\n                const is_leaf =\n                    metadata.row_header_x >= this._config.group_by.length;\n                const next = regularTable.getMeta({\n                    dx: 0,\n                    dy: metadata.y - metadata.y0 + 1,\n                });\n                const is_collapse =\n                    next &&\n                    next.row_header &&\n                    typeof next.row_header[metadata.row_header_x + 1] !==\n                        \"undefined\";\n                td.classList.toggle(\"psp-tree-label\", is_not_empty && !is_leaf);\n                td.classList.toggle(\n                    \"psp-tree-label-expand\",\n                    is_not_empty && !is_leaf && !is_collapse\n                );\n                td.classList.toggle(\n                    \"psp-tree-label-collapse\",\n                    is_not_empty && !is_leaf && is_collapse\n                );\n                td.classList.toggle(\"psp-tree-leaf\", is_not_empty && is_leaf);\n            }\n\n            td.classList.toggle(\"psp-align-right\", !is_th && is_numeric);\n            td.classList.toggle(\"psp-align-left\", is_th || !is_numeric);\n            td.classList.toggle(\n                \"psp-color-mode-bar\",\n                plugin?.number_fg_mode === \"bar\" && is_numeric\n            );\n        }\n    }\n}\n\nasync function expandCollapseHandler(regularTable, event) {\n    const meta = regularTable.getMeta(event.target);\n    const is_collapse = event.target.classList.contains(\n        \"psp-tree-label-collapse\"\n    );\n    if (event.shiftKey && is_collapse) {\n        this._view.set_depth(\n            meta.row_header.filter((x) => x !== undefined).length - 2\n        );\n    } else if (event.shiftKey) {\n        this._view.set_depth(\n            meta.row_header.filter((x) => x !== undefined).length - 1\n        );\n    } else if (is_collapse) {\n        this._view.collapse(meta.y);\n    } else {\n        this._view.expand(meta.y);\n    }\n    this._num_rows = await this._view.num_rows();\n    this._num_columns = await this._view.num_columns();\n    regularTable.draw();\n}\n\nasync function mousedownListener(regularTable, event) {\n    if (event.which !== 1) {\n        return;\n    }\n\n    let target = event.target;\n    if (target.tagName === \"A\") {\n        return;\n    }\n\n    while (target.tagName !== \"TD\" && target.tagName !== \"TH\") {\n        target = target.parentElement;\n        if (!regularTable.contains(target)) {\n            return;\n        }\n    }\n\n    if (target.classList.contains(\"psp-tree-label\")) {\n        expandCollapseHandler.call(this, regularTable, event);\n        event.stopImmediatePropagation();\n        return;\n    }\n\n    const rect = target.getBoundingClientRect();\n    if (\n        target.classList.contains(\"psp-menu-enabled\") &&\n        event.clientY - rect.top > 16\n    ) {\n        const meta = regularTable.getMeta(target);\n        const column_name =\n            meta.column_header?.[meta.column_header?.length - 1];\n        const column_type = this._schema[column_name];\n        this._open_column_styles_menu.unshift(meta._virtual_x);\n        if (column_type === \"string\") {\n            regularTable.draw({preserve_width: true});\n            activate_plugin_menu.call(this, regularTable, target);\n        } else {\n            const [min, max] = await this._view.get_min_max(column_name);\n            regularTable.draw({preserve_width: true});\n            let bound = Math.max(Math.abs(min), Math.abs(max));\n            if (bound > 1) {\n                bound = Math.round(bound * 100) / 100;\n            }\n\n            activate_plugin_menu.call(this, regularTable, target, bound);\n        }\n\n        event.preventDefault();\n        event.stopImmediatePropagation();\n    } else if (\n        target.classList.contains(\"psp-header-leaf\") &&\n        !target.classList.contains(\"psp-header-corner\")\n    ) {\n        sortHandler.call(this, regularTable, event, target);\n        event.stopImmediatePropagation();\n    }\n}\n\nfunction clickListener(regularTable, event) {\n    if (event.which !== 1) {\n        return;\n    }\n\n    let target = event.target;\n    while (target.tagName !== \"TD\" && target.tagName !== \"TH\") {\n        target = target.parentElement;\n        if (!regularTable.contains(target)) {\n            return;\n        }\n    }\n\n    if (target.classList.contains(\"psp-tree-label\") && event.offsetX < 26) {\n        event.stopImmediatePropagation();\n    } else if (\n        target.classList.contains(\"psp-header-leaf\") &&\n        !target.classList.contains(\"psp-header-corner\")\n    ) {\n        event.stopImmediatePropagation();\n    }\n}\n\nconst FORMATTERS = {};\n\nconst FORMATTER_CONS = {\n    datetime: Intl.DateTimeFormat,\n    date: Intl.DateTimeFormat,\n    integer: Intl.NumberFormat,\n    float: Intl.NumberFormat,\n    boolean: class {\n        format(val) {\n            return val ? \"check\" : \"close\";\n        }\n    },\n};\n\nexport const formatters = FORMATTERS;\n\nfunction _format(parts, val, plugins = {}, use_table_schema = false) {\n    if (val === null) {\n        return \"-\";\n    }\n\n    const title = parts[parts.length - 1];\n    const type =\n        (use_table_schema && this._table_schema[title]) ||\n        this._schema[title] ||\n        \"string\";\n    const plugin = plugins[title];\n    const is_numeric = type === \"integer\" || type === \"float\";\n    if (is_numeric && plugin?.number_fg_mode === \"bar\") {\n        const a = Math.max(\n            0,\n            Math.min(0.95, Math.abs(val / plugin.fg_gradient) * 0.95)\n        );\n        const div = this._div_factory.get();\n        const anchor = val >= 0 ? \"left\" : \"right\";\n        div.setAttribute(\n            \"style\",\n            `width:${(a * 100).toFixed(\n                2\n            )}%;position:absolute;${anchor}:0;height:80%;top:10%;pointer-events:none;`\n        );\n        return div;\n    } else if (plugin?.format === \"link\" && type === \"string\") {\n        const anchor = document.createElement(\"a\");\n        anchor.setAttribute(\"href\", val);\n        anchor.setAttribute(\"target\", \"_blank\");\n        anchor.textContent = val;\n        return anchor;\n    } else if (plugin?.format === \"bold\" && type === \"string\") {\n        const anchor = document.createElement(\"b\");\n        anchor.textContent = val;\n        return anchor;\n    } else if (plugin?.format === \"italics\" && type === \"string\") {\n        const anchor = document.createElement(\"i\");\n        anchor.textContent = val;\n        return anchor;\n    } else {\n        const is_plugin_override =\n            is_numeric && plugin && plugin.fixed !== undefined;\n        let formatter_key = is_plugin_override\n            ? `${type}${plugin.fixed}`\n            : type;\n        if (FORMATTERS[formatter_key] === undefined) {\n            const type_config = get_type_config(type);\n            if (is_plugin_override) {\n                const opts = {\n                    minimumFractionDigits: plugin.fixed,\n                    maximumFractionDigits: plugin.fixed,\n                };\n                FORMATTERS[formatter_key] = new FORMATTER_CONS[type](\n                    \"en-us\",\n                    opts\n                );\n            } else if (FORMATTER_CONS[type]) {\n                FORMATTERS[formatter_key] = new FORMATTER_CONS[type](\n                    \"en-us\",\n                    type_config.format\n                );\n            } else {\n                FORMATTERS[formatter_key] = false;\n            }\n        }\n\n        return FORMATTERS[formatter_key]\n            ? FORMATTERS[formatter_key].format(val)\n            : val;\n    }\n}\n\nfunction* _tree_header(paths = [], row_headers, regularTable) {\n    const plugins = regularTable[PLUGIN_SYMBOL];\n    for (let path of paths) {\n        path = [\"TOTAL\", ...path];\n        const last = path[path.length - 1];\n        path = path.slice(0, path.length - 1).fill(\"\");\n        const formatted = _format.call(\n            this,\n            [row_headers[path.length - 1]],\n            last,\n            plugins,\n            true\n        );\n\n        if (formatted instanceof HTMLElement) {\n            path = path.concat(formatted);\n        } else {\n            path = path.concat({toString: () => formatted});\n        }\n\n        path.length = row_headers.length + 1;\n        yield path;\n    }\n}\n\nfunction createDataListener() {\n    let last_meta;\n    let last_column_paths;\n    let last_ids;\n    let last_reverse_ids;\n    let last_reverse_columns;\n    return async function dataListener(regularTable, x0, y0, x1, y1) {\n        let columns = {};\n        let new_window;\n        if (x1 - x0 > 0 && y1 - y0 > 0) {\n            this._is_old_viewport =\n                this._last_window?.start_row === y0 &&\n                this._last_window?.end_row === y1 &&\n                this._last_window?.start_col === x0 &&\n                this._last_window?.end_col === x1;\n\n            new_window = {\n                start_row: y0,\n                start_col: x0,\n                end_row: y1,\n                end_col: x1,\n                id: true,\n            };\n\n            columns = await this._view.to_columns(new_window);\n            this._last_window = new_window;\n            this._ids = columns.__ID__;\n            this._reverse_columns = this._column_paths\n                .slice(x0, x1)\n                .reduce((acc, x, i) => {\n                    acc.set(x, i);\n                    return acc;\n                }, new Map());\n\n            this._reverse_ids = this._ids.reduce((acc, x, i) => {\n                acc.set(x?.join(\"|\"), i);\n                return acc;\n            }, new Map());\n        } else {\n            this._div_factory.clear();\n        }\n\n        const data = [],\n            metadata = [],\n            column_headers = [],\n            column_paths = [];\n\n        // for (const path of this._column_paths.slice(x0, x1)) {\n        for (\n            let ipath = x0;\n            ipath < Math.min(x1, this._column_paths.length);\n            ++ipath\n        ) {\n            const path = this._column_paths[ipath];\n            const path_parts = path.split(\"|\");\n            const column = columns[path] || new Array(y1 - y0).fill(null);\n            data.push(\n                column.map((x) =>\n                    _format.call(\n                        this,\n                        path_parts,\n                        x,\n                        regularTable[PLUGIN_SYMBOL]\n                    )\n                )\n            );\n            metadata.push(column);\n            column_headers.push(path_parts);\n            column_paths.push(path);\n        }\n\n        // Only update the last state if this is not a \"phantom\" call.\n        if (x1 - x0 > 0 && y1 - y0 > 0) {\n            this.last_column_paths = last_column_paths;\n            this.last_meta = last_meta;\n            this.last_ids = last_ids;\n            this.last_reverse_ids = last_reverse_ids;\n            this.last_reverse_columns = last_reverse_columns;\n\n            last_column_paths = column_paths;\n            last_meta = metadata;\n            last_ids = this._ids;\n            last_reverse_ids = this._reverse_ids;\n            last_reverse_columns = this._reverse_columns;\n        }\n\n        return {\n            num_rows: this._num_rows,\n            num_columns: this._column_paths.length,\n            row_headers: Array.from(\n                _tree_header.call(\n                    this,\n                    columns.__ROW_PATH__,\n                    this._config.group_by,\n                    regularTable\n                )\n            ),\n            column_headers,\n            data,\n            metadata,\n        };\n    };\n}\n\nfunction get_rule(regular, tag, def) {\n    let color = window.getComputedStyle(regular).getPropertyValue(tag).trim();\n    if (color.length > 0) {\n        return color;\n    } else {\n        return def;\n    }\n}\n\nclass ElemFactory {\n    constructor(name) {\n        this._name = name;\n        this._elements = [];\n        this._index = 0;\n    }\n\n    clear() {\n        this._index = 0;\n    }\n\n    get() {\n        if (!this._elements[this._index]) {\n            this._elements[this._index] = document.createElement(this._name);\n        }\n        const elem = this._elements[this._index];\n        this._index += 1;\n        return elem;\n    }\n}\n\nfunction blend(a, b) {\n    return chroma.mix(a, `rgb(${b[0]},${b[1]},${b[2]})`, 0.5).hex();\n}\n\nexport async function createModel(regular, table, view, extend = {}) {\n    const config = await view.get_config();\n\n    // Extract the entire expression string as typed by the user, so we can\n    // feed it into `validate_expressions` and get back the data types for\n    // each column without it being affected by a pivot.\n    const expressions = config.expressions.map((expr) => expr[1]);\n    const [\n        table_schema,\n        validated_expressions,\n        num_rows,\n        schema,\n        expression_schema,\n        column_paths,\n    ] = await Promise.all([\n        table.schema(),\n        table.validate_expressions(expressions),\n        view.num_rows(),\n        view.schema(),\n        view.expression_schema(),\n        view.column_paths(),\n    ]);\n\n    const _plugin_background = chroma(\n        get_rule(regular, \"--plugin--background\", \"#FFFFFF\")\n    ).rgb();\n\n    const _pos_fg_color = make_color_record(\n        get_rule(regular, \"--rt-pos-cell--color\", \"#338DCD\")\n    );\n\n    const _neg_fg_color = make_color_record(\n        get_rule(regular, \"--rt-neg-cell--color\", \"#FF5942\")\n    );\n\n    const _pos_bg_color = make_color_record(\n        blend(_pos_fg_color[0], _plugin_background)\n    );\n\n    const _neg_bg_color = make_color_record(\n        blend(_neg_fg_color[0], _plugin_background)\n    );\n\n    const _color = make_color_record(\n        get_rule(regular, \"--active--color\", \"#ff0000\")\n    );\n\n    const _schema = {...schema, ...expression_schema};\n    const _table_schema = {\n        ...table_schema,\n        ...validated_expressions.expression_schema,\n    };\n\n    const _column_paths = column_paths.filter((path) => {\n        return path !== \"__ROW_PATH__\" && path !== \"__ID__\";\n    });\n\n    const _is_editable = [];\n    const _column_types = [];\n    for (const column_path of _column_paths) {\n        const column_path_parts = column_path.split(\"|\");\n        const column = column_path_parts[column_path_parts.length - 1];\n        _column_types.push(_schema[column]);\n        _is_editable.push(!!table_schema[column]);\n    }\n\n    const model = Object.assign(extend, {\n        _view: view,\n        _table: table,\n        _table_schema,\n        _config: config,\n        _num_rows: num_rows,\n        _schema,\n        _ids: [],\n        _open_column_styles_menu: [],\n        _plugin_background,\n        _color,\n        _pos_fg_color,\n        _neg_fg_color,\n        _pos_bg_color,\n        _neg_bg_color,\n        _column_paths,\n        _column_types,\n        _is_editable,\n        _row_header_types: config.group_by.map((column_path) => {\n            return _table_schema[column_path];\n        }),\n        _series_color_map: new Map(),\n        _series_color_seed: new Map(),\n        get_psp_type,\n    });\n\n    // Re-use div factory\n    model._div_factory = model._div_factory || new ElemFactory(\"div\");\n\n    regular.setDataListener(createDataListener().bind(model, regular), {\n        virtual_mode:\n            window\n                .getComputedStyle(regular)\n                .getPropertyValue(\"--datagrid-virtual-mode\")\n                ?.trim() || \"both\",\n    });\n\n    return model;\n}\n\nfunction get_psp_type(metadata) {\n    if (metadata.x >= 0) {\n        return this._column_types[metadata.x];\n    } else {\n        return this._row_header_types[metadata.row_header_x - 1];\n    }\n}\n\nexport async function configureRegularTable(regular, model) {\n    regular.addStyleListener(styleListener.bind(model, regular));\n    regular.addEventListener(\n        \"mousedown\",\n        mousedownListener.bind(model, regular)\n    );\n    regular.addEventListener(\"click\", clickListener.bind(model, regular));\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nexport function style_cell_flash(\n    metadata,\n    td,\n    [, , , , , pos_s, pos_e],\n    [, , , , , neg_s, neg_e]\n) {\n    const id = this._ids?.[metadata.dy]?.join(\"|\");\n    const metadata_path = metadata.column_header.join(\"|\");\n    if (\n        this.last_reverse_columns?.has(metadata_path) &&\n        this.last_reverse_ids?.has(id)\n    ) {\n        const row_idx = this.last_reverse_ids?.get(id);\n        const col_idx = this.last_reverse_columns.get(metadata_path);\n        if (!this._is_old_viewport) {\n            td.style.animation = \"\";\n        } else if (this.last_meta?.[col_idx]?.[row_idx] > metadata.user) {\n            td.style.setProperty(\"--pulse--background-color-start\", neg_s);\n            td.style.setProperty(\"--pulse--background-color-end\", neg_e);\n            if (td.style.animationName === \"pulse_neg\") {\n                td.style.animation = \"pulse_neg2 0.5s linear\";\n            } else {\n                td.style.animation = \"pulse_neg 0.5s linear\";\n            }\n        } else if (this.last_meta?.[col_idx]?.[row_idx] < metadata.user) {\n            td.style.setProperty(\"--pulse--background-color-start\", pos_s);\n            td.style.setProperty(\"--pulse--background-color-end\", pos_e);\n            if (td.style.animationName === \"pulse_pos\") {\n                td.style.animation = \"pulse_pos2 0.5s linear\";\n            } else {\n                td.style.animation = \"pulse_pos 0.5s linear\";\n            }\n        } else if (row_idx !== metadata.dy) {\n            td.style.animation = \"\";\n        }\n    } else {\n        td.style.animation = \"\";\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nexport async function configureSortable(table, viewer) {\n    table.addEventListener(\"regular-table-psp-sort\", (event) => {\n        this._preserve_focus_state = true;\n        viewer.restore({sort: event.detail.sort});\n    });\n}\n\nexport async function sortHandler(regularTable, event, target) {\n    const meta = regularTable.getMeta(target);\n    const column_name = meta.column_header[meta.column_header.length - 1];\n    const sort_method = event.shiftKey ? append_sort : override_sort;\n    const sort = sort_method.call(this, column_name);\n    regularTable.dispatchEvent(\n        new CustomEvent(\"regular-table-psp-sort\", {detail: {sort}})\n    );\n}\n\nexport function append_sort(column_name) {\n    const sort = [];\n    let found = false;\n    for (const sort_term of this._config.sort) {\n        const [_column_name, _sort_dir] = sort_term;\n        if (_column_name === column_name) {\n            found = true;\n            const term = create_sort.call(this, column_name, _sort_dir);\n            if (term) {\n                sort.push(term);\n            }\n        } else {\n            sort.push(sort_term);\n        }\n    }\n    if (!found) {\n        sort.push([column_name, \"desc\"]);\n    }\n    return sort;\n}\n\nexport function override_sort(column_name) {\n    for (const [_column_name, _sort_dir] of this._config.sort) {\n        if (_column_name === column_name) {\n            const sort = create_sort.call(this, column_name, _sort_dir);\n            return sort ? [sort] : [];\n        }\n    }\n    return [[column_name, \"desc\"]];\n}\n\nexport function create_sort(column_name, sort_dir) {\n    const is_col_sortable = this._config.split_by.length > 0;\n    const order = is_col_sortable ? ROW_COL_SORT_ORDER : ROW_SORT_ORDER;\n    const inc_sort_dir = sort_dir ? order[sort_dir] : \"desc\";\n    if (inc_sort_dir) {\n        return [column_name, inc_sort_dir];\n    }\n}\n\nconst ROW_SORT_ORDER = {desc: \"asc\", asc: undefined};\nconst ROW_COL_SORT_ORDER = {\n    desc: \"asc\",\n    asc: \"col desc\",\n    \"col desc\": \"col asc\",\n    \"col asc\": undefined,\n};\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport chroma from \"chroma-js\";\n\nexport const PLUGIN_SYMBOL = Symbol(\"Plugin Symbol\");\n\nexport function make_gradient(chromahex) {\n    const [r, g, b] = chromahex.rgb();\n    const [r1, g1, b1] = chromahex\n        .set(\"hsl.h\", (chromahex.get(\"hsl.h\") - 15) % 360)\n        .rgb();\n    const [r2, g2, b2] = chromahex\n        .set(\"hsl.h\", (chromahex.get(\"hsl.h\") + 15) % 360)\n        .rgb();\n    return `linear-gradient(to right top,rgb(${r1},${g1},${b1}),rgb(${r},${g},${b}) 50%,rgb(${r2},${g2},${b2}))`;\n}\n\nexport function make_color_record(color) {\n    const chroma_neg = chroma(color);\n    const _neg_grad = make_gradient(chroma_neg);\n    const rgb = chroma_neg.rgb();\n\n    return [\n        color,\n        ...rgb,\n        _neg_grad,\n        `rgba(${rgb[0]},${rgb[1]},${rgb[2]},1)`,\n        `rgba(${rgb[0]},${rgb[1]},${rgb[2]},0)`,\n    ];\n}\n\nfunction blend(a, b) {\n    return chroma.mix(a, `rgb(${b[0]},${b[1]},${b[2]})`, 0.5).hex();\n}\n\nexport function activate_plugin_menu(regularTable, target, column_max) {\n    const is_numeric = typeof column_max !== \"undefined\";\n    const MENU = document.createElement(\n        `perspective-${is_numeric ? \"number\" : \"string\"}-column-style`\n    );\n    const target_meta = regularTable.getMeta(target);\n    const column_name =\n        target_meta.column_header[target_meta.column_header.length - 1];\n    const column_type = this._schema[column_name];\n    let default_config;\n    if (is_numeric) {\n        default_config = {\n            fg_gradient: column_max,\n            pos_fg_color: this._pos_fg_color[0],\n            neg_fg_color: this._neg_fg_color[0],\n            number_fg_mode: \"color\",\n            bg_gradient: column_max,\n            pos_bg_color: this._pos_bg_color[0],\n            neg_bg_color: this._neg_bg_color[0],\n            number_bg_mode: \"disabled\",\n        };\n    } else {\n        default_config = {\n            color: this._color[0],\n        };\n    }\n\n    if (column_type === \"string\") {\n        // do nothing\n    } else if (column_type === \"float\") {\n        default_config.fixed = 2;\n    } else if (column_type === \"integer\") {\n        default_config.fixed = 0;\n    } else {\n        this._open_column_styles_menu.pop();\n        regularTable.draw({preserve_width: true});\n        return;\n    }\n\n    const scroll_handler = () => MENU.blur();\n    const update_handler = (event) => {\n        const config = event.detail;\n        if (config.pos_fg_color) {\n            config.pos_fg_color = make_color_record(config.pos_fg_color);\n            config.neg_fg_color = make_color_record(config.neg_fg_color);\n        }\n\n        if (config.pos_bg_color) {\n            config.pos_bg_color = make_color_record(config.pos_bg_color);\n            config.neg_bg_color = make_color_record(config.neg_bg_color);\n        }\n\n        if (config.color) {\n            config.color = make_color_record(config.color);\n        }\n\n        regularTable[PLUGIN_SYMBOL] = regularTable[PLUGIN_SYMBOL] || {};\n        regularTable[PLUGIN_SYMBOL][column_name] = config;\n        regularTable.draw({preserve_width: true});\n        regularTable.parentElement.parentElement.dispatchEvent(\n            new Event(\"perspective-config-update\")\n        );\n    };\n\n    const blur_handler = async () => {\n        regularTable.removeEventListener(\n            \"regular-table-scroll\",\n            scroll_handler\n        );\n        MENU.removeEventListener(\n            \"perspective-column-style-change\",\n            update_handler\n        );\n        MENU.removeEventListener(\"blur\", blur_handler);\n        MENU.destroy();\n        this._open_column_styles_menu.pop();\n        await regularTable.draw({preserve_width: true});\n        regularTable.parentElement.parentElement.dispatchEvent(\n            new Event(\"perspective-config-update\")\n        );\n    };\n\n    MENU.addEventListener(\"perspective-column-style-change\", update_handler);\n    MENU.addEventListener(\"blur\", blur_handler);\n    regularTable.addEventListener(\"regular-table-scroll\", scroll_handler);\n\n    // Get the current column style config\n    const pset = regularTable[PLUGIN_SYMBOL] || {};\n    const config = Object.assign(\n        {},\n        (pset[column_name] = pset[column_name] || {})\n    );\n\n    if (config.pos_fg_color || config.pos_bg_color) {\n        config.pos_fg_color = config.pos_fg_color?.[0];\n        config.neg_fg_color = config.neg_fg_color?.[0];\n        config.pos_bg_color = config.pos_bg_color?.[0];\n        config.neg_bg_color = config.neg_bg_color?.[0];\n    }\n\n    if (config.color) {\n        config.color = config.color[0];\n    }\n\n    MENU.open(target, config, default_config);\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n// AFAICT `chroma-js` has no alpha-aware blending? So we need a function to get\n// the color of a heatmap cell over the background.\nexport function rgbaToRgb([r, g, b, a], source = [255, 255, 255]) {\n    function f(i, c) {\n        return ((1 - a) * (source[i] / 255) + a * (c / 255)) * 255;\n    }\n\n    return [f(0, r), f(1, g), f(2, b)];\n}\n\n// Chroma does this but why bother?\nexport function infer_foreground_from_background([r, g, b]) {\n    // TODO Implement dark/light themes.\n    return Math.sqrt(r * r * 0.299 + g * g * 0.587 + b * b * 0.114) > 130\n        ? \"#161616\"\n        : \"#ffffff\";\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nexport default async function getCellConfig(\n    {_view, _config},\n    row_idx,\n    col_idx\n) {\n    const group_by = _config.group_by;\n    const split_by = _config.split_by;\n    const start_row = row_idx >= 0 ? row_idx : 0;\n    const end_row = start_row + 1;\n    const r = await _view.to_json({start_row, end_row});\n    const row_paths = r.map((x) => x.__ROW_PATH__);\n    const group_by_values = row_paths[0] || [];\n    const row_filters = group_by\n        .map((pivot, index) => {\n            const pivot_value = group_by_values[index];\n            return pivot_value ? [pivot, \"==\", pivot_value] : undefined;\n        })\n        .filter((x) => x);\n\n    const column_index = group_by.length > 0 ? col_idx + 1 : col_idx;\n    const column_paths = Object.keys(r[0])[column_index];\n    const result = {row: r[0]};\n    let column_filters = [];\n    if (column_paths) {\n        const split_by_values = column_paths.split(\"|\");\n        result.column_names = [split_by_values[split_by_values.length - 1]];\n        column_filters = split_by\n            .map((pivot, index) => {\n                const pivot_value = split_by_values[index];\n                return pivot_value ? [pivot, \"==\", pivot_value] : undefined;\n            })\n            .filter((x) => x)\n            .filter(([, , value]) => value !== \"__ROW_PATH__\");\n    }\n\n    const filter = _config.filter.concat(row_filters).concat(column_filters);\n    result.config = {filter};\n    return result;\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport getCellConfig from \"./getCellConfig\";\nconst selected_rows_map = new WeakMap();\n\nasync function selectionListener(regularTable, viewer, event) {\n    const meta = regularTable.getMeta(event.target);\n    if (!viewer.hasAttribute(\"selectable\")) return;\n    if (event.handled) return;\n    if (event.which !== 1) {\n        return;\n    }\n\n    if (!meta) {\n        return;\n    }\n\n    const id = this._ids[meta.y - meta.y0];\n    if (meta && meta.y >= 0) {\n        const selected = selected_rows_map.get(regularTable);\n        const key_match =\n            !!selected &&\n            selected.reduce((agg, x, i) => agg && x === id[i], true);\n        const is_deselect =\n            !!selected && id.length === selected.length && key_match;\n        let filter = [];\n        if (is_deselect) {\n            selected_rows_map.delete(regularTable);\n        } else {\n            selected_rows_map.set(regularTable, id);\n            filter = await getCellConfig(this, meta.y, meta.x);\n            filter = filter.config.filter;\n        }\n\n        await regularTable.draw({preserve_width: true});\n        event.handled = true;\n        viewer.dispatchEvent(\n            new CustomEvent(\"perspective-select\", {\n                bubbles: true,\n                composed: true,\n                detail: {\n                    selected: !is_deselect,\n                    config: {filter},\n                },\n            })\n        );\n    }\n}\n\nfunction selectionStyleListener(regularTable, viewer) {\n    if (!viewer.hasAttribute(\"selectable\")) return;\n    const has_selected = selected_rows_map.has(regularTable);\n    const selected = selected_rows_map.get(regularTable);\n    for (const td of regularTable.querySelectorAll(\"td\")) {\n        if (!has_selected) {\n            td.classList.toggle(\"psp-row-selected\", false);\n            td.classList.toggle(\"psp-row-subselected\", false);\n        } else {\n            const meta = regularTable.getMeta(td);\n            const id = this._ids[meta.y - meta.y0];\n            const key_match = selected.reduce(\n                (agg, x, i) => agg && x === id[i],\n                true\n            );\n            td.classList.toggle(\n                \"psp-row-selected\",\n                id.length === selected.length && key_match\n            );\n            td.classList.toggle(\n                \"psp-row-subselected\",\n                id.length !== selected.length && key_match\n            );\n        }\n    }\n\n    for (const th of regularTable.querySelectorAll(\"tbody th\")) {\n        const meta = regularTable.getMeta(th);\n        const id = this._ids[meta.y - meta.y0];\n        if (!has_selected || !!id[meta.row_header_x]) {\n            th.classList.toggle(\"psp-row-selected\", false);\n            th.classList.toggle(\"psp-row-subselected\", false);\n        } else {\n            const key_match = selected.reduce(\n                (agg, x, i) => agg && x === id[i],\n                true\n            );\n            th.classList.toggle(\n                \"psp-row-selected\",\n                id.length === selected.length && key_match\n            );\n            th.classList.toggle(\n                \"psp-row-subselected\",\n                id.length !== selected.length && key_match\n            );\n        }\n    }\n}\n\nexport function configureRowSelectable(table, viewer) {\n    table.addStyleListener(selectionStyleListener.bind(this, table, viewer));\n    table.addEventListener(\n        \"mousedown\",\n        selectionListener.bind(this, table, viewer)\n    );\n}\n\nexport async function deselect(regularTable) {\n    selected_rows_map.delete(regularTable);\n    for (const td of regularTable.querySelectorAll(\"td,th\")) {\n        td.classList.toggle(\"psp-row-selected\", false);\n        td.classList.toggle(\"psp-row-subselected\", false);\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport getCellConfig from \"./getCellConfig\";\n\nasync function clickListener(table, viewer, event) {\n    const meta = table.getMeta(event.target);\n    if (!meta) return;\n    const {x, y} = meta;\n\n    const {row, column_names, config} = await getCellConfig(this, y, x);\n\n    viewer.dispatchEvent(\n        new CustomEvent(\"perspective-click\", {\n            bubbles: true,\n            composed: true,\n            detail: {\n                row,\n                column_names,\n                config,\n            },\n        })\n    );\n}\n\nexport function configureClick(table, viewer) {\n    table.addEventListener(\"click\", clickListener.bind(this, table, viewer));\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nconst selected_position_map = new WeakMap();\nimport {PLUGIN_SYMBOL} from \"./plugin_menu.js\";\nfunction lock(body) {\n    let lock;\n    return async function (...args) {\n        if (!!lock && (await lock) && !!lock) {\n            return;\n        }\n\n        let resolve;\n        lock = new Promise((x) => (resolve = x));\n        await body.apply(this, args);\n        lock = undefined;\n        resolve();\n    };\n}\n\nfunction getPos() {\n    if (this.isContentEditable) {\n        let _range = document.getSelection().getRangeAt(0);\n        let range = _range.cloneRange();\n        range.selectNodeContents(this);\n        range.setEnd(_range.endContainer, _range.endOffset);\n        return range.toString().length;\n    } else {\n        return this.target.selectionStart;\n    }\n}\n\nfunction write(table, model, active_cell) {\n    const meta = table.getMeta(active_cell);\n    const type = model._schema[model._column_paths[meta.x]];\n    if (meta) {\n        let text = active_cell.textContent;\n        const id = model._ids[meta.y - meta.y0];\n        if (type === \"float\" || type === \"integer\") {\n            text = parseFloat(text.replace(/,/g, \"\"));\n            if (isNaN(text)) {\n                return false;\n            }\n        } else if (type === \"date\" || type === \"datetime\") {\n            text = Date.parse(text);\n            if (isNaN(text)) {\n                return false;\n            }\n        } else if (type === \"boolean\") {\n            text = text === \"check\" ? false : text === \"close\" ? true : null;\n        }\n\n        const msg = {\n            __INDEX__: id,\n            [model._column_paths[meta.x]]: text,\n        };\n\n        model._table.update([msg], {port_id: model._edit_port});\n        return true;\n    }\n}\n\nfunction isEditable(viewer, allowed = false) {\n    const has_pivots =\n        this._config.group_by.length === 0 &&\n        this._config.split_by.length === 0;\n    const selectable = viewer.hasAttribute(\"selectable\");\n    const editable = allowed || !!viewer.children[0]._is_edit_mode;\n    return has_pivots && !selectable && editable;\n}\n\nconst moveSelection = lock(async function (table, active_cell, dx, dy) {\n    const meta = table.getMeta(active_cell);\n    const num_columns = this._column_paths.length;\n    const num_rows = this._num_rows;\n    const selected_position = selected_position_map.get(table);\n    if (!selected_position) {\n        return;\n    }\n\n    if (meta.x + dx < num_columns && 0 <= meta.x + dx) {\n        selected_position.x = meta.x + dx;\n    }\n\n    if (meta.y + dy < num_rows && 0 <= meta.y + dy) {\n        selected_position.y = meta.y + dy;\n    }\n\n    const xmin = Math.max(meta.x0 - 10, 0);\n    const xmax = Math.min(meta.x0 + 10, num_columns);\n    const ymin = Math.max(meta.y0 - 5, 0);\n    const ymax = Math.min(meta.y0 + 10, num_rows);\n    let x = meta.x0 + dx,\n        y = meta.y0 + dy;\n    while (\n        !focusStyleListener(table) &&\n        x >= xmin &&\n        x < xmax &&\n        y >= ymin &&\n        y < ymax\n    ) {\n        await table.scrollToCell(x, y, num_columns, num_rows);\n        selected_position_map.set(table, selected_position);\n        x += dx;\n        y += dy;\n    }\n});\n\n// Styles\n\nfunction editableStyleListener(table, viewer) {\n    // Independently check \"editable\" and `isEditable()`, so we can skip\n    // the styler entirely if editing was disabled at the time of element\n    // creation, but toggle in when e.g. pivots or selectable will\n    // affect editability.\n    const plugins = table[PLUGIN_SYMBOL] || {};\n    const edit = isEditable.call(this, viewer);\n    table.parentElement.classList.toggle(\n        \"edit-mode-allowed\",\n        isEditable.call(this, viewer, true)\n    );\n\n    for (const td of table.querySelectorAll(\"td\")) {\n        const meta = table.getMeta(td);\n        const type = this.get_psp_type(meta);\n        if (edit && this._is_editable[meta.x]) {\n            const col_name = meta.column_header[meta.column_header.length - 1];\n            if (type === \"string\" && plugins[col_name]?.format === \"link\") {\n                td.toggleAttribute(\"contenteditable\", false);\n                td.classList.toggle(\"boolean-editable\", false);\n            } else if (type === \"boolean\") {\n                td.toggleAttribute(\"contenteditable\", false);\n                td.classList.toggle(\"boolean-editable\", meta.user !== null);\n            } else {\n                if (edit !== td.hasAttribute(\"contenteditable\")) {\n                    td.toggleAttribute(\"contenteditable\", edit);\n                }\n                td.classList.toggle(\"boolean-editable\", false);\n            }\n        } else {\n            td.toggleAttribute(\"contenteditable\", false);\n            td.classList.toggle(\"boolean-editable\", false);\n        }\n    }\n}\n\nconst focusStyleListener = (table) => {\n    const tds = table.querySelectorAll(\"td\");\n    const selected_position = selected_position_map.get(table);\n    if (selected_position) {\n        for (const td of tds) {\n            const meta = table.getMeta(td);\n            if (\n                meta.x === selected_position.x &&\n                meta.y === selected_position.y\n            ) {\n                if (document.activeElement !== td) {\n                    td.focus({preventScroll: true});\n                }\n                return true;\n            }\n        }\n        if (\n            document.activeElement !== document.body &&\n            table.contains(document.activeElement)\n        ) {\n            document.activeElement.blur();\n        }\n    }\n};\n\n// Events\n\nfunction keydownListener(table, viewer, event) {\n    if (!isEditable.call(this, viewer)) {\n        return;\n    }\n    const target = document.activeElement;\n    event.target.classList.remove(\"psp-error\");\n    switch (event.keyCode) {\n        case 13:\n            event.preventDefault();\n            if (event.shiftKey) {\n                moveSelection.call(this, table, target, 0, -1);\n            } else {\n                moveSelection.call(this, table, target, 0, 1);\n            }\n            break;\n        case 37:\n            if (getPos.call(target) == 0) {\n                event.preventDefault();\n                moveSelection.call(this, table, target, -1, 0);\n            }\n            break;\n        case 38:\n            event.preventDefault();\n            moveSelection.call(this, table, target, 0, -1);\n            break;\n        case 39:\n            if (getPos.call(target) == target.textContent.length) {\n                event.preventDefault();\n                moveSelection.call(this, table, target, 1, 0);\n            }\n            break;\n        case 40:\n            event.preventDefault();\n            moveSelection.call(this, table, target, 0, 1);\n            break;\n        default:\n    }\n}\n\nfunction focusoutListener(table, viewer, event) {\n    if (isEditable.call(this, viewer) && selected_position_map.has(table)) {\n        event.target.classList.remove(\"psp-error\");\n        const selectedPosition = selected_position_map.get(table);\n        selected_position_map.delete(table);\n        if (selectedPosition.content !== event.target.textContent) {\n            if (!write(table, this, event.target)) {\n                event.target.textContent = selectedPosition.content;\n                event.target.classList.add(\"psp-error\");\n                event.target.focus();\n            }\n        }\n    }\n}\n\nfunction focusinListener(table, viewer, event) {\n    const meta = table.getMeta(event.target);\n    if (meta) {\n        const new_state = {\n            x: meta.x,\n            y: meta.y,\n            content: event.target.textContent,\n        };\n        selected_position_map.set(table, new_state);\n    }\n}\n\nfunction clickListener(table, _viewer, event) {\n    const meta = table.getMeta(event.target);\n    if (typeof meta?.x !== \"undefined\") {\n        const is_all_editable = isEditable.call(this, _viewer);\n        const is_editable = this._is_editable[meta.x];\n        const is_bool = this.get_psp_type(meta) === \"boolean\";\n        const is_null = event.target.textContent === \"-\";\n        if (is_all_editable && is_editable && is_bool && !is_null) {\n            write(table, this, event.target);\n        }\n    }\n}\n\n// Plugin\n\nexport async function configureEditable(table, viewer) {\n    this._edit_port = await viewer.getEditPort();\n    table.addStyleListener(editableStyleListener.bind(this, table, viewer));\n    table.addStyleListener(focusStyleListener.bind(this, table, viewer));\n    table.addEventListener(\"click\", clickListener.bind(this, table, viewer));\n    table.addEventListener(\n        \"focusin\",\n        focusinListener.bind(this, table, viewer)\n    );\n    table.addEventListener(\n        \"focusout\",\n        focusoutListener.bind(this, table, viewer)\n    );\n    table.addEventListener(\n        \"keydown\",\n        keydownListener.bind(this, table, viewer)\n    );\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport \"regular-table\";\n\nimport {\n    createModel,\n    configureRegularTable,\n    formatters,\n} from \"./regular_table_handlers.js\";\nimport MATERIAL_STYLE from \"../less/regular_table.less\";\nimport TOOLBAR_STYLE from \"../less/toolbar.less\";\nimport {configureRowSelectable, deselect} from \"./row_selection.js\";\nimport {configureClick} from \"./click.js\";\nimport {configureEditable} from \"./editing.js\";\nimport {configureSortable} from \"./sorting.js\";\nimport {PLUGIN_SYMBOL, make_color_record} from \"./plugin_menu.js\";\n\nexport class PerspectiveViewerDatagridPluginElement extends HTMLElement {\n    constructor() {\n        super();\n        this.datagrid = document.createElement(\"regular-table\");\n        this.datagrid.formatters = formatters;\n        this._is_scroll_lock = true;\n    }\n\n    connectedCallback() {\n        if (!this._toolbar) {\n            this._toolbar = document.createElement(\n                \"perspective-viewer-datagrid-toolbar\"\n            );\n\n            this._toolbar.setAttribute(\"slot\", \"plugin-settings\");\n            this._toolbar.attachShadow({mode: \"open\"});\n            this._toolbar.shadowRoot.innerHTML = `\n                <style>\n                    ${TOOLBAR_STYLE}\n                </style>\n                <div id=\"toolbar\">\n                    <span id=\"scroll_lock\" class=\"lock-scroll button\"><span>Align Scroll</span></span>\n                    <span id=\"edit_mode\" class=\"button\"><span>Read Only</span></span>\n                </div>\n            `;\n\n            this._scroll_lock =\n                this._toolbar.shadowRoot.querySelector(\"#scroll_lock\");\n            this._scroll_lock.addEventListener(\"click\", () =>\n                this._toggle_scroll_lock()\n            );\n\n            this._edit_mode =\n                this._toolbar.shadowRoot.querySelector(\"#edit_mode\");\n\n            this._edit_mode.addEventListener(\"click\", () => {\n                this._toggle_edit_mode();\n                this.datagrid.draw();\n                this.parentElement.dispatchEvent(\n                    new Event(\"perspective-config-update\")\n                );\n            });\n        }\n\n        this.parentElement.appendChild(this._toolbar);\n    }\n\n    disconnectedCallback() {\n        this._toolbar.parentElement.removeChild(this._toolbar);\n    }\n\n    _toggle_edit_mode(force = undefined) {\n        if (typeof force === \"undefined\") {\n            force = !this._is_edit_mode;\n        }\n\n        this._is_edit_mode = force;\n        this.classList.toggle(\"editable\", force);\n        if (this._edit_mode !== undefined) {\n            this._edit_mode.classList.toggle(\"editable\", force);\n            if (force) {\n                this._edit_mode.children[0].textContent = \"Editable\";\n            } else {\n                this._edit_mode.children[0].textContent = \"Read Only\";\n            }\n        }\n    }\n\n    _toggle_scroll_lock(force = undefined) {\n        if (typeof force === \"undefined\") {\n            force = !this._is_scroll_lock;\n        }\n\n        this._is_scroll_lock = force;\n        this.classList.toggle(\"sub-cell-scroll-enabled\", !force);\n        if (this._scroll_lock !== undefined) {\n            this._scroll_lock.classList.toggle(\"lock-scroll\", force);\n            if (!force) {\n                this._scroll_lock.children[0].textContent = \"Free Scroll\";\n            } else {\n                this._scroll_lock.children[0].textContent = \"Align Scroll\";\n            }\n        }\n    }\n\n    async activate(view) {\n        let viewer = this.parentElement;\n        let table = await viewer.getTable(true);\n        if (!this._initialized) {\n            this.innerHTML = \"\";\n            this.appendChild(this.datagrid);\n            this.model = await createModel(this.datagrid, table, view);\n            configureRegularTable(this.datagrid, this.model);\n            await configureRowSelectable.call(\n                this.model,\n                this.datagrid,\n                viewer\n            );\n            await configureClick.call(this.model, this.datagrid, viewer);\n            await configureEditable.call(this.model, this.datagrid, viewer);\n            await configureSortable.call(this.model, this.datagrid, viewer);\n            this._initialized = true;\n        } else {\n            await createModel(this.datagrid, table, view, this.model);\n        }\n    }\n\n    get name() {\n        return \"Datagrid\";\n    }\n\n    get category() {\n        return \"Basic\";\n    }\n\n    get select_mode() {\n        return \"toggle\";\n    }\n\n    get min_config_columns() {\n        return undefined;\n    }\n\n    get config_column_names() {\n        return undefined;\n    }\n\n    async draw(view) {\n        if (this.parentElement) {\n            await this.activate(view);\n        }\n\n        if (!this.isConnected || this.offsetParent == null) {\n            return;\n        }\n\n        const old_sizes = this._save_column_size_overrides();\n        let viewer = this.parentElement;\n        const draw = this.datagrid.draw({invalid_columns: true});\n        if (!this.model._preserve_focus_state) {\n            this.datagrid.scrollTop = 0;\n            this.datagrid.scrollLeft = 0;\n            deselect(this.datagrid, viewer);\n            this.datagrid._resetAutoSize();\n        } else {\n            this.model._preserve_focus_state = false;\n        }\n\n        this._restore_column_size_overrides(old_sizes);\n        await draw;\n\n        this._toolbar.classList.toggle(\n            \"aggregated\",\n            this.model._config.group_by.length > 0 ||\n                this.model._config.split_by.length > 0\n        );\n    }\n\n    async update(view) {\n        this.model._num_rows = await view.num_rows();\n        await this.datagrid.draw();\n    }\n\n    async resize() {\n        if (!this.isConnected || this.offsetParent == null) {\n            return;\n        }\n\n        if (this._initialized) {\n            await this.datagrid.draw();\n        }\n    }\n\n    async clear() {\n        this.datagrid._resetAutoSize();\n        this.datagrid.clear();\n    }\n\n    save() {\n        if (this.datagrid) {\n            const datagrid = this.datagrid;\n            const token = {\n                columns: {},\n                scroll_lock: !!this._is_scroll_lock,\n                editable: !!this._is_edit_mode,\n            };\n\n            for (const col of Object.keys(datagrid[PLUGIN_SYMBOL] || {})) {\n                const config = Object.assign({}, datagrid[PLUGIN_SYMBOL][col]);\n                if (config?.pos_fg_color || config?.pos_bg_color) {\n                    config.pos_fg_color = config.pos_fg_color?.[0];\n                    config.neg_fg_color = config.neg_fg_color?.[0];\n                    config.pos_bg_color = config.pos_bg_color?.[0];\n                    config.neg_bg_color = config.neg_bg_color?.[0];\n                }\n\n                if (config?.color) {\n                    config.color = config.color[0];\n                }\n\n                token.columns[col] = config;\n            }\n\n            const column_size_overrides = this._save_column_size_overrides();\n\n            for (const col of Object.keys(column_size_overrides || {})) {\n                if (!token.columns[col]) {\n                    token.columns[col] = {};\n                }\n\n                token.columns[col].column_size_override =\n                    column_size_overrides[col];\n            }\n\n            return JSON.parse(JSON.stringify(token));\n        }\n        return {};\n    }\n\n    restore(token) {\n        token = JSON.parse(JSON.stringify(token));\n        const overrides = {};\n        if (token.columns) {\n            for (const col of Object.keys(token.columns)) {\n                const col_config = token.columns[col];\n                if (col_config.column_size_override !== undefined) {\n                    overrides[col] = col_config.column_size_override;\n                    delete col_config[\"column_size_override\"];\n                }\n\n                if (col_config?.pos_fg_color) {\n                    col_config.pos_fg_color = make_color_record(\n                        col_config.pos_fg_color\n                    );\n                    col_config.neg_fg_color = make_color_record(\n                        col_config.neg_fg_color\n                    );\n                }\n\n                if (col_config?.pos_bg_color) {\n                    col_config.pos_bg_color = make_color_record(\n                        col_config.pos_bg_color\n                    );\n                    col_config.neg_bg_color = make_color_record(\n                        col_config.neg_bg_color\n                    );\n                }\n\n                if (col_config?.color) {\n                    col_config.color = make_color_record(col_config.color);\n                }\n\n                if (Object.keys(col_config).length === 0) {\n                    delete token.columns[col];\n                }\n            }\n        }\n\n        if (\"editable\" in token) {\n            this._toggle_edit_mode(token.editable);\n        }\n\n        if (\"scroll_lock\" in token) {\n            this._toggle_scroll_lock(token.scroll_lock);\n        }\n\n        const datagrid = this.datagrid;\n        try {\n            datagrid._resetAutoSize();\n        } catch (e) {\n            // Do nothing;  this may fail if no auto size info has been read.\n            // TODO fix this regular-table API\n        }\n\n        this._restore_column_size_overrides(overrides, true);\n        datagrid[PLUGIN_SYMBOL] = token.columns;\n    }\n\n    async restyle(view) {\n        this.draw(view);\n    }\n\n    delete() {\n        if (this.datagrid.table_model) {\n            this.datagrid._resetAutoSize();\n        }\n        this.datagrid.clear();\n    }\n\n    // Private\n\n    /**\n     * Extract the current user-overriden column widths from\n     * `regular-table`.  This functiond depends on the internal\n     * implementation of `regular-table` and may break!\n     *\n     * @returns An Object-as-dictionary keyed by column_path string, and\n     * valued by the column's user-overridden pixel width.\n     */\n    _save_column_size_overrides() {\n        if (!this._initialized) {\n            return [];\n        }\n\n        if (this._cached_column_sizes) {\n            const x = this._cached_column_sizes;\n            this._cached_column_sizes = undefined;\n            return x;\n        }\n\n        const overrides = this.datagrid._column_sizes.override;\n        const {group_by, columns} = this.model._config;\n        const tree_header_offset =\n            group_by?.length > 0 ? group_by.length + 1 : 0;\n\n        const old_sizes = {};\n        for (const key of Object.keys(overrides)) {\n            if (overrides[key] !== undefined) {\n                const index = key - tree_header_offset;\n                if (index > -1) {\n                    old_sizes[this.model._column_paths[index]] = overrides[key];\n                } else if (index === -1) {\n                    old_sizes[\"__ROW_PATH__\"] = overrides[key];\n                }\n            }\n        }\n\n        return old_sizes;\n    }\n\n    /**\n     * Restore a saved column width override token.\n     *\n     * @param {*} token An object previously returned by a call to\n     * `_save_column_size_overrides()`\n     * @param {*} [cache=false] A flag indicating whether this value should\n     * be cached so a future `resetAutoSize()` call does not clear it.\n     * @returns\n     */\n    _restore_column_size_overrides(old_sizes, cache = false) {\n        if (!this._initialized) {\n            return;\n        }\n\n        if (cache) {\n            this._cached_column_sizes = old_sizes;\n        }\n\n        const overrides = {};\n        const {group_by, columns} = this.model._config;\n        const tree_header_offset =\n            group_by?.length > 0 ? group_by.length + 1 : 0;\n\n        for (const key of Object.keys(old_sizes)) {\n            if (key === \"__ROW_PATH__\") {\n                overrides[tree_header_offset - 1] = old_sizes[key];\n            } else {\n                const index = this.model._column_paths.indexOf(key);\n                overrides[index + tree_header_offset] = old_sizes[key];\n            }\n        }\n\n        this.datagrid._column_sizes.override = overrides;\n    }\n}\n\ncustomElements.define(\n    \"perspective-viewer-datagrid\",\n    PerspectiveViewerDatagridPluginElement\n);\n\n/**\n * Appends the default table CSS to `<head>`, should be run once on module\n * import.\n *\n */\nfunction _register_global_styles() {\n    const style = document.createElement(\"style\");\n    style.textContent = MATERIAL_STYLE;\n    document.head.insertBefore(style, document.head.firstChild);\n}\n\n/******************************************************************************\n *\n * Main\n *\n */\n\nfunction register_element() {\n    customElements\n        .get(\"perspective-viewer\")\n        .registerPlugin(\"perspective-viewer-datagrid\");\n}\n\ncustomElements.whenDefined(\"perspective-viewer\").then(register_element);\n_register_global_styles();\n"],
  "mappings": "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",
  "names": []
}
